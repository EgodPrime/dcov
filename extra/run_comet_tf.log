2024-06-12 16:58:04,829 logger.py[line:35] INFO Seed Selector Exists! Continue COMET!
2024-06-12 16:58:04,834 logger.py[line:35] INFO INFO: Mutation progress 1/100
2024-06-12 16:58:04,834 logger.py[line:35] INFO Logging for Seeds
2024-06-12 16:58:04,834 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 16:58:04,834 logger.py[line:35] INFO Score for MDtype is: 0.8783783783783784
2024-06-12 16:58:04,834 logger.py[line:35] INFO Score for MDims is: 0.85
2024-06-12 16:58:04,834 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 16:58:04,834 logger.py[line:35] INFO Score for Edge is: 0.8333333333333334
2024-06-12 16:58:04,834 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 16:58:04,834 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 16:58:04,834 logger.py[line:35] INFO Score for SpecialI is: 0.6363636363636364
2024-06-12 16:58:04,834 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 16:58:04,834 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 16:58:04,834 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-NLAll124
2024-06-12 16:58:04,834 logger.py[line:35] INFO start mutating the generated model
2024-06-12 16:58:07,601 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 16:58:08,366 logger.py[line:35] INFO Generating model using Edge
2024-06-12 16:58:08,369 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge')>}
Choosing 3 To Insert
2024-06-12 16:58:08,584 logger.py[line:35] INFO Insert 3 Global New Edges
2024-06-12 16:58:08,585 logger.py[line:35] INFO Candidate Edge: ('UpSampling2D', 'UpSampling2D')
2024-06-12 16:58:08,595 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 16:58:08,807 logger.py[line:35] INFO Trying Adding Edge: ['UpSampling2D', 'UpSampling2D'] by Connecting up_sampling2d_insert_copy_NLAll_copy_Edge and up_sampling2d_insert_copy_NLAll_copy_Edge
2024-06-12 16:58:08,810 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 16:58:09,031 logger.py[line:35] INFO Successfully Add Edge: ['UpSampling2D', 'UpSampling2D'] by Connecting up_sampling2d_insert_copy_NLAll_copy_Edge and up_sampling2d_insert_copy_NLAll_copy_Edge
2024-06-12 16:58:09,032 logger.py[line:35] INFO Candidate Edge: ('SeparableConv1D', 'Dropout')
2024-06-12 16:58:09,042 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 16:58:09,261 logger.py[line:35] INFO Trying Adding Edge: ['SeparableConv1D', 'Dropout'] by Connecting separable_conv1d_insert_copy_Edge and dropout_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 16:58:09,264 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 16:58:09,569 logger.py[line:35] INFO Successfully Add Edge: ['SeparableConv1D', 'Dropout'] by Connecting separable_conv1d_insert_copy_Edge and dropout_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 16:58:09,570 logger.py[line:35] INFO Candidate Edge: ('UpSampling3D', 'Softmax')
2024-06-12 16:58:09,580 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 16:58:09,802 logger.py[line:35] INFO Trying Adding Edge: ['UpSampling3D', 'Softmax'] by Connecting up_sampling3d_insert_copy_NLAll_copy_NLAll_copy_Edge and softmax_insert_copy_Edge
2024-06-12 16:58:09,805 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 16:58:10,042 logger.py[line:35] INFO Successfully Add Edge: ['UpSampling3D', 'Softmax'] by Connecting up_sampling3d_insert_copy_NLAll_copy_NLAll_copy_Edge and softmax_insert_copy_Edge
2024-06-12 16:58:10,089 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 16:58:11,420 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 9/2170
The Configuration Coverage is: 62/2049
The NDims Coverage Is: 13/117
The DType Coverage Is: 11/354
The Shape Coverage Is: 14/295
The Input Coverage Is: 38/766
2024-06-12 16:58:12,221 logger.py[line:35] INFO Loading the framework
2024-06-12 16:58:14,663 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 16:58:18,453 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 16:58:22,421 logger.py[line:35] INFO 2.9.0
2024-06-12 16:58:24,015 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 230, in <module>
    predictor.predict()
  File "/root/implementations/scripts/prediction/predict_model.py", line 167, in predict
    pred = self.model.predict(self.input)
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/tensorflow/python/eager/execute.py", line 55, in quick_execute
    inputs, attrs, num_outputs)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: Graph execution error:

Detected at node 'lstm2-NLAll38-NLAll54-NLAll124-Edge0/up_sampling2d_insert_copy_NLAll_copy_Edge_2/resize/ResizeNearestNeighbor' defined at (most recent call last):
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 193, in _run_module_as_main
      "__main__", mod_spec)
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 85, in _run_code
      exec(code, run_globals)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/__main__.py", line 8, in <module>
      sys.exit(main())
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 871, in main
      status = CoverageScript().command_line(argv)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 588, in command_line
      return self.do_run(options, args)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 746, in do_run
      runner.run()
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/execfile.py", line 247, in run
      exec(code, main_mod.__dict__)
    File "/root/implementations/scripts/prediction/predict_model.py", line 230, in <module>
      predictor.predict()
    File "/root/implementations/scripts/prediction/predict_model.py", line 167, in predict
      pred = self.model.predict(self.input)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1982, in predict
      tmp_batch_outputs = self.predict_function(iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1801, in predict_function
      return step_function(self, iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1790, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1783, in run_step
      outputs = model.predict_step(data)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1751, in predict_step
      return self(x, training=False)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 452, in call
      inputs, training=training, mask=mask)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 589, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/convolutional.py", line 2959, in call
      interpolation=self.interpolation)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/backend.py", line 3420, in resize_images
      x, new_shape, method=tf.image.ResizeMethod.NEAREST_NEIGHBOR)
Node: 'lstm2-NLAll38-NLAll54-NLAll124-Edge0/up_sampling2d_insert_copy_NLAll_copy_Edge_2/resize/ResizeNearestNeighbor'
OOM when allocating tensor with shape[32,441,441,225] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[{{node lstm2-NLAll38-NLAll54-NLAll124-Edge0/up_sampling2d_insert_copy_NLAll_copy_Edge_2/resize/ResizeNearestNeighbor}}]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info. This isn't available when running in Eager mode.
 [Op:__inference_predict_function_1365]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 235, in <module>
    raise ValueError(f"CRASH ON BACKEND {flags.backend}!!!")
ValueError: CRASH ON BACKEND tensorflow!!!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 16:58:41,759 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 23s
2024-06-12 16:58:41,759 logger.py[line:35] INFO lstm2-NLAll38-NLAll54-NLAll124-Edge0 crash on backend tensorflow when predicting
2024-06-12 16:58:41,781 logger.py[line:35] INFO coverage_c=34124
2024-06-12 16:58:46,034 logger.py[line:35] INFO Fail on backend: tensorflow of model lstm2-NLAll38-NLAll54-NLAll124-Edge0
2024-06-12 16:58:46,034 logger.py[line:35] INFO Error: Move Crash model
2024-06-12 16:58:46,034 logger.py[line:35] INFO after_prediction
2024-06-12 16:58:46,335 logger.py[line:35] INFO INFO: Mutation progress 2/100
2024-06-12 16:58:46,335 logger.py[line:35] INFO Logging for Seeds
2024-06-12 16:58:46,336 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 16:58:46,336 logger.py[line:35] INFO Score for MDtype is: 0.8783783783783784
2024-06-12 16:58:46,336 logger.py[line:35] INFO Score for MDims is: 0.85
2024-06-12 16:58:46,336 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 16:58:46,336 logger.py[line:35] INFO Score for Edge is: 0.8392857142857143
2024-06-12 16:58:46,336 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 16:58:46,336 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 16:58:46,336 logger.py[line:35] INFO Score for SpecialI is: 0.6363636363636364
2024-06-12 16:58:46,336 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 16:58:46,336 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 16:58:46,336 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-LMerg10-NLAll92-MDtype98
2024-06-12 16:58:46,336 logger.py[line:35] INFO start mutating the generated model
2024-06-12 16:58:50,415 logger.py[line:35] INFO Generating model using MParam
model outputs {'predictions_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam')>}
2024-06-12 16:58:51,407 logger.py[line:35] INFO Changing 2/5 of layer conv4_block1_1_bn_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam's configuration
2024-06-12 16:58:51,407 logger.py[line:35] INFO changing config axis in layer conv4_block1_1_bn_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from ListWrapper([3]) to -1
2024-06-12 16:58:51,407 logger.py[line:35] INFO changing config center in layer conv4_block1_1_bn_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from True to False
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config scale in layer conv4_block1_1_bn_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from True to True
2024-06-12 16:58:51,408 logger.py[line:35] INFO Changing 2/15 of layer conv3_block4_3_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam's configuration
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config bias_constraint in layer conv3_block4_3_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from None to UnitNorm
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config kernel_constraint in layer conv3_block4_3_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from None to MaxNorm
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config activity_regularizer in layer conv3_block4_3_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from None to l2
2024-06-12 16:58:51,408 logger.py[line:35] INFO Changing 1/15 of layer conv4_block1_0_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam's configuration
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config bias_regularizer in layer conv4_block1_0_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from None to l1
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config kernel_regularizer in layer conv4_block1_0_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from None to l2
2024-06-12 16:58:51,408 logger.py[line:35] INFO Changing 3/15 of layer conv5_block3_2_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam's configuration
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config activity_regularizer in layer conv5_block3_2_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from None to l1
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config kernel_constraint in layer conv5_block3_2_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from None to NonNeg
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config kernel_initializer in layer conv5_block3_2_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}} to lecun_uniform
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config kernel_size in layer conv5_block3_2_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from (3, 3) to [11, 0]
2024-06-12 16:58:51,408 logger.py[line:35] INFO Changing 1/15 of layer conv4_block6_1_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam's configuration
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config strides in layer conv4_block6_1_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from (1, 1) to [3, 2]
2024-06-12 16:58:51,408 logger.py[line:35] INFO changing config activation in layer conv4_block6_1_conv_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MParam: from linear to exponential
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 82, in generate_model_by_model_mutation
    architecture_measure=architecture_measure, max_layer_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 283, in mutate_param
    new_model = utils.ModelUtils.functional_model_operation(MParam_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 101, in functional_model_operation
    x = cloned_layer(layer_input_tensors)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/merge.py", line 79, in _compute_elemwise_op_output_shape
    'Inputs have incompatible shapes. '
ValueError: Inputs have incompatible shapes. Received shapes (14, 14, 256) and (5, 7, 256)
2024-06-12 16:58:52,744 logger.py[line:35] INFO INFO: Mutation progress 2/100
2024-06-12 16:58:52,744 logger.py[line:35] INFO Logging for Seeds
2024-06-12 16:58:52,744 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 16:58:52,744 logger.py[line:35] INFO Score for MDtype is: 0.8783783783783784
2024-06-12 16:58:52,744 logger.py[line:35] INFO Score for MDims is: 0.85
2024-06-12 16:58:52,744 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 16:58:52,744 logger.py[line:35] INFO Score for Edge is: 0.8392857142857143
2024-06-12 16:58:52,744 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 16:58:52,744 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 16:58:52,744 logger.py[line:35] INFO Score for SpecialI is: 0.6363636363636364
2024-06-12 16:58:52,744 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 16:58:52,745 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 16:58:52,745 logger.py[line:35] INFO Choose seed: resnet50-Edge65-MDtype132
2024-06-12 16:58:52,745 logger.py[line:35] INFO start mutating the generated model
2024-06-12 16:58:56,853 logger.py[line:35] INFO Generating model using SpecialI
model outputs {'predictions_copy_Edge_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI')>, 'custom_cast_layer_5': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI')>, 'avg_pool_copy_Edge_2_copy_MDtype': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI')>}
2024-06-12 16:58:57,898 logger.py[line:35] INFO Change Input Of Layer: conv5_block1_1_bn_copy_Edge_copy_MDtype_copy_SpecialI To: nan
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI')>, 'custom_cast_layer_5_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI')>, 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI')>}
2024-06-12 16:58:58,875 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 14/2170
The Configuration Coverage is: 103/2049
The NDims Coverage Is: 18/117
The DType Coverage Is: 18/354
The Shape Coverage Is: 30/295
The Input Coverage Is: 66/766
2024-06-12 16:59:00,998 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 16:59:04,923 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 16:59:09,040 logger.py[line:35] INFO 2.9.0
2024-06-12 16:59:10,627 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 16:59:19,157 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-Edge65-MDtype132-SpecialI1 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 16:59:20,875 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 15s
2024-06-12 16:59:20,875 logger.py[line:35] INFO loading the redis
2024-06-12 16:59:20,878 logger.py[line:35] INFO finish loading from redis
2024-06-12 16:59:20,900 logger.py[line:35] INFO coverage_c=35167
time=19.73690700531006, cov_py=0, cov_c=35167
New test requirements invoked on framework tensorflow when updating resnet50-Edge65-MDtype132-SpecialI1
2024-06-12 16:59:25,140 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-Edge65-MDtype132-SpecialI1
2024-06-12 16:59:25,140 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 16:59:25,140 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 16:59:25,140 logger.py[line:35] INFO after_prediction
2024-06-12 16:59:25,140 logger.py[line:35] INFO New representative seed found: resnet50-Edge65-MDtype132-SpecialI1
2024-06-12 16:59:25,500 logger.py[line:35] INFO INFO: Mutation progress 3/100
2024-06-12 16:59:25,500 logger.py[line:35] INFO Logging for Seeds
2024-06-12 16:59:25,501 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 16:59:25,501 logger.py[line:35] INFO Score for MDtype is: 0.8783783783783784
2024-06-12 16:59:25,501 logger.py[line:35] INFO Score for MDims is: 0.85
2024-06-12 16:59:25,501 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 16:59:25,501 logger.py[line:35] INFO Score for Edge is: 0.8392857142857143
2024-06-12 16:59:25,501 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 16:59:25,501 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 16:59:25,501 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 16:59:25,501 logger.py[line:35] INFO The last used seed is: SpecialI
2024-06-12 16:59:25,501 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 16:59:25,501 logger.py[line:35] INFO Choose seed: inception.resnet.v2-MParam50-MDtype52-MDtype102
2024-06-12 16:59:25,501 logger.py[line:35] INFO start mutating the generated model
2024-06-12 16:59:32,754 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_MParam_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll')>}
2024-06-12 16:59:37,308 logger.py[line:35] INFO Insert 10 out of 19 Global New Layers
2024-06-12 16:59:37,309 logger.py[line:35] INFO insert Flatten after conv2d_75_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 16:59:37,309 logger.py[line:35] INFO insert PReLU after conv2d_39_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 16:59:37,310 logger.py[line:35] INFO insert SeparableConv2D after batch_normalization_84_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 16:59:37,311 logger.py[line:35] INFO insert ReLU after batch_normalization_145_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 16:59:37,311 logger.py[line:35] INFO insert AlphaDropout after batch_normalization_189_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 16:59:37,312 logger.py[line:35] INFO insert DepthwiseConv2D after conv2d_47_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 16:59:37,313 logger.py[line:35] INFO insert ActivityRegularization after block35_6_conv_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 16:59:37,313 logger.py[line:35] INFO insert GlobalMaxPooling2D after batch_normalization_155_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 16:59:37,314 logger.py[line:35] INFO insert ConvLSTM1D after batch_normalization_41_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 16:59:37,315 logger.py[line:35] INFO insert LeakyReLU after conv2d_50_copy_MParam_copy_MDtype_copy_MDtype_copy_NLAll
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 62, in new_layer_addition
    layer_list = selected_layer(output_shape)
  File "/root/implementations/scripts/generation/layer_pools.py", line 463, in conv_lstm_1d
    inserted_layer = ConfigurationUtils.random_config(candidate_layer)
  File "/root/implementations/scripts/generation/layer_pools.py", line 57, in random_config
    new_layer = layer.from_config(layer_config)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 970, in from_config
    return cls(**config)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 1134, in __init__
    **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 842, in __init__
    **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 141, in __init__
    'Unrolling is not possible with convolutional RNNs. '
TypeError: Unrolling is not possible with convolutional RNNs. Received: unroll=True
2024-06-12 16:59:38,527 logger.py[line:35] INFO INFO: Mutation progress 3/100
2024-06-12 16:59:38,527 logger.py[line:35] INFO Logging for Seeds
2024-06-12 16:59:38,527 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 16:59:38,527 logger.py[line:35] INFO Score for MDtype is: 0.8783783783783784
2024-06-12 16:59:38,528 logger.py[line:35] INFO Score for MDims is: 0.85
2024-06-12 16:59:38,528 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 16:59:38,528 logger.py[line:35] INFO Score for Edge is: 0.8392857142857143
2024-06-12 16:59:38,528 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 16:59:38,528 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 16:59:38,528 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 16:59:38,528 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 16:59:38,528 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 16:59:38,528 logger.py[line:35] INFO Choose seed: lenet-LMerg90-NLAll105-NLAll116
2024-06-12 16:59:38,528 logger.py[line:35] INFO start mutating the generated model
2024-06-12 16:59:41,926 logger.py[line:35] INFO Generating model using Edge
model outputs {'dense_15_copy_LMerg_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge')>}
Choosing 6 To Insert
2024-06-12 16:59:42,025 logger.py[line:35] INFO Insert 6 Global New Edges
2024-06-12 16:59:42,025 logger.py[line:35] INFO Candidate Edge: ('RepeatVector', 'Flatten')
2024-06-12 16:59:42,125 logger.py[line:35] INFO Trying Adding Edge: ['RepeatVector', 'Flatten'] by Connecting repeat_vector_insert_copy_NLAll_copy_Edge and flatten_5_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 16:59:42,221 logger.py[line:35] INFO Successfully Add Edge: ['RepeatVector', 'Flatten'] by Connecting repeat_vector_insert_copy_NLAll_copy_Edge and flatten_5_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 16:59:42,221 logger.py[line:35] INFO Candidate Edge: ('Dropout', 'Flatten')
2024-06-12 16:59:42,323 logger.py[line:35] INFO Trying Adding Edge: ['Dropout', 'Flatten'] by Connecting dropout_5_copy_LMerg_merge1_copy_NLAll_copy_NLAll_copy_Edge and flatten_5_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_2
2024-06-12 16:59:42,422 logger.py[line:35] INFO Successfully Add Edge: ['Dropout', 'Flatten'] by Connecting dropout_5_copy_LMerg_merge1_copy_NLAll_copy_NLAll_copy_Edge and flatten_5_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_2
2024-06-12 16:59:42,422 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'ELU')
2024-06-12 16:59:42,527 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'ELU'] by Connecting conv2d_10_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge and elu_insert_copy_Edge
2024-06-12 16:59:42,627 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'ELU'] by Connecting conv2d_10_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge and elu_insert_copy_Edge
2024-06-12 16:59:42,627 logger.py[line:35] INFO Candidate Edge: ('Softmax', 'Conv2D')
2024-06-12 16:59:42,737 logger.py[line:35] INFO Trying Adding Edge: ['Softmax', 'Conv2D'] by Connecting softmax_insert_copy_NLAll_copy_Edge and conv2d_9_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 16:59:42,847 logger.py[line:35] INFO Successfully Add Edge: ['Softmax', 'Conv2D'] by Connecting softmax_insert_copy_NLAll_copy_Edge and conv2d_9_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 16:59:42,847 logger.py[line:35] INFO Candidate Edge: ('Softmax', 'AveragePooling2D')
2024-06-12 16:59:42,966 logger.py[line:35] INFO Trying Adding Edge: ['Softmax', 'AveragePooling2D'] by Connecting softmax_insert_copy_NLAll_copy_Edge and average_pooling2d_10_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 16:59:43,078 logger.py[line:35] INFO Successfully Add Edge: ['Softmax', 'AveragePooling2D'] by Connecting softmax_insert_copy_NLAll_copy_Edge and average_pooling2d_10_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 16:59:43,078 logger.py[line:35] INFO Candidate Edge: ('Softmax', 'ELU')
2024-06-12 16:59:43,196 logger.py[line:35] INFO Trying Adding Edge: ['Softmax', 'ELU'] by Connecting softmax_insert_copy_NLAll_copy_Edge and elu_insert_copy_Edge_2
2024-06-12 16:59:43,310 logger.py[line:35] INFO Successfully Add Edge: ['Softmax', 'ELU'] by Connecting softmax_insert_copy_NLAll_copy_Edge and elu_insert_copy_Edge_2
2024-06-12 16:59:43,375 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 33/2170
The Configuration Coverage is: 120/2049
The NDims Coverage Is: 28/117
The DType Coverage Is: 25/354
The Shape Coverage Is: 45/295
The Input Coverage Is: 98/766
2024-06-12 16:59:44,132 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 16:59:47,906 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 16:59:51,898 logger.py[line:35] INFO 2.9.0
2024-06-12 16:59:53,494 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 16:59:58,036 logger.py[line:35] INFO SUCCESS:Get prediction for lenet-LMerg90-NLAll105-NLAll116-Edge2 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 16:59:59,650 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 16:59:59,650 logger.py[line:35] INFO loading the redis
2024-06-12 16:59:59,653 logger.py[line:35] INFO finish loading from redis
2024-06-12 16:59:59,677 logger.py[line:35] INFO coverage_c=35378
time=15.380034446716309, cov_py=0, cov_c=35378
New test requirements invoked on framework tensorflow when updating lenet-LMerg90-NLAll105-NLAll116-Edge2
2024-06-12 17:00:03,772 logger.py[line:35] INFO Success on backend: tensorflow of model lenet-LMerg90-NLAll105-NLAll116-Edge2
2024-06-12 17:00:03,772 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:00:03,772 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:00:03,772 logger.py[line:35] INFO after_prediction
2024-06-12 17:00:03,772 logger.py[line:35] INFO New representative seed found: lenet-LMerg90-NLAll105-NLAll116-Edge2
2024-06-12 17:00:04,077 logger.py[line:35] INFO INFO: Mutation progress 4/100
2024-06-12 17:00:04,078 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:00:04,078 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:00:04,078 logger.py[line:35] INFO Score for MDtype is: 0.8783783783783784
2024-06-12 17:00:04,078 logger.py[line:35] INFO Score for MDims is: 0.85
2024-06-12 17:00:04,078 logger.py[line:35] INFO Score for Edge is: 0.8448275862068966
2024-06-12 17:00:04,078 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:00:04,078 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:00:04,078 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:00:04,078 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:00:04,078 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:00:04,078 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:00:04,078 logger.py[line:35] INFO Choose seed: lenet-LMerg90-NLAll105-NLAll116
2024-06-12 17:00:04,078 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:00:07,463 logger.py[line:35] INFO Generating model using MDtype
model outputs {'dense_15_copy_LMerg_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_MDtype')>}
2024-06-12 17:00:07,560 logger.py[line:35] INFO Change 1 Layer's DType Out Of 12 Layer classes
2024-06-12 17:00:07,560 logger.py[line:35] INFO Changing 1 out of 12 Layer's DType.
2024-06-12 17:00:07,560 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer conv2d_10_copy_LMerg_copy_NLAll_copy_NLAll_copy_MDtype
model outputs {'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_MDtype')>}
2024-06-12 17:00:07,758 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 33/2170
The Configuration Coverage is: 120/2049
The NDims Coverage Is: 28/117
The DType Coverage Is: 26/354
The Shape Coverage Is: 45/295
The Input Coverage Is: 99/766
2024-06-12 17:00:08,396 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:00:12,541 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:00:16,504 logger.py[line:35] INFO 2.9.0
2024-06-12 17:00:18,129 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 229, in <module>
    predictor.before_predict()
  File "/root/implementations/scripts/prediction/predict_model.py", line 116, in before_predict
    self.model = keras.models.load_model(self.model_path, custom_objects=custom_objects())
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/backend.py", line 4019, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype_numpy(x)))
ValueError: No cast function available.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 235, in <module>
    raise ValueError(f"CRASH ON BACKEND {flags.backend}!!!")
ValueError: CRASH ON BACKEND tensorflow!!!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:00:20,140 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 7s
2024-06-12 17:00:20,140 logger.py[line:35] INFO lenet-LMerg90-NLAll105-NLAll116-MDtype3 crash on backend tensorflow when predicting
2024-06-12 17:00:20,163 logger.py[line:35] INFO coverage_c=35446
time=11.603270769119263, cov_py=0, cov_c=35446
New test requirements invoked on framework tensorflow when updating lenet-LMerg90-NLAll105-NLAll116-MDtype3
2024-06-12 17:00:24,250 logger.py[line:35] INFO Fail on backend: tensorflow of model lenet-LMerg90-NLAll105-NLAll116-MDtype3
2024-06-12 17:00:24,250 logger.py[line:35] INFO Error: Move Crash model
2024-06-12 17:00:24,250 logger.py[line:35] INFO after_prediction
2024-06-12 17:00:24,530 logger.py[line:35] INFO INFO: Mutation progress 5/100
2024-06-12 17:00:24,530 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:00:24,530 logger.py[line:35] INFO Score for MDtype is: 0.881578947368421
2024-06-12 17:00:24,530 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:00:24,530 logger.py[line:35] INFO Score for MDims is: 0.85
2024-06-12 17:00:24,530 logger.py[line:35] INFO Score for Edge is: 0.8448275862068966
2024-06-12 17:00:24,530 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:00:24,530 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:00:24,530 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:00:24,530 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:00:24,530 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:00:24,531 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:00:24,531 logger.py[line:35] INFO Choose seed: inception.resnet.v2-MParam50-MDtype52-MDtype102
2024-06-12 17:00:24,531 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:00:31,805 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_MParam_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype')>}
2024-06-12 17:00:35,452 logger.py[line:35] INFO Change 2 Layer's DType Out Of 5 Layer classes
2024-06-12 17:00:35,453 logger.py[line:35] INFO Changing 2 out of 5 Layer's DType.
2024-06-12 17:00:35,455 logger.py[line:35] INFO Selecting a Global DType float64 For Layer conv2d_168_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype
2024-06-12 17:00:35,457 logger.py[line:35] INFO Selecting a Global DType double For Layer max_pooling2d_3_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype
model outputs {'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype')>}
2024-06-12 17:00:39,267 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 33/2170
The Configuration Coverage is: 129/2049
The NDims Coverage Is: 28/117
The DType Coverage Is: 29/354
The Shape Coverage Is: 51/295
The Input Coverage Is: 108/766
2024-06-12 17:00:45,367 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:00:49,258 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:00:53,503 logger.py[line:35] INFO 2.9.0
2024-06-12 17:00:55,124 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:01:17,960 logger.py[line:35] INFO SUCCESS:Get prediction for inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:01:19,926 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 30s
2024-06-12 17:01:19,926 logger.py[line:35] INFO loading the redis
2024-06-12 17:01:19,929 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:01:19,953 logger.py[line:35] INFO coverage_c=35516
time=34.419535398483276, cov_py=0, cov_c=35516
New test requirements invoked on framework tensorflow when updating inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4
2024-06-12 17:01:24,199 logger.py[line:35] INFO Success on backend: tensorflow of model inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4
2024-06-12 17:01:24,200 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:01:24,200 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:01:24,200 logger.py[line:35] INFO after_prediction
2024-06-12 17:01:24,200 logger.py[line:35] INFO New representative seed found: inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4
2024-06-12 17:01:24,802 logger.py[line:35] INFO INFO: Mutation progress 6/100
2024-06-12 17:01:24,803 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:01:24,803 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:01:24,803 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:01:24,803 logger.py[line:35] INFO Score for MDims is: 0.85
2024-06-12 17:01:24,803 logger.py[line:35] INFO Score for Edge is: 0.8448275862068966
2024-06-12 17:01:24,803 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:01:24,803 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:01:24,803 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:01:24,803 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:01:24,803 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:01:24,803 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:01:24,803 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120-MDtype126
2024-06-12 17:01:24,803 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:01:28,071 logger.py[line:35] INFO Generating model using MDims
model outputs {'dense_3_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDtype_copy_MDims')>}
2024-06-12 17:01:28,167 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 3 Layer classes
2024-06-12 17:01:28,167 logger.py[line:35] INFO Global Layer Class: 3; Local Layer Class: 0; Total Layer Class: 3
2024-06-12 17:01:28,167 logger.py[line:35] INFO Changing 1 out of 3 Layer's NDims.
2024-06-12 17:01:28,167 logger.py[line:35] INFO Selecting a Global NDims 6 For Layer dropout_1_copy_SpecialI_copy_MDtype_copy_MDims
model outputs {'dense_3_copy_SpecialI_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDtype_copy_MDims')>}
2024-06-12 17:01:28,390 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 37/2170
The Configuration Coverage is: 130/2049
The NDims Coverage Is: 29/117
The DType Coverage Is: 29/354
The Shape Coverage Is: 54/295
The Input Coverage Is: 112/766
2024-06-12 17:01:29,238 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:01:33,009 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:01:37,004 logger.py[line:35] INFO 2.9.0
2024-06-12 17:01:38,654 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:01:43,064 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-SpecialI120-MDtype126-MDims5 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:01:44,704 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 17:01:44,705 logger.py[line:35] INFO loading the redis
2024-06-12 17:01:44,707 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:01:44,731 logger.py[line:35] INFO coverage_c=35726
time=15.329578638076782, cov_py=0, cov_c=35726
New test requirements invoked on framework tensorflow when updating alexnet-SpecialI120-MDtype126-MDims5
2024-06-12 17:01:48,921 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-SpecialI120-MDtype126-MDims5
2024-06-12 17:01:48,921 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:01:48,921 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:01:48,921 logger.py[line:35] INFO after_prediction
2024-06-12 17:01:48,921 logger.py[line:35] INFO New representative seed found: alexnet-SpecialI120-MDtype126-MDims5
2024-06-12 17:01:49,222 logger.py[line:35] INFO INFO: Mutation progress 7/100
2024-06-12 17:01:49,222 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:01:49,222 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:01:49,222 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:01:49,222 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:01:49,222 logger.py[line:35] INFO Score for Edge is: 0.8448275862068966
2024-06-12 17:01:49,222 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:01:49,222 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:01:49,222 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:01:49,222 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:01:49,222 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:01:49,222 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:01:49,222 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1
2024-06-12 17:01:49,222 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:01:53,808 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge')>}
Choosing 1 To Insert
2024-06-12 17:01:54,917 logger.py[line:35] INFO Insert 1 Global New Edges
2024-06-12 17:01:54,917 logger.py[line:35] INFO Candidate Edge: ('Conv2DTranspose', 'ELU')
2024-06-12 17:01:56,136 logger.py[line:35] INFO Trying Adding Edge: ['Conv2DTranspose', 'ELU'] by Connecting conv2d_transpose_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge and elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:01:57,384 logger.py[line:35] INFO Successfully Add Edge: ['Conv2DTranspose', 'ELU'] by Connecting conv2d_transpose_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge and elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:01:57,483 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 56/2170
The Configuration Coverage is: 216/2049
The NDims Coverage Is: 38/117
The DType Coverage Is: 40/354
The Shape Coverage Is: 74/295
The Input Coverage Is: 152/766
2024-06-12 17:01:59,674 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:02:03,632 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:02:07,744 logger.py[line:35] INFO 2.9.0
2024-06-12 17:02:09,374 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:02:19,426 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:02:21,185 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 17s
2024-06-12 17:02:21,185 logger.py[line:35] INFO loading the redis
2024-06-12 17:02:21,187 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:02:21,213 logger.py[line:35] INFO coverage_c=36005
time=21.376407623291016, cov_py=0, cov_c=36005
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6
2024-06-12 17:02:25,505 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6
2024-06-12 17:02:25,506 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:02:25,506 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:02:25,506 logger.py[line:35] INFO after_prediction
2024-06-12 17:02:25,506 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6
2024-06-12 17:02:25,903 logger.py[line:35] INFO INFO: Mutation progress 8/100
2024-06-12 17:02:25,903 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:02:25,903 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:02:25,903 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:02:25,903 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:02:25,903 logger.py[line:35] INFO Score for Edge is: 0.85
2024-06-12 17:02:25,903 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:02:25,903 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:02:25,903 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:02:25,903 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:02:25,903 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:02:25,903 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:02:25,903 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131
2024-06-12 17:02:25,904 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:02:30,104 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge')>}
Choosing 8 To Insert
2024-06-12 17:02:31,088 logger.py[line:35] INFO Insert 8 Global New Edges
2024-06-12 17:02:31,089 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'ZeroPadding2D')
2024-06-12 17:02:32,082 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'ZeroPadding2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:32,995 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'ZeroPadding2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:32,996 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'GlobalAveragePooling2D')
2024-06-12 17:02:34,152 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'GlobalAveragePooling2D'] by Connecting conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1 and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:35,062 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'GlobalAveragePooling2D'] by Connecting conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1 and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:35,062 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'GlobalAveragePooling2D')
2024-06-12 17:02:36,054 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'GlobalAveragePooling2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1
2024-06-12 17:02:36,957 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'GlobalAveragePooling2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1
2024-06-12 17:02:36,957 logger.py[line:35] INFO Candidate Edge: ('BatchNormalization', 'GlobalAveragePooling2D')
2024-06-12 17:02:38,145 logger.py[line:35] INFO Trying Adding Edge: ['BatchNormalization', 'GlobalAveragePooling2D'] by Connecting conv2_block3_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_1
2024-06-12 17:02:39,050 logger.py[line:35] INFO Successfully Add Edge: ['BatchNormalization', 'GlobalAveragePooling2D'] by Connecting conv2_block3_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_1
2024-06-12 17:02:39,050 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'BatchNormalization')
2024-06-12 17:02:40,046 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'BatchNormalization'] by Connecting conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1 and conv3_block1_0_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:41,113 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'BatchNormalization'] by Connecting conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1 and conv3_block1_0_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:41,113 logger.py[line:35] INFO Candidate Edge: ('BatchNormalization', 'ZeroPadding2D')
2024-06-12 17:02:42,120 logger.py[line:35] INFO Trying Adding Edge: ['BatchNormalization', 'ZeroPadding2D'] by Connecting conv4_block3_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1
2024-06-12 17:02:43,041 logger.py[line:35] INFO Successfully Add Edge: ['BatchNormalization', 'ZeroPadding2D'] by Connecting conv4_block3_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1
2024-06-12 17:02:43,041 logger.py[line:35] INFO Candidate Edge: ('BatchNormalization', 'BatchNormalization')
2024-06-12 17:02:44,245 logger.py[line:35] INFO Trying Adding Edge: ['BatchNormalization', 'BatchNormalization'] by Connecting conv4_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and conv5_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:45,167 logger.py[line:35] INFO Successfully Add Edge: ['BatchNormalization', 'BatchNormalization'] by Connecting conv4_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and conv5_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:45,167 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'MaxPooling2D')
2024-06-12 17:02:46,187 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'MaxPooling2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:47,113 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'MaxPooling2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge and pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge
2024-06-12 17:02:47,256 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 67/2170
The Configuration Coverage is: 222/2049
The NDims Coverage Is: 38/117
The DType Coverage Is: 41/354
The Shape Coverage Is: 78/295
The Input Coverage Is: 157/766
2024-06-12 17:02:49,556 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:02:53,459 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:02:57,576 logger.py[line:35] INFO 2.9.0
2024-06-12 17:02:59,162 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:03:08,665 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-Edge7 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:03:10,411 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:03:10,411 logger.py[line:35] INFO loading the redis
2024-06-12 17:03:10,414 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:03:10,435 logger.py[line:35] INFO coverage_c=36006
time=20.715622186660767, cov_py=0, cov_c=36006
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-Edge7
2024-06-12 17:03:14,719 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-Edge7
2024-06-12 17:03:14,719 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:03:14,719 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:03:14,719 logger.py[line:35] INFO after_prediction
2024-06-12 17:03:14,719 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-Edge7
2024-06-12 17:03:15,094 logger.py[line:35] INFO INFO: Mutation progress 9/100
2024-06-12 17:03:15,094 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:03:15,094 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:03:15,094 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:03:15,094 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:03:15,094 logger.py[line:35] INFO Score for Edge is: 0.8548387096774194
2024-06-12 17:03:15,094 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:03:15,094 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:03:15,094 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:03:15,094 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:03:15,094 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:03:15,094 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:03:15,094 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MParam115
2024-06-12 17:03:15,094 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:03:17,917 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:03:18,562 logger.py[line:35] INFO Generating model using MDims
2024-06-12 17:03:18,565 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims')>}
2024-06-12 17:03:18,702 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:03:18,702 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:03:18,702 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:03:18,702 logger.py[line:35] INFO Selecting a Global NDims 5 For Layer dropout_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims
2024-06-12 17:03:18,705 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims')>}
2024-06-12 17:03:18,874 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:03:19,437 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 67/2170
The Configuration Coverage is: 223/2049
The NDims Coverage Is: 39/117
The DType Coverage Is: 41/354
The Shape Coverage Is: 79/295
The Input Coverage Is: 159/766
2024-06-12 17:03:19,612 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:03:23,398 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:03:27,387 logger.py[line:35] INFO 2.9.0
2024-06-12 17:03:28,967 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:03:31,522 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MParam115-MDims8 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:03:32,690 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:03:32,691 logger.py[line:35] INFO loading the redis
2024-06-12 17:03:32,693 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:03:32,715 logger.py[line:35] INFO coverage_c=36045
time=12.938439130783081, cov_py=0, cov_c=36045
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MParam115-MDims8
2024-06-12 17:03:36,895 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MParam115-MDims8
2024-06-12 17:03:36,895 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:03:36,895 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:03:36,895 logger.py[line:35] INFO after_prediction
2024-06-12 17:03:36,895 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MParam115-MDims8
2024-06-12 17:03:37,195 logger.py[line:35] INFO INFO: Mutation progress 10/100
2024-06-12 17:03:37,195 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:03:37,195 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:03:37,195 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:03:37,195 logger.py[line:35] INFO Score for MDims is: 0.8636363636363636
2024-06-12 17:03:37,196 logger.py[line:35] INFO Score for Edge is: 0.8548387096774194
2024-06-12 17:03:37,196 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:03:37,196 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:03:37,196 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:03:37,196 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:03:37,196 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:03:37,196 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:03:37,196 logger.py[line:35] INFO Choose seed: alexnet-Edge3-SpecialI7-LMerg20-Edge51-NLAll74
2024-06-12 17:03:37,196 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:03:40,461 logger.py[line:35] INFO Generating model using Edge
model outputs {'dense_3_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge')>, 'flatten_1_copy_Edge_2_1_copy_SpecialI_copy_LMerg_copy_Edge_1_copy_NLAll': <KerasTensor: shape=(None, 4096) dtype=float32 (created by layer 'flatten_1_copy_Edge_2_1_copy_SpecialI_copy_LMerg_copy_Edge_1_copy_NLAll_copy_Edge')>, 'flatten_1_copy_Edge_2_2_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'flatten_1_copy_Edge_2_2_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge')>, 'dropout_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 3, 3, 256) dtype=float32 (created by layer 'dropout_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_2_copy_NLAll_copy_Edge')>, 'flatten_1_copy_Edge_2_1_copy_SpecialI_copy_LMerg_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 6144) dtype=float32 (created by layer 'flatten_1_copy_Edge_2_1_copy_SpecialI_copy_LMerg_copy_Edge_2_copy_NLAll_copy_Edge')>, 'dropout_2_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 3, 3, 256) dtype=float32 (created by layer 'dropout_2_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_2_copy_NLAll_copy_Edge')>}
Choosing 7 To Insert
2024-06-12 17:03:40,569 logger.py[line:35] INFO Insert 7 Global New Edges
2024-06-12 17:03:40,569 logger.py[line:35] INFO Candidate Edge: ('AlphaDropout', 'Dropout')
2024-06-12 17:03:40,682 logger.py[line:35] INFO Trying Adding Edge: ['AlphaDropout', 'Dropout'] by Connecting alpha_dropout_insert_copy_Edge and dropout_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_1_copy_NLAll_copy_Edge
2024-06-12 17:03:40,788 logger.py[line:35] INFO Successfully Add Edge: ['AlphaDropout', 'Dropout'] by Connecting alpha_dropout_insert_copy_Edge and dropout_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_1_copy_NLAll_copy_Edge
2024-06-12 17:03:40,788 logger.py[line:35] INFO Candidate Edge: ('AlphaDropout', 'MaxPooling2D')
2024-06-12 17:03:40,901 logger.py[line:35] INFO Trying Adding Edge: ['AlphaDropout', 'MaxPooling2D'] by Connecting alpha_dropout_insert_copy_Edge and max_pooling2d_2_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge
2024-06-12 17:03:41,010 logger.py[line:35] INFO Successfully Add Edge: ['AlphaDropout', 'MaxPooling2D'] by Connecting alpha_dropout_insert_copy_Edge and max_pooling2d_2_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge
2024-06-12 17:03:41,010 logger.py[line:35] INFO Candidate Edge: ('Softmax', 'Dropout')
2024-06-12 17:03:41,126 logger.py[line:35] INFO Trying Adding Edge: ['Softmax', 'Dropout'] by Connecting softmax_insert_copy_Edge and dropout_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_1_copy_NLAll_copy_Edge_2
2024-06-12 17:03:41,235 logger.py[line:35] INFO Successfully Add Edge: ['Softmax', 'Dropout'] by Connecting softmax_insert_copy_Edge and dropout_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_1_copy_NLAll_copy_Edge_2
2024-06-12 17:03:41,235 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'Softmax')
2024-06-12 17:03:41,359 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'Softmax'] by Connecting max_pooling2d_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge and softmax_insert_copy_Edge
2024-06-12 17:03:41,476 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'Softmax'] by Connecting max_pooling2d_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge and softmax_insert_copy_Edge
2024-06-12 17:03:41,476 logger.py[line:35] INFO Candidate Edge: ('BatchNormalization', 'Dropout')
2024-06-12 17:03:41,598 logger.py[line:35] INFO Trying Adding Edge: ['BatchNormalization', 'Dropout'] by Connecting batch_normalization_2_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge and dropout_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_1_copy_NLAll_copy_Edge_2_2
2024-06-12 17:03:41,712 logger.py[line:35] INFO Successfully Add Edge: ['BatchNormalization', 'Dropout'] by Connecting batch_normalization_2_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge and dropout_1_copy_Edge_copy_SpecialI_copy_LMerg_copy_Edge_1_copy_NLAll_copy_Edge_2_2
2024-06-12 17:03:41,712 logger.py[line:35] INFO Candidate Edge: ('Softmax', 'Flatten')
2024-06-12 17:03:41,834 logger.py[line:35] INFO Trying Adding Edge: ['Softmax', 'Flatten'] by Connecting softmax_insert_copy_Edge_2 and flatten_1_copy_Edge_1_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge
2024-06-12 17:03:42,110 logger.py[line:35] INFO Successfully Add Edge: ['Softmax', 'Flatten'] by Connecting softmax_insert_copy_Edge_2 and flatten_1_copy_Edge_1_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge
2024-06-12 17:03:42,110 logger.py[line:35] INFO Candidate Edge: ('Flatten', 'Flatten')
2024-06-12 17:03:42,234 logger.py[line:35] INFO Trying Adding Edge: ['Flatten', 'Flatten'] by Connecting flatten_1_copy_Edge_1_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge_2 and flatten_1_copy_Edge_2_1_copy_SpecialI_copy_LMerg_copy_Edge_2_copy_NLAll_copy_Edge
2024-06-12 17:03:42,352 logger.py[line:35] INFO Successfully Add Edge: ['Flatten', 'Flatten'] by Connecting flatten_1_copy_Edge_1_copy_SpecialI_copy_LMerg_copy_Edge_copy_NLAll_copy_Edge_2 and flatten_1_copy_Edge_2_1_copy_SpecialI_copy_LMerg_copy_Edge_2_copy_NLAll_copy_Edge
2024-06-12 17:03:42,450 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 78/2170
The Configuration Coverage is: 223/2049
The NDims Coverage Is: 41/117
The DType Coverage Is: 42/354
The Shape Coverage Is: 81/295
The Input Coverage Is: 164/766
2024-06-12 17:03:43,358 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:03:47,233 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:03:51,229 logger.py[line:35] INFO 2.9.0
2024-06-12 17:03:52,842 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:03:57,356 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-Edge3-SpecialI7-LMerg20-Edge51-NLAll74-Edge9 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:03:58,979 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 17:03:58,980 logger.py[line:35] INFO loading the redis
2024-06-12 17:03:58,982 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:03:59,004 logger.py[line:35] INFO coverage_c=36047
time=15.482575416564941, cov_py=0, cov_c=36047
New test requirements invoked on framework tensorflow when updating alexnet-Edge3-SpecialI7-LMerg20-Edge51-NLAll74-Edge9
2024-06-12 17:04:03,251 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-Edge3-SpecialI7-LMerg20-Edge51-NLAll74-Edge9
2024-06-12 17:04:03,251 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:04:03,251 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:04:03,251 logger.py[line:35] INFO after_prediction
2024-06-12 17:04:03,251 logger.py[line:35] INFO New representative seed found: alexnet-Edge3-SpecialI7-LMerg20-Edge51-NLAll74-Edge9
2024-06-12 17:04:03,554 logger.py[line:35] INFO INFO: Mutation progress 11/100
2024-06-12 17:04:03,554 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:04:03,554 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:04:03,554 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:04:03,554 logger.py[line:35] INFO Score for MDims is: 0.8636363636363636
2024-06-12 17:04:03,554 logger.py[line:35] INFO Score for Edge is: 0.859375
2024-06-12 17:04:03,555 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:04:03,555 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:04:03,555 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:04:03,555 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:04:03,555 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:04:03,555 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:04:03,555 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-NLAll124
2024-06-12 17:04:03,555 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:04:06,403 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:04:07,162 logger.py[line:35] INFO Generating model using MDims
2024-06-12 17:04:07,165 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDims')>}
2024-06-12 17:04:07,379 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 3 Layer classes
2024-06-12 17:04:07,379 logger.py[line:35] INFO Global Layer Class: 2; Local Layer Class: 1; Total Layer Class: 3
2024-06-12 17:04:07,379 logger.py[line:35] INFO Changing 1 out of 2 Layer's NDims.
2024-06-12 17:04:07,380 logger.py[line:35] INFO Selecting a Global NDims 3 For Layer gaussian_dropout_insert_copy_NLAll_copy_MDims
2024-06-12 17:04:07,383 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDims')>}
2024-06-12 17:04:07,627 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:04:08,274 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 78/2170
The Configuration Coverage is: 223/2049
The NDims Coverage Is: 42/117
The DType Coverage Is: 42/354
The Shape Coverage Is: 82/295
The Input Coverage Is: 166/766
2024-06-12 17:04:08,528 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:04:12,318 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:04:16,348 logger.py[line:35] INFO 2.9.0
2024-06-12 17:04:17,916 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:04:23,276 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-NLAll54-NLAll124-MDims10 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:04:25,066 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:04:25,066 logger.py[line:35] INFO loading the redis
2024-06-12 17:04:25,069 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:04:25,090 logger.py[line:35] INFO coverage_c=36047
time=16.396965503692627, cov_py=0, cov_c=36047
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-NLAll124-MDims10
2024-06-12 17:04:29,287 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-NLAll54-NLAll124-MDims10
2024-06-12 17:04:29,287 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:04:29,287 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:04:29,287 logger.py[line:35] INFO after_prediction
2024-06-12 17:04:29,287 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-NLAll54-NLAll124-MDims10
2024-06-12 17:04:29,584 logger.py[line:35] INFO INFO: Mutation progress 12/100
2024-06-12 17:04:29,585 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:04:29,585 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:04:29,585 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:04:29,585 logger.py[line:35] INFO Score for MDims is: 0.8695652173913043
2024-06-12 17:04:29,585 logger.py[line:35] INFO Score for Edge is: 0.859375
2024-06-12 17:04:29,585 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:04:29,585 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:04:29,585 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:04:29,585 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:04:29,585 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:04:29,585 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:04:29,585 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-NLAll99
2024-06-12 17:04:29,585 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:04:33,880 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDims')>}
2024-06-12 17:04:34,873 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:04:34,873 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:04:34,873 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:04:34,875 logger.py[line:35] INFO Selecting a Global NDims 6 For Layer conv4_block5_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDims
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDims': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDims')>}
2024-06-12 17:04:35,933 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 79/2170
The Configuration Coverage is: 224/2049
The NDims Coverage Is: 43/117
The DType Coverage Is: 42/354
The Shape Coverage Is: 82/295
The Input Coverage Is: 167/766
2024-06-12 17:04:37,935 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:04:41,845 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:04:45,965 logger.py[line:35] INFO 2.9.0
2024-06-12 17:04:47,564 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:04:56,626 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDims11 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:04:58,347 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:04:58,347 logger.py[line:35] INFO loading the redis
2024-06-12 17:04:58,350 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:04:58,371 logger.py[line:35] INFO coverage_c=36053
time=20.270215034484863, cov_py=0, cov_c=36053
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDims11
2024-06-12 17:05:02,546 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDims11
2024-06-12 17:05:02,546 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:05:02,546 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:05:02,546 logger.py[line:35] INFO after_prediction
2024-06-12 17:05:02,546 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDims11
2024-06-12 17:05:02,918 logger.py[line:35] INFO INFO: Mutation progress 13/100
2024-06-12 17:05:02,918 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:05:02,918 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:05:02,918 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:05:02,918 logger.py[line:35] INFO Score for MDims is: 0.875
2024-06-12 17:05:02,918 logger.py[line:35] INFO Score for Edge is: 0.859375
2024-06-12 17:05:02,918 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:05:02,918 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:05:02,918 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:05:02,918 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:05:02,918 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:05:02,919 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:05:02,919 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94
2024-06-12 17:05:02,919 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:05:07,170 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge')>}
Choosing 4 To Insert
2024-06-12 17:05:08,213 logger.py[line:35] INFO Insert 1 Global New Edges
2024-06-12 17:05:08,213 logger.py[line:35] INFO Insert 3 Local New Edges
2024-06-12 17:05:08,213 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'ZeroPadding2D')
2024-06-12 17:05:09,198 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'ZeroPadding2D'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge
2024-06-12 17:05:10,124 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'ZeroPadding2D'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge
2024-06-12 17:05:10,124 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'BatchNormalization')
2024-06-12 17:05:11,363 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'BatchNormalization'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge_1 and conv4_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge
2024-06-12 17:05:12,270 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'BatchNormalization'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge_1 and conv4_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge
2024-06-12 17:05:12,270 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'ZeroPadding2D')
2024-06-12 17:05:13,269 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'ZeroPadding2D'] by Connecting conv2_block1_0_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge_1
2024-06-12 17:05:14,183 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'ZeroPadding2D'] by Connecting conv2_block1_0_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge_1
2024-06-12 17:05:14,183 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'MaxPooling2D')
2024-06-12 17:05:15,368 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'MaxPooling2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge and pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge
2024-06-12 17:05:16,279 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'MaxPooling2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge and pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_Edge
2024-06-12 17:05:16,389 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 80/2170
The Configuration Coverage is: 224/2049
The NDims Coverage Is: 43/117
The DType Coverage Is: 42/354
The Shape Coverage Is: 82/295
The Input Coverage Is: 167/766
2024-06-12 17:05:18,364 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:05:22,258 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:05:26,371 logger.py[line:35] INFO 2.9.0
2024-06-12 17:05:27,945 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:05:36,915 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-MParam94-Edge12 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:05:38,609 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:05:38,610 logger.py[line:35] INFO loading the redis
2024-06-12 17:05:38,612 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:05:38,634 logger.py[line:35] INFO coverage_c=36053
time=20.104952096939087, cov_py=0, cov_c=36053
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-MParam94-Edge12
2024-06-12 17:05:42,829 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-MParam94-Edge12
2024-06-12 17:05:42,829 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:05:42,829 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:05:42,829 logger.py[line:35] INFO after_prediction
2024-06-12 17:05:42,829 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-MParam94-Edge12
2024-06-12 17:05:43,197 logger.py[line:35] INFO INFO: Mutation progress 14/100
2024-06-12 17:05:43,197 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:05:43,197 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:05:43,197 logger.py[line:35] INFO Score for NLAll is: 0.88
2024-06-12 17:05:43,197 logger.py[line:35] INFO Score for MDims is: 0.875
2024-06-12 17:05:43,197 logger.py[line:35] INFO Score for Edge is: 0.8636363636363636
2024-06-12 17:05:43,197 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:05:43,197 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:05:43,197 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:05:43,197 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:05:43,197 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:05:43,198 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:05:43,198 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-MDtype45-MDims106
2024-06-12 17:05:43,198 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:05:46,033 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:05:46,723 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 17:05:46,726 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll')>}
2024-06-12 17:05:46,915 logger.py[line:35] INFO Insert 1 out of 27 Global New Layers
2024-06-12 17:05:46,916 logger.py[line:35] INFO insert TimeDistributed after up_sampling3d_insert_copy_MDtype_copy_MDims_copy_NLAll
2024-06-12 17:05:46,919 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.wrappers.TimeDistributed object at 0x7fc66c625710>
2024-06-12 17:05:47,035 logger.py[line:35] INFO Converting output shape (None, 1, 9, 9, 225) to actual shape [None, 1, 9, 9, 225]
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll')>}
2024-06-12 17:05:47,101 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:05:47,688 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 81/2170
The Configuration Coverage is: 224/2049
The NDims Coverage Is: 44/117
The DType Coverage Is: 44/354
The Shape Coverage Is: 83/295
The Input Coverage Is: 171/766
2024-06-12 17:05:47,870 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:05:51,674 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:05:55,698 logger.py[line:35] INFO 2.9.0
2024-06-12 17:05:57,337 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:06:00,069 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-MDtype45-MDims106-NLAll13 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:06:01,368 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:06:01,368 logger.py[line:35] INFO loading the redis
2024-06-12 17:06:01,371 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:06:01,393 logger.py[line:35] INFO coverage_c=36063
time=13.356942176818848, cov_py=0, cov_c=36063
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-MDtype45-MDims106-NLAll13
2024-06-12 17:06:05,598 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-MDtype45-MDims106-NLAll13
2024-06-12 17:06:05,598 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:06:05,598 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:06:05,598 logger.py[line:35] INFO after_prediction
2024-06-12 17:06:05,598 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-MDtype45-MDims106-NLAll13
2024-06-12 17:06:05,902 logger.py[line:35] INFO INFO: Mutation progress 15/100
2024-06-12 17:06:05,902 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:06:05,902 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:06:05,902 logger.py[line:35] INFO Score for NLAll is: 0.8823529411764706
2024-06-12 17:06:05,902 logger.py[line:35] INFO Score for MDims is: 0.875
2024-06-12 17:06:05,903 logger.py[line:35] INFO Score for Edge is: 0.8636363636363636
2024-06-12 17:06:05,903 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:06:05,903 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:06:05,903 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:06:05,903 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:06:05,903 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:06:05,903 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:06:05,903 logger.py[line:35] INFO Choose seed: inception.resnet.v2-NLAll108
2024-06-12 17:06:05,903 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:06:13,225 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_NLAll_copy_NLAll')>}
2024-06-12 17:06:17,958 logger.py[line:35] INFO Insert 6 out of 6 Global New Layers
2024-06-12 17:06:17,960 logger.py[line:35] INFO insert ConvLSTM1D after conv2d_45_copy_NLAll_copy_NLAll
2024-06-12 17:06:17,961 logger.py[line:35] INFO insert SeparableConv2D after block35_2_conv_copy_NLAll_copy_NLAll
2024-06-12 17:06:17,961 logger.py[line:35] INFO insert LocallyConnected2D after conv2d_133_copy_NLAll_copy_NLAll
2024-06-12 17:06:17,962 logger.py[line:35] INFO insert GaussianNoise after batch_normalization_125_copy_NLAll_copy_NLAll
2024-06-12 17:06:17,963 logger.py[line:35] INFO insert ReLU after conv2d_202_copy_NLAll_copy_NLAll
2024-06-12 17:06:17,963 logger.py[line:35] INFO insert LayerNormalization after batch_normalization_2_copy_NLAll_copy_NLAll
2024-06-12 17:06:17,963 logger.py[line:35] INFO Insert 4 out of 23 Local New Layers
2024-06-12 17:06:17,964 logger.py[line:35] INFO insert ZeroPadding2D after alpha_dropout_insert_copy_NLAll
2024-06-12 17:06:17,964 logger.py[line:35] INFO insert Conv2DTranspose after conv2d_151_copy_NLAll_copy_NLAll
2024-06-12 17:06:17,964 logger.py[line:35] INFO insert ELU after batch_normalization_93_copy_NLAll_copy_NLAll
2024-06-12 17:06:17,964 logger.py[line:35] INFO insert GlobalAveragePooling2D after average_pooling2d_1_copy_NLAll_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.convolutional.ZeroPadding2D object at 0x7f8bd8732b90>
2024-06-12 17:06:17,984 logger.py[line:35] INFO Converting output shape (None, 157, 157, 32) to actual shape [None, 149, 149, 32]
[DEBUG] Inserting layer: <keras.layers.normalization.layer_normalization.LayerNormalization object at 0x7f8bd8610550>
2024-06-12 17:06:18,129 logger.py[line:35] INFO Converting output shape (None, 147, 147, 32) to actual shape [None, 147, 147, 32]
[DEBUG] Inserting layer: <keras.layers.pooling.GlobalAveragePooling2D object at 0x7f8bd8650190>
2024-06-12 17:06:18,220 logger.py[line:35] INFO Converting output shape (None, 35) to actual shape [None, 35, 35, 192]
[DEBUG] Inserting layer: <keras.layers.convolutional.SeparableConv2D object at 0x7f8bd855bdd0>
2024-06-12 17:06:18,547 logger.py[line:35] INFO Converting output shape (None, 320, 35, 320) to actual shape [None, 35, 35, 320]
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 62, in new_layer_addition
    layer_list = selected_layer(output_shape)
  File "/root/implementations/scripts/generation/layer_pools.py", line 463, in conv_lstm_1d
    inserted_layer = ConfigurationUtils.random_config(candidate_layer)
  File "/root/implementations/scripts/generation/layer_pools.py", line 57, in random_config
    new_layer = layer.from_config(layer_config)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 970, in from_config
    return cls(**config)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 1134, in __init__
    **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 842, in __init__
    **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 141, in __init__
    'Unrolling is not possible with convolutional RNNs. '
TypeError: Unrolling is not possible with convolutional RNNs. Received: unroll=True
2024-06-12 17:06:19,719 logger.py[line:35] INFO INFO: Mutation progress 15/100
2024-06-12 17:06:19,719 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:06:19,719 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:06:19,719 logger.py[line:35] INFO Score for NLAll is: 0.8823529411764706
2024-06-12 17:06:19,719 logger.py[line:35] INFO Score for MDims is: 0.875
2024-06-12 17:06:19,720 logger.py[line:35] INFO Score for Edge is: 0.8636363636363636
2024-06-12 17:06:19,720 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:06:19,720 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:06:19,720 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:06:19,720 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:06:19,720 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:06:19,720 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:06:19,720 logger.py[line:35] INFO Choose seed: resnet50-Edge65-NLAll107-MDtype121-MDims123
2024-06-12 17:06:19,720 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:06:24,163 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_Edge_copy_NLAll_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll')>, 'cropping2d_copy_NLAll_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'cropping2d_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll')>, 're_lu_insert_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 're_lu_insert_copy_MDtype_copy_MDims_copy_NLAll')>}
2024-06-12 17:06:25,371 logger.py[line:35] INFO Insert 4 out of 14 Global New Layers
2024-06-12 17:06:25,371 logger.py[line:35] INFO insert LayerNormalization after conv2_block3_2_conv_copy_Edge_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll
2024-06-12 17:06:25,371 logger.py[line:35] INFO insert ConvLSTM2D after gaussian_noise_insert_copy_MDtype_copy_MDims_copy_NLAll
2024-06-12 17:06:25,372 logger.py[line:35] INFO insert ConvLSTM1D after conv5_block3_1_bn_copy_Edge_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll
2024-06-12 17:06:25,372 logger.py[line:35] INFO insert Cropping3D after gaussian_noise_insert_copy_MDtype_copy_MDims_copy_NLAll
2024-06-12 17:06:25,372 logger.py[line:35] INFO Insert 1 out of 27 Local New Layers
2024-06-12 17:06:25,372 logger.py[line:35] INFO insert Dropout after conv5_block1_0_conv_copy_Edge_copy_NLAll_copy_MDtype_copy_MDims_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.normalization.layer_normalization.LayerNormalization object at 0x7f820858bb50>
2024-06-12 17:06:25,549 logger.py[line:35] INFO Converting output shape (None, 56, 56, 64) to actual shape [None, 56, 56, 64]
[DEBUG] Inserting layer: <keras.layers.convolutional.Cropping3D object at 0x7f8208426510>
2024-06-12 17:06:25,831 logger.py[line:35] INFO Converting output shape (None, 1, 12, 12, 1024) to actual shape [None, 1, 14, 14, 1024]
[DEBUG] Inserting layer: <keras.layers.core.dropout.Dropout object at 0x7f82083674d0>
2024-06-12 17:06:26,163 logger.py[line:35] INFO Converting output shape (None, 7, 7, 2048) to actual shape [None, 7, 7, 2048]
[DEBUG] Inserting layer: <keras.layers.convolutional_recurrent.ConvLSTM1D object at 0x7f82082b3f50>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 73, in new_layer_addition
    mylogger.info(f"Converting output shape {layer_input.shape} to actual shape {target_shape}")
AttributeError: 'list' object has no attribute 'shape'
2024-06-12 17:06:28,978 logger.py[line:35] INFO INFO: Mutation progress 15/100
2024-06-12 17:06:28,978 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:06:28,978 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:06:28,978 logger.py[line:35] INFO Score for NLAll is: 0.8823529411764706
2024-06-12 17:06:28,978 logger.py[line:35] INFO Score for MDims is: 0.875
2024-06-12 17:06:28,978 logger.py[line:35] INFO Score for Edge is: 0.8636363636363636
2024-06-12 17:06:28,978 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:06:28,978 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:06:28,978 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:06:28,978 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:06:28,979 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:06:28,979 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:06:28,979 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111
2024-06-12 17:06:28,979 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:06:33,250 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims')>}
2024-06-12 17:06:34,250 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:06:34,250 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:06:34,250 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:06:34,251 logger.py[line:35] INFO Selecting a Global NDims 5 For Layer conv2_block1_0_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims')>}
2024-06-12 17:06:35,314 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 81/2170
The Configuration Coverage is: 224/2049
The NDims Coverage Is: 45/117
The DType Coverage Is: 44/354
The Shape Coverage Is: 83/295
The Input Coverage Is: 172/766
2024-06-12 17:06:37,342 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:06:41,276 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:06:45,428 logger.py[line:35] INFO 2.9.0
2024-06-12 17:06:47,050 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:06:56,189 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:06:57,928 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:06:57,928 logger.py[line:35] INFO loading the redis
2024-06-12 17:06:57,931 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:06:57,953 logger.py[line:35] INFO coverage_c=36063
time=20.433717012405396, cov_py=0, cov_c=36063
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14
2024-06-12 17:07:02,140 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14
2024-06-12 17:07:02,141 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:07:02,141 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:07:02,141 logger.py[line:35] INFO after_prediction
2024-06-12 17:07:02,141 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14
2024-06-12 17:07:02,514 logger.py[line:35] INFO INFO: Mutation progress 16/100
2024-06-12 17:07:02,514 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:07:02,514 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:07:02,514 logger.py[line:35] INFO Score for NLAll is: 0.8823529411764706
2024-06-12 17:07:02,514 logger.py[line:35] INFO Score for MDims is: 0.88
2024-06-12 17:07:02,514 logger.py[line:35] INFO Score for Edge is: 0.8636363636363636
2024-06-12 17:07:02,514 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:07:02,514 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:07:02,514 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:07:02,514 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:07:02,514 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:07:02,514 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:07:02,514 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113
2024-06-12 17:07:02,514 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:07:05,352 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:07:06,034 logger.py[line:35] INFO Generating model using Edge
2024-06-12 17:07:06,039 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge')>}
Choosing 2 To Insert
2024-06-12 17:07:06,188 logger.py[line:35] INFO Insert 2 Global New Edges
2024-06-12 17:07:06,188 logger.py[line:35] INFO Candidate Edge: ('UpSampling3D', 'Dropout')
2024-06-12 17:07:06,196 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:07:06,341 logger.py[line:35] INFO Trying Adding Edge: ['UpSampling3D', 'Dropout'] by Connecting up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge
2024-06-12 17:07:06,345 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:07:06,493 logger.py[line:35] INFO Successfully Add Edge: ['UpSampling3D', 'Dropout'] by Connecting up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge
2024-06-12 17:07:06,493 logger.py[line:35] INFO Candidate Edge: ('LSTM', 'Dropout')
2024-06-12 17:07:06,501 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:07:06,652 logger.py[line:35] INFO Trying Adding Edge: ['LSTM', 'Dropout'] by Connecting lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge_1
2024-06-12 17:07:06,657 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:07:06,808 logger.py[line:35] INFO Successfully Add Edge: ['LSTM', 'Dropout'] by Connecting lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge_1
2024-06-12 17:07:06,845 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:07:07,435 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 84/2170
The Configuration Coverage is: 224/2049
The NDims Coverage Is: 45/117
The DType Coverage Is: 46/354
The Shape Coverage Is: 83/295
The Input Coverage Is: 174/766
2024-06-12 17:07:07,614 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:07:11,691 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:07:15,673 logger.py[line:35] INFO 2.9.0
2024-06-12 17:07:17,249 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:07:20,013 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MDtype113-Edge15 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:07:21,186 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:07:21,186 logger.py[line:35] INFO loading the redis
2024-06-12 17:07:21,189 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:07:21,210 logger.py[line:35] INFO coverage_c=36067
time=13.430607795715332, cov_py=0, cov_c=36067
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MDtype113-Edge15
2024-06-12 17:07:25,327 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MDtype113-Edge15
2024-06-12 17:07:25,327 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:07:25,327 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:07:25,327 logger.py[line:35] INFO after_prediction
2024-06-12 17:07:25,327 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MDtype113-Edge15
2024-06-12 17:07:25,629 logger.py[line:35] INFO INFO: Mutation progress 17/100
2024-06-12 17:07:25,629 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:07:25,629 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:07:25,629 logger.py[line:35] INFO Score for NLAll is: 0.8823529411764706
2024-06-12 17:07:25,629 logger.py[line:35] INFO Score for MDims is: 0.88
2024-06-12 17:07:25,629 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:07:25,629 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:07:25,629 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:07:25,630 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:07:25,630 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:07:25,630 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:07:25,630 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:07:25,630 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118
2024-06-12 17:07:25,630 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:07:28,469 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:07:29,174 logger.py[line:35] INFO Generating model using MDims
2024-06-12 17:07:29,177 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_MDims')>}
2024-06-12 17:07:29,342 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 2 Layer classes
2024-06-12 17:07:29,342 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 1; Total Layer Class: 2
2024-06-12 17:07:29,342 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:07:29,342 logger.py[line:35] INFO Selecting a Global NDims 6 For Layer gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_MDims
2024-06-12 17:07:29,345 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_MDims')>}
2024-06-12 17:07:29,532 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:07:30,141 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 84/2170
The Configuration Coverage is: 224/2049
The NDims Coverage Is: 46/117
The DType Coverage Is: 46/354
The Shape Coverage Is: 84/295
The Input Coverage Is: 176/766
2024-06-12 17:07:30,331 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:07:34,277 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:07:38,271 logger.py[line:35] INFO 2.9.0
2024-06-12 17:07:39,875 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:07:42,663 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-MDims16 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:07:43,828 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:07:43,828 logger.py[line:35] INFO loading the redis
2024-06-12 17:07:43,830 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:07:43,852 logger.py[line:35] INFO coverage_c=36131
time=13.356307029724121, cov_py=0, cov_c=36131
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-MDims16
2024-06-12 17:07:48,135 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-MDims16
2024-06-12 17:07:48,135 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:07:48,135 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:07:48,135 logger.py[line:35] INFO after_prediction
2024-06-12 17:07:48,135 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-MDims16
2024-06-12 17:07:48,429 logger.py[line:35] INFO INFO: Mutation progress 18/100
2024-06-12 17:07:48,430 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:07:48,430 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:07:48,430 logger.py[line:35] INFO Score for MDims is: 0.8846153846153846
2024-06-12 17:07:48,430 logger.py[line:35] INFO Score for NLAll is: 0.8823529411764706
2024-06-12 17:07:48,430 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:07:48,430 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:07:48,430 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:07:48,430 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:07:48,430 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:07:48,430 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:07:48,430 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:07:48,430 logger.py[line:35] INFO Choose seed: resnet50-Edge65-MDtype132-SpecialI1
2024-06-12 17:07:48,430 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:07:52,533 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MDims')>, 'custom_cast_layer_5_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI_copy_MDims')>, 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI_copy_MDims')>}
2024-06-12 17:07:53,518 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:07:53,518 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:07:53,518 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:07:53,519 logger.py[line:35] INFO Selecting a Global NDims 3 For Layer conv5_block1_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MDims
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 88, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dims(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 377, in mutate_dims
    new_model = InputMutationUtils.mdims(MDims_model, selected_layer_ndims_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 349, in mdims
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 340, in mdims_layer_addition
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 313, in build
    f'Invalid axis. Expected 0 <= axis < inputs.rank (with '
ValueError: Invalid axis. Expected 0 <= axis < inputs.rank (with inputs.rank=3). Received: layer.axis=ListWrapper([3])
2024-06-12 17:07:54,968 logger.py[line:35] INFO INFO: Mutation progress 18/100
2024-06-12 17:07:54,969 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:07:54,969 logger.py[line:35] INFO Score for MDims is: 0.8846153846153846
2024-06-12 17:07:54,969 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:07:54,969 logger.py[line:35] INFO Score for NLAll is: 0.8823529411764706
2024-06-12 17:07:54,969 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:07:54,969 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:07:54,969 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:07:54,969 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:07:54,969 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:07:54,969 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:07:54,969 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:07:54,969 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-NLAll99
2024-06-12 17:07:54,969 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:07:59,257 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDims')>}
2024-06-12 17:08:00,301 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:08:00,301 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:08:00,301 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:08:00,302 logger.py[line:35] INFO Selecting a Global NDims 3 For Layer conv5_block3_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDims
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 88, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dims(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 377, in mutate_dims
    new_model = InputMutationUtils.mdims(MDims_model, selected_layer_ndims_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 349, in mdims
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 340, in mdims_layer_addition
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 313, in build
    f'Invalid axis. Expected 0 <= axis < inputs.rank (with '
ValueError: Invalid axis. Expected 0 <= axis < inputs.rank (with inputs.rank=3). Received: layer.axis=ListWrapper([3])
2024-06-12 17:08:01,863 logger.py[line:35] INFO INFO: Mutation progress 18/100
2024-06-12 17:08:01,863 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:08:01,863 logger.py[line:35] INFO Score for MDims is: 0.8846153846153846
2024-06-12 17:08:01,863 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:08:01,863 logger.py[line:35] INFO Score for NLAll is: 0.8823529411764706
2024-06-12 17:08:01,863 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:08:01,863 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:08:01,863 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:08:01,863 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:08:01,863 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:08:01,864 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:08:01,864 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:08:01,864 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-MDtype45
2024-06-12 17:08:01,864 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:08:04,703 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:08:05,380 logger.py[line:35] INFO Generating model using MDims
2024-06-12 17:08:05,383 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims')>}
2024-06-12 17:08:05,529 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:08:05,529 logger.py[line:35] INFO Global Layer Class: 0; Local Layer Class: 1; Total Layer Class: 1
2024-06-12 17:08:05,529 logger.py[line:35] INFO Changing 0 Layer's NDims.
2024-06-12 17:08:05,529 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:08:05,529 logger.py[line:35] INFO No Global NDims Can Be Found, Randomly Select NDims: 4 For Layer: dropout_1_copy_NLAll_copy_MDtype_copy_MDims
2024-06-12 17:08:05,532 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims')>}
2024-06-12 17:08:05,703 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:08:06,281 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 84/2170
The Configuration Coverage is: 224/2049
The NDims Coverage Is: 46/117
The DType Coverage Is: 46/354
The Shape Coverage Is: 84/295
The Input Coverage Is: 176/766
2024-06-12 17:08:06,458 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:08:10,415 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:08:14,406 logger.py[line:35] INFO 2.9.0
2024-06-12 17:08:15,977 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:08:18,649 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-MDtype45-MDims17 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:08:19,819 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:08:19,819 logger.py[line:35] INFO loading the redis
2024-06-12 17:08:19,822 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:08:19,843 logger.py[line:35] INFO coverage_c=36133
time=13.21979284286499, cov_py=0, cov_c=36133
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-MDtype45-MDims17
2024-06-12 17:08:24,152 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-MDtype45-MDims17
2024-06-12 17:08:24,152 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:08:24,152 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:08:24,152 logger.py[line:35] INFO after_prediction
2024-06-12 17:08:24,152 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-MDtype45-MDims17
2024-06-12 17:08:24,450 logger.py[line:35] INFO INFO: Mutation progress 19/100
2024-06-12 17:08:24,450 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:08:24,450 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:08:24,450 logger.py[line:35] INFO Score for NLAll is: 0.8823529411764706
2024-06-12 17:08:24,450 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:08:24,450 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:08:24,450 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:08:24,450 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:08:24,450 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:08:24,450 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:08:24,451 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:08:24,451 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:08:24,451 logger.py[line:35] INFO Choose seed: resnet50-Edge65-MDtype132-SpecialI1
2024-06-12 17:08:24,451 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:08:28,595 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_NLAll')>, 'custom_cast_layer_5_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI_copy_NLAll')>, 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI_copy_NLAll')>}
2024-06-12 17:08:29,929 logger.py[line:35] INFO Insert 5 out of 6 Global New Layers
2024-06-12 17:08:29,930 logger.py[line:35] INFO insert LocallyConnected2D after conv4_block1_3_conv_copy_Edge_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:08:29,930 logger.py[line:35] INFO insert LayerNormalization after conv3_block1_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:08:29,930 logger.py[line:35] INFO insert SeparableConv2D after conv4_block3_3_conv_copy_Edge_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:08:29,931 logger.py[line:35] INFO insert ReLU after conv4_block4_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:08:29,931 logger.py[line:35] INFO insert GaussianNoise after conv5_block2_3_conv_copy_Edge_copy_MDtype_copy_SpecialI_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.normalization.layer_normalization.LayerNormalization object at 0x7f42dc715ed0>
2024-06-12 17:08:30,188 logger.py[line:35] INFO Converting output shape (None, 28, 28, 512) to actual shape [None, 28, 28, 512]
[DEBUG] Inserting layer: <keras.layers.local.LocallyConnected2D object at 0x7f42dc6b6d10>
2024-06-12 17:08:30,411 deprecation.py[line:347] WARNING From /opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3686: sparse_mat_mul (from tensorflow.python.ops.gen_math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.linalg.matmul` instead
2024-06-12 17:08:30,422 logger.py[line:35] INFO Converting output shape (None, 14, 14, 10) to actual shape [None, 14, 14, 1024]
[DEBUG] Inserting layer: <keras.layers.convolutional.SeparableConv2D object at 0x7f42dc62c6d0>
2024-06-12 17:08:30,582 logger.py[line:35] INFO Converting output shape (None, 14, 14, 1024) to actual shape [None, 14, 14, 1024]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ReLU object at 0x7f42dc59c890>
2024-06-12 17:08:30,642 logger.py[line:35] INFO Converting output shape (None, 14, 14, 1024) to actual shape [None, 14, 14, 1024]
[DEBUG] Inserting layer: <keras.layers.noise.GaussianNoise object at 0x7f42dc528f50>
2024-06-12 17:08:30,846 logger.py[line:35] INFO Converting output shape (None, 7, 7, 2048) to actual shape [None, 7, 7, 2048]
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_NLAll')>, 'custom_cast_layer_5_copy_SpecialI_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI_copy_NLAll')>, 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI_copy_NLAll': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI_copy_NLAll')>}
2024-06-12 17:08:31,034 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:08:35,523 deprecation.py[line:347] WARNING From /opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3686: sparse_mat_mul (from tensorflow.python.ops.gen_math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.linalg.matmul` instead
The API Pair Coverage Is: 92/2170
The Configuration Coverage is: 269/2049
The NDims Coverage Is: 51/117
The DType Coverage Is: 51/354
The Shape Coverage Is: 89/295
The Input Coverage Is: 191/766
2024-06-12 17:08:36,016 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:08:39,934 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:08:44,148 logger.py[line:35] INFO 2.9.0
2024-06-12 17:08:45,710 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 229, in <module>
    predictor.before_predict()
  File "/root/implementations/scripts/prediction/predict_model.py", line 116, in before_predict
    self.model = keras.models.load_model(self.model_path, custom_objects=custom_objects())
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/backend.py", line 1922, in random_uniform
    seed=self.make_legacy_seed())
tensorflow.python.framework.errors_impl.ResourceExhaustedError: {{function_node __wrapped__AddV2_device_/job:localhost/replica:0/task:0/device:GPU:0}} failed to allocate memory [Op:AddV2]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 235, in <module>
    raise ValueError(f"CRASH ON BACKEND {flags.backend}!!!")
ValueError: CRASH ON BACKEND tensorflow!!!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:08:58,042 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 18s
2024-06-12 17:08:58,042 logger.py[line:35] INFO resnet50-Edge65-MDtype132-SpecialI1-NLAll18 crash on backend tensorflow when predicting
2024-06-12 17:08:58,064 logger.py[line:35] INFO coverage_c=36186
time=21.882883548736572, cov_py=0, cov_c=36186
New test requirements invoked on framework tensorflow when updating resnet50-Edge65-MDtype132-SpecialI1-NLAll18
2024-06-12 17:09:02,227 logger.py[line:35] INFO Fail on backend: tensorflow of model resnet50-Edge65-MDtype132-SpecialI1-NLAll18
2024-06-12 17:09:02,227 logger.py[line:35] INFO Error: Move Crash model
2024-06-12 17:09:02,227 logger.py[line:35] INFO after_prediction
2024-06-12 17:09:02,559 logger.py[line:35] INFO INFO: Mutation progress 20/100
2024-06-12 17:09:02,559 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:09:02,559 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:09:02,559 logger.py[line:35] INFO Score for NLAll is: 0.8846153846153846
2024-06-12 17:09:02,559 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:09:02,559 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:09:02,559 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:09:02,559 logger.py[line:35] INFO Score for LMerg is: 0.8333333333333334
2024-06-12 17:09:02,559 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:09:02,559 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:09:02,559 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:09:02,560 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:09:02,560 logger.py[line:35] INFO Choose seed: densenet121
2024-06-12 17:09:02,560 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:09:07,888 logger.py[line:35] INFO Generating model using LMerg
model outputs {'predictions': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:09:09,744 logger.py[line:35] INFO Insert 1 out of 4 Global New Layers
2024-06-12 17:09:09,748 logger.py[line:35] INFO Trying Merge Layers: conv4_block10_0_bn_copy_LMerg and conv4_block9_concat_copy_LMerg by Subtract
2024-06-12 17:09:11,708 logger.py[line:35] INFO Success on Merge Layers: conv4_block10_0_bn_copy_LMerg and conv4_block9_concat_copy_LMerg by Subtract
2024-06-12 17:09:11,872 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 93/2170
The Configuration Coverage is: 269/2049
The NDims Coverage Is: 51/117
The DType Coverage Is: 51/354
The Shape Coverage Is: 91/295
The Input Coverage Is: 193/766
2024-06-12 17:09:15,234 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:09:19,270 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:09:23,385 logger.py[line:35] INFO 2.9.0
2024-06-12 17:09:24,968 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:09:38,431 logger.py[line:35] INFO SUCCESS:Get prediction for densenet121-LMerg19 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:09:40,232 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 20s
2024-06-12 17:09:40,232 logger.py[line:35] INFO loading the redis
2024-06-12 17:09:40,235 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:09:40,257 logger.py[line:35] INFO coverage_c=36186
time=24.85654044151306, cov_py=0, cov_c=36186
New test requirements invoked on framework tensorflow when updating densenet121-LMerg19
2024-06-12 17:09:44,464 logger.py[line:35] INFO Success on backend: tensorflow of model densenet121-LMerg19
2024-06-12 17:09:44,464 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:09:44,464 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:09:44,464 logger.py[line:35] INFO after_prediction
2024-06-12 17:09:44,464 logger.py[line:35] INFO New representative seed found: densenet121-LMerg19
2024-06-12 17:09:44,933 logger.py[line:35] INFO INFO: Mutation progress 21/100
2024-06-12 17:09:44,933 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:09:44,933 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:09:44,933 logger.py[line:35] INFO Score for NLAll is: 0.8846153846153846
2024-06-12 17:09:44,933 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:09:44,933 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:09:44,933 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:09:44,933 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:09:44,933 logger.py[line:35] INFO Score for MShape is: 0.7142857142857143
2024-06-12 17:09:44,933 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:09:44,933 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:09:44,933 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:09:44,933 logger.py[line:35] INFO Choose seed: resnet50-Edge65-MDtype132-SpecialI1
2024-06-12 17:09:44,933 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:09:49,056 logger.py[line:35] INFO Generating model using MShape
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape')>, 'custom_cast_layer_5_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI_copy_MShape')>, 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI_copy_MShape')>}
2024-06-12 17:09:50,034 logger.py[line:35] INFO Change 2 Layer's Shape Out Of 6 Layer classes
2024-06-12 17:09:50,034 logger.py[line:35] INFO Changing 2 out of 6 Layer's Shape.
2024-06-12 17:09:50,035 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: conv1_pad_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape From [None, 224, 224, 3] To [None, 5, 1, 3]
2024-06-12 17:09:50,036 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI_copy_MShape From [None, 14, 14, 1024] To [None, 8, 8, 6]
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape')>, 'custom_cast_layer_5_copy_SpecialI_copy_MShape': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI_copy_MShape')>, 'avg_pool_copy_Edge_2_copy_MDtype_copy_SpecialI_copy_MShape': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'custom_pad_layer_1')>}
2024-06-12 17:09:51,131 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 93/2170
The Configuration Coverage is: 269/2049
The NDims Coverage Is: 51/117
The DType Coverage Is: 51/354
The Shape Coverage Is: 91/295
The Input Coverage Is: 193/766
2024-06-12 17:09:53,195 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:09:57,112 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:10:01,220 logger.py[line:35] INFO 2.9.0
2024-06-12 17:10:02,801 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:10:11,670 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-Edge65-MDtype132-SpecialI1-MShape20 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:10:13,368 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:10:13,369 logger.py[line:35] INFO loading the redis
2024-06-12 17:10:13,372 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:10:13,393 logger.py[line:35] INFO coverage_c=36187
time=20.030725240707397, cov_py=0, cov_c=36187
New test requirements invoked on framework tensorflow when updating resnet50-Edge65-MDtype132-SpecialI1-MShape20
2024-06-12 17:10:18,002 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-Edge65-MDtype132-SpecialI1-MShape20
2024-06-12 17:10:18,003 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:10:18,003 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:10:18,003 logger.py[line:35] INFO after_prediction
2024-06-12 17:10:18,003 logger.py[line:35] INFO New representative seed found: resnet50-Edge65-MDtype132-SpecialI1-MShape20
2024-06-12 17:10:18,404 logger.py[line:35] INFO INFO: Mutation progress 22/100
2024-06-12 17:10:18,405 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:10:18,405 logger.py[line:35] INFO Score for MDtype is: 0.8846153846153846
2024-06-12 17:10:18,405 logger.py[line:35] INFO Score for NLAll is: 0.8846153846153846
2024-06-12 17:10:18,405 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:10:18,405 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:10:18,405 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:10:18,405 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:10:18,405 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:10:18,405 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:10:18,405 logger.py[line:35] INFO The last used seed is: MShape
2024-06-12 17:10:18,405 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:10:18,405 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-NLAll124-MDtype128
2024-06-12 17:10:18,405 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:10:21,265 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:10:22,049 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:10:22,052 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype')>}
2024-06-12 17:10:22,268 logger.py[line:35] INFO Change 1 Layer's DType Out Of 10 Layer classes
2024-06-12 17:10:22,268 logger.py[line:35] INFO Changing 1 out of 10 Layer's DType.
2024-06-12 17:10:22,269 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer conv3d_transpose_insert_copy_MDtype_copy_MDtype
2024-06-12 17:10:22,271 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype')>}
2024-06-12 17:10:22,682 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:10:23,272 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 93/2170
The Configuration Coverage is: 269/2049
The NDims Coverage Is: 51/117
The DType Coverage Is: 53/354
The Shape Coverage Is: 91/295
The Input Coverage Is: 195/766
2024-06-12 17:10:23,528 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:10:27,350 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:10:31,405 logger.py[line:35] INFO 2.9.0
2024-06-12 17:10:32,997 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 229, in <module>
    predictor.before_predict()
  File "/root/implementations/scripts/prediction/predict_model.py", line 116, in before_predict
    self.model = keras.models.load_model(self.model_path, custom_objects=custom_objects())
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/backend.py", line 4019, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype_numpy(x)))
ValueError: No cast function available.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 235, in <module>
    raise ValueError(f"CRASH ON BACKEND {flags.backend}!!!")
ValueError: CRASH ON BACKEND tensorflow!!!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:10:35,295 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 7s
2024-06-12 17:10:35,296 logger.py[line:35] INFO lstm2-NLAll38-NLAll54-NLAll124-MDtype128-MDtype21 crash on backend tensorflow when predicting
2024-06-12 17:10:35,317 logger.py[line:35] INFO coverage_c=36256
time=11.624135732650757, cov_py=0, cov_c=36256
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-NLAll124-MDtype128-MDtype21
2024-06-12 17:10:39,447 logger.py[line:35] INFO Fail on backend: tensorflow of model lstm2-NLAll38-NLAll54-NLAll124-MDtype128-MDtype21
2024-06-12 17:10:39,448 logger.py[line:35] INFO Error: Move Crash model
2024-06-12 17:10:39,448 logger.py[line:35] INFO after_prediction
2024-06-12 17:10:39,742 logger.py[line:35] INFO INFO: Mutation progress 23/100
2024-06-12 17:10:39,743 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:10:39,743 logger.py[line:35] INFO Score for MDtype is: 0.8875
2024-06-12 17:10:39,743 logger.py[line:35] INFO Score for NLAll is: 0.8846153846153846
2024-06-12 17:10:39,743 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:10:39,743 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:10:39,743 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:10:39,743 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:10:39,743 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:10:39,743 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:10:39,743 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:10:39,743 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:10:39,743 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120
2024-06-12 17:10:39,743 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:10:43,026 logger.py[line:35] INFO Generating model using MParam
model outputs {'dense_3_copy_SpecialI': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MParam')>}
2024-06-12 17:10:43,115 logger.py[line:35] INFO Changing 3/5 of layer batch_normalization_3_copy_SpecialI_copy_MParam's configuration
2024-06-12 17:10:43,116 logger.py[line:35] INFO changing config momentum in layer batch_normalization_3_copy_SpecialI_copy_MParam: from 0.99 to 0.23274974095850942
2024-06-12 17:10:43,116 logger.py[line:35] INFO changing config center in layer batch_normalization_3_copy_SpecialI_copy_MParam: from True to True
2024-06-12 17:10:43,116 logger.py[line:35] INFO changing config epsilon in layer batch_normalization_3_copy_SpecialI_copy_MParam: from 0.001 to 0.2743833211668568
2024-06-12 17:10:43,116 logger.py[line:35] INFO changing config scale in layer batch_normalization_3_copy_SpecialI_copy_MParam: from True to True
2024-06-12 17:10:43,116 logger.py[line:35] INFO Changing 1/15 of layer conv2d_4_copy_SpecialI_copy_MParam's configuration
2024-06-12 17:10:43,116 logger.py[line:35] INFO changing config use_bias in layer conv2d_4_copy_SpecialI_copy_MParam: from True to True
2024-06-12 17:10:43,116 logger.py[line:35] INFO changing config bias_initializer in layer conv2d_4_copy_SpecialI_copy_MParam: from {'class_name': 'Zeros', 'config': {}} to Orthogonal
2024-06-12 17:10:43,117 logger.py[line:35] INFO Changing 2/15 of layer conv2d_1_copy_SpecialI_copy_MParam's configuration
2024-06-12 17:10:43,117 logger.py[line:35] INFO changing config bias_initializer in layer conv2d_1_copy_SpecialI_copy_MParam: from {'class_name': 'Zeros', 'config': {}} to TruncatedNormal
2024-06-12 17:10:43,117 logger.py[line:35] INFO changing config bias_constraint in layer conv2d_1_copy_SpecialI_copy_MParam: from None to Constraint
2024-06-12 17:10:43,117 logger.py[line:35] INFO changing config data_format in layer conv2d_1_copy_SpecialI_copy_MParam: from channels_last to channels_first
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 82, in generate_model_by_model_mutation
    architecture_measure=architecture_measure, max_layer_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 283, in mutate_param
    new_model = utils.ModelUtils.functional_model_operation(MParam_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 276, in change_layer_config
    x = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/initializers/initializers_v2.py", line 606, in __call__
    raise ValueError('The tensor to initialize must be '
ValueError: The tensor to initialize must be at least two-dimensional. Received: shape=(384,) of rank 1.
2024-06-12 17:10:43,566 logger.py[line:35] INFO INFO: Mutation progress 23/100
2024-06-12 17:10:43,566 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:10:43,566 logger.py[line:35] INFO Score for MDtype is: 0.8875
2024-06-12 17:10:43,566 logger.py[line:35] INFO Score for NLAll is: 0.8846153846153846
2024-06-12 17:10:43,566 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:10:43,566 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:10:43,566 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:10:43,566 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:10:43,566 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:10:43,566 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:10:43,566 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 17:10:43,567 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:10:43,567 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MDtype4-NLAll12-LMerg30
2024-06-12 17:10:43,567 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:10:47,902 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg_copy_NLAll')>}
2024-06-12 17:10:49,207 logger.py[line:35] INFO Insert 7 out of 13 Global New Layers
2024-06-12 17:10:49,208 logger.py[line:35] INFO insert DepthwiseConv1D after repeat_vector_insert_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,208 logger.py[line:35] INFO insert Bidirectional after repeat_vector_insert_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,208 logger.py[line:35] INFO insert LocallyConnected1D after repeat_vector_insert_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,208 logger.py[line:35] INFO insert AveragePooling1D after repeat_vector_insert_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,208 logger.py[line:35] INFO insert GlobalAveragePooling1D after repeat_vector_insert_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,208 logger.py[line:35] INFO insert UpSampling1D after repeat_vector_insert_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,208 logger.py[line:35] INFO insert Cropping1D after repeat_vector_insert_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,208 logger.py[line:35] INFO Insert 6 out of 31 Local New Layers
2024-06-12 17:10:49,208 logger.py[line:35] INFO insert LocallyConnected2D after conv4_block5_1_bn_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,209 logger.py[line:35] INFO insert LeakyReLU after conv2_block3_2_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,209 logger.py[line:35] INFO insert ThresholdedReLU after repeat_vector_insert_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,209 logger.py[line:35] INFO insert AlphaDropout after conv3_block4_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,209 logger.py[line:35] INFO insert ELU after conv3_block4_1_bn_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,209 logger.py[line:35] INFO insert TimeDistributed after conv3_block4_3_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg_copy_NLAll
2024-06-12 17:10:49,209 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 1
2024-06-12 17:10:49,219 logger.py[line:35] INFO insert Softmax after conv2_block3_1_bn_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.advanced_activations.Softmax object at 0x7f20784cd410>
2024-06-12 17:10:49,397 logger.py[line:35] INFO Converting output shape (None, 56, 56, 64) to actual shape [None, 56, 56, 64]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.LeakyReLU object at 0x7f20784a3a90>
2024-06-12 17:10:49,407 logger.py[line:35] INFO Converting output shape (None, 56, 56, 64) to actual shape [None, 56, 56, 64]
[DEBUG] Inserting layer: <keras.layers.noise.AlphaDropout object at 0x7f20784a8850>
2024-06-12 17:10:49,618 logger.py[line:35] INFO Converting output shape (None, 28, 28, 128) to actual shape [None, 28, 28, 128]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ELU object at 0x7f2078490a90>
2024-06-12 17:10:49,628 logger.py[line:35] INFO Converting output shape (None, 28, 28, 128) to actual shape [None, 28, 28, 128]
[DEBUG] Inserting layer: <keras.layers.wrappers.TimeDistributed object at 0x7f20783fe090>
2024-06-12 17:10:49,658 logger.py[line:35] INFO Converting output shape (None, 28, 28, 512) to actual shape [None, 28, 28, 512]
[DEBUG] Inserting layer: <keras.layers.local.LocallyConnected2D object at 0x7f20782eda90>
2024-06-12 17:10:58,649 logger.py[line:35] INFO Converting output shape (None, 10, 14, 256) to actual shape [None, 14, 14, 256]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ThresholdedReLU object at 0x7f1fa44c0dd0>
2024-06-12 17:10:58,969 logger.py[line:35] INFO Converting output shape (None, 2, 2048) to actual shape [None, 2, 2048]
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_LMerg_copy_NLAll')>}
2024-06-12 17:10:59,087 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 103/2170
The Configuration Coverage is: 280/2049
The NDims Coverage Is: 53/117
The DType Coverage Is: 53/354
The Shape Coverage Is: 97/295
The Input Coverage Is: 203/766
2024-06-12 17:11:09,801 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:11:13,783 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:11:17,894 logger.py[line:35] INFO 2.9.0
2024-06-12 17:11:19,466 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:13:37,849 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MDtype4-NLAll12-LMerg30-NLAll22 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:13:40,494 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 2m, 26s
2024-06-12 17:13:40,494 logger.py[line:35] INFO loading the redis
2024-06-12 17:13:40,497 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:13:40,520 logger.py[line:35] INFO coverage_c=36377
time=150.5498809814453, cov_py=0, cov_c=36377
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MDtype4-NLAll12-LMerg30-NLAll22
2024-06-12 17:13:45,857 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MDtype4-NLAll12-LMerg30-NLAll22
2024-06-12 17:13:45,857 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:13:45,857 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:13:45,857 logger.py[line:35] INFO after_prediction
2024-06-12 17:13:45,857 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MDtype4-NLAll12-LMerg30-NLAll22
2024-06-12 17:13:46,562 logger.py[line:35] INFO INFO: Mutation progress 24/100
2024-06-12 17:13:46,562 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:13:46,562 logger.py[line:35] INFO Score for MDtype is: 0.8875
2024-06-12 17:13:46,563 logger.py[line:35] INFO Score for NLAll is: 0.8867924528301887
2024-06-12 17:13:46,563 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:13:46,563 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:13:46,563 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:13:46,563 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:13:46,563 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:13:46,563 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:13:46,563 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:13:46,563 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:13:46,563 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131
2024-06-12 17:13:46,563 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:13:50,847 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MDtype')>}
2024-06-12 17:13:51,835 logger.py[line:35] INFO Change 3 Layer's DType Out Of 5 Layer classes
2024-06-12 17:13:51,835 logger.py[line:35] INFO Changing 3 out of 5 Layer's DType.
2024-06-12 17:13:51,836 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MDtype
2024-06-12 17:13:51,837 logger.py[line:35] INFO Selecting a Global DType double For Layer avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MDtype
2024-06-12 17:13:51,837 logger.py[line:35] INFO Selecting a Global DType float64 For Layer conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MDtype')>}
2024-06-12 17:13:52,840 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 103/2170
The Configuration Coverage is: 280/2049
The NDims Coverage Is: 53/117
The DType Coverage Is: 54/354
The Shape Coverage Is: 97/295
The Input Coverage Is: 204/766
2024-06-12 17:13:54,842 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:13:58,745 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:14:02,869 logger.py[line:35] INFO 2.9.0
2024-06-12 17:14:04,403 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:14:13,280 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-MDtype23 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:14:15,011 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:14:15,011 logger.py[line:35] INFO loading the redis
2024-06-12 17:14:15,014 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:14:15,035 logger.py[line:35] INFO coverage_c=36381
time=20.022006034851074, cov_py=0, cov_c=36381
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-MDtype23
2024-06-12 17:14:19,304 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-MDtype23
2024-06-12 17:14:19,304 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:14:19,304 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:14:19,305 logger.py[line:35] INFO after_prediction
2024-06-12 17:14:19,305 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-MDtype23
2024-06-12 17:14:19,674 logger.py[line:35] INFO INFO: Mutation progress 25/100
2024-06-12 17:14:19,674 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:14:19,674 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:14:19,674 logger.py[line:35] INFO Score for NLAll is: 0.8867924528301887
2024-06-12 17:14:19,674 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:14:19,674 logger.py[line:35] INFO Score for Edge is: 0.8676470588235294
2024-06-12 17:14:19,674 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:14:19,674 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:14:19,674 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:14:19,674 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:14:19,674 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:14:19,674 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:14:19,674 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6
2024-06-12 17:14:19,674 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:14:23,945 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge')>}
Choosing 9 To Insert
2024-06-12 17:14:24,926 logger.py[line:35] INFO Insert 9 Local New Edges
2024-06-12 17:14:24,927 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'GlobalAveragePooling2D')
2024-06-12 17:14:25,906 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'GlobalAveragePooling2D'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:26,808 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'GlobalAveragePooling2D'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:26,808 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'Conv2D')
2024-06-12 17:14:27,967 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'Conv2D'] by Connecting conv3_block3_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:28,892 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'Conv2D'] by Connecting conv3_block3_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:28,893 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'BatchNormalization')
2024-06-12 17:14:29,890 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'BatchNormalization'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and conv4_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:30,803 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'BatchNormalization'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and conv4_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:30,804 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'BatchNormalization')
2024-06-12 17:14:32,013 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'BatchNormalization'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and conv3_block1_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:32,943 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'BatchNormalization'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and conv3_block1_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:32,943 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'ZeroPadding2D')
2024-06-12 17:14:33,954 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'ZeroPadding2D'] by Connecting conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:35,041 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'ZeroPadding2D'] by Connecting conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:35,041 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'ZeroPadding2D')
2024-06-12 17:14:36,060 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'ZeroPadding2D'] by Connecting conv3_block4_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2
2024-06-12 17:14:36,992 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'ZeroPadding2D'] by Connecting conv3_block4_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2
2024-06-12 17:14:36,993 logger.py[line:35] INFO Candidate Edge: ('BatchNormalization', 'BatchNormalization')
2024-06-12 17:14:38,021 logger.py[line:35] INFO Trying Adding Edge: ['BatchNormalization', 'BatchNormalization'] by Connecting conv2_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and conv5_block1_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:39,140 logger.py[line:35] INFO Successfully Add Edge: ['BatchNormalization', 'BatchNormalization'] by Connecting conv2_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and conv5_block1_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:39,140 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'ZeroPadding2D')
2024-06-12 17:14:40,176 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'ZeroPadding2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_2
2024-06-12 17:14:41,123 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'ZeroPadding2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge and pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_2
2024-06-12 17:14:41,123 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'Conv2D')
2024-06-12 17:14:42,350 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'Conv2D'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_2_1 and conv4_block6_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:43,303 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'Conv2D'] by Connecting pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_2_1 and conv4_block6_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge
2024-06-12 17:14:43,461 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 103/2170
The Configuration Coverage is: 280/2049
The NDims Coverage Is: 53/117
The DType Coverage Is: 54/354
The Shape Coverage Is: 97/295
The Input Coverage Is: 204/766
2024-06-12 17:14:45,536 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:14:49,540 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:14:53,677 logger.py[line:35] INFO 2.9.0
2024-06-12 17:14:55,258 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:15:04,913 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-Edge24 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:15:06,609 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 17s
2024-06-12 17:15:06,610 logger.py[line:35] INFO loading the redis
2024-06-12 17:15:06,613 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:15:06,634 logger.py[line:35] INFO coverage_c=36381
time=20.92660903930664, cov_py=0, cov_c=36381
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-Edge24
2024-06-12 17:15:10,938 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-Edge24
2024-06-12 17:15:10,938 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:15:10,938 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:15:10,938 logger.py[line:35] INFO after_prediction
2024-06-12 17:15:10,939 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-Edge24
2024-06-12 17:15:11,310 logger.py[line:35] INFO INFO: Mutation progress 26/100
2024-06-12 17:15:11,310 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:15:11,310 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:15:11,311 logger.py[line:35] INFO Score for NLAll is: 0.8867924528301887
2024-06-12 17:15:11,311 logger.py[line:35] INFO Score for Edge is: 0.8714285714285714
2024-06-12 17:15:11,311 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:15:11,311 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:15:11,311 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:15:11,311 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:15:11,311 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:15:11,311 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:15:11,311 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:15:11,311 logger.py[line:35] INFO Choose seed: resnet50-Edge65-MDtype132-SpecialI1-MShape20
2024-06-12 17:15:11,311 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:15:15,601 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDims')>, 'custom_cast_layer_5_copy_SpecialI_copy_MShape': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI_copy_MShape_copy_MDims')>, 'custom_pad_layer_1': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'custom_pad_layer_1_copy_MDims')>}
2024-06-12 17:15:16,596 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:15:16,596 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:15:16,596 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:15:16,597 logger.py[line:35] INFO Selecting a Global NDims 3 For Layer conv5_block1_2_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDims
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 88, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dims(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 377, in mutate_dims
    new_model = InputMutationUtils.mdims(MDims_model, selected_layer_ndims_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 349, in mdims
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 340, in mdims_layer_addition
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 313, in build
    f'Invalid axis. Expected 0 <= axis < inputs.rank (with '
ValueError: Invalid axis. Expected 0 <= axis < inputs.rank (with inputs.rank=3). Received: layer.axis=ListWrapper([3])
2024-06-12 17:15:17,907 logger.py[line:35] INFO INFO: Mutation progress 26/100
2024-06-12 17:15:17,907 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:15:17,907 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:15:17,907 logger.py[line:35] INFO Score for NLAll is: 0.8867924528301887
2024-06-12 17:15:17,907 logger.py[line:35] INFO Score for Edge is: 0.8714285714285714
2024-06-12 17:15:17,907 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:15:17,907 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:15:17,907 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:15:17,907 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:15:17,907 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:15:17,907 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:15:17,907 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:15:17,907 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1
2024-06-12 17:15:17,908 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:15:22,583 logger.py[line:35] INFO Generating model using LMerg
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:15:23,671 logger.py[line:35] INFO Insert 2 out of 2 Global New Layers
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 72, in generate_model_by_model_mutation
    return InteractionMutationUtils.merge_layers(model=model, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 165, in merge_layers
    assert len(selected_layer_name_list) == 1
AssertionError
2024-06-12 17:15:24,172 logger.py[line:35] INFO INFO: Mutation progress 26/100
2024-06-12 17:15:24,173 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:15:24,173 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:15:24,173 logger.py[line:35] INFO Score for NLAll is: 0.8867924528301887
2024-06-12 17:15:24,173 logger.py[line:35] INFO Score for Edge is: 0.8714285714285714
2024-06-12 17:15:24,173 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:15:24,173 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:15:24,173 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:15:24,173 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:15:24,173 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:15:24,173 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:15:24,173 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:15:24,173 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MParam115-MDims8
2024-06-12 17:15:24,173 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:15:27,051 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:15:27,722 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 17:15:27,725 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll')>}
2024-06-12 17:15:27,912 logger.py[line:35] INFO Insert 4 out of 20 Global New Layers
2024-06-12 17:15:27,912 logger.py[line:35] INFO insert DepthwiseConv1D after repeat_vector_insert_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll
2024-06-12 17:15:27,912 logger.py[line:35] INFO insert Conv3D after up_sampling3d_insert_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll
2024-06-12 17:15:27,912 logger.py[line:35] INFO insert GlobalAveragePooling3D after up_sampling3d_insert_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll
2024-06-12 17:15:27,912 logger.py[line:35] INFO insert Bidirectional after repeat_vector_insert_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll
2024-06-12 17:15:27,912 logger.py[line:35] INFO Insert 2 out of 22 Local New Layers
2024-06-12 17:15:27,912 logger.py[line:35] INFO insert LayerNormalization after repeat_vector_insert_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll
2024-06-12 17:15:27,913 logger.py[line:35] INFO insert Conv3DTranspose after up_sampling3d_insert_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll
2024-06-12 17:15:27,913 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 2
2024-06-12 17:15:27,913 logger.py[line:35] INFO insert MaxPooling2D after custom_expand_layer_1_insert_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll
2024-06-12 17:15:27,914 logger.py[line:35] INFO insert GlobalAveragePooling3D after custom_expand_layer_2_insert_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll
2024-06-12 17:15:27,917 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.pooling.MaxPooling2D object at 0x7ff8ec4b7ed0>
2024-06-12 17:15:28,017 logger.py[line:35] INFO Converting output shape (None, 1, 1, 25) to actual shape [None, 1, 1, 25]
[DEBUG] Inserting layer: <keras.layers.pooling.GlobalAveragePooling3D object at 0x7ff8ec3cad90>
2024-06-12 17:15:28,022 logger.py[line:35] INFO Converting output shape (None, 25) to actual shape [None, 1, 1, 1, 25]
[DEBUG] Inserting layer: <keras.layers.convolutional.Conv3DTranspose object at 0x7ff8ec3f3150>
2024-06-12 17:15:28,061 logger.py[line:35] INFO Converting output shape (None, 25, 9, 9, 25) to actual shape [None, 9, 9, 9, 25]
[DEBUG] Inserting layer: <keras.layers.normalization.layer_normalization.LayerNormalization object at 0x7ff8ec4b1d50>
2024-06-12 17:15:28,119 logger.py[line:35] INFO Converting output shape (None, 2, 0) to actual shape [None, 2, 0]
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll')>}
2024-06-12 17:15:28,149 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:15:28,775 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 105/2170
The Configuration Coverage is: 292/2049
The NDims Coverage Is: 55/117
The DType Coverage Is: 55/354
The Shape Coverage Is: 100/295
The Input Coverage Is: 210/766
2024-06-12 17:15:29,006 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:15:32,842 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:15:36,869 logger.py[line:35] INFO 2.9.0
2024-06-12 17:15:38,435 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:15:43,298 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MParam115-MDims8-NLAll25 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:15:44,903 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:15:44,903 logger.py[line:35] INFO loading the redis
2024-06-12 17:15:44,906 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:15:44,927 logger.py[line:35] INFO coverage_c=36720
time=15.748769283294678, cov_py=0, cov_c=36720
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MParam115-MDims8-NLAll25
2024-06-12 17:15:49,125 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MParam115-MDims8-NLAll25
2024-06-12 17:15:49,125 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:15:49,126 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:15:49,126 logger.py[line:35] INFO after_prediction
2024-06-12 17:15:49,126 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MParam115-MDims8-NLAll25
2024-06-12 17:15:49,426 logger.py[line:35] INFO INFO: Mutation progress 27/100
2024-06-12 17:15:49,426 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:15:49,426 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:15:49,426 logger.py[line:35] INFO Score for NLAll is: 0.8888888888888888
2024-06-12 17:15:49,426 logger.py[line:35] INFO Score for Edge is: 0.8714285714285714
2024-06-12 17:15:49,426 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:15:49,427 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:15:49,427 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:15:49,427 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:15:49,427 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:15:49,427 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:15:49,427 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:15:49,427 logger.py[line:35] INFO Choose seed: inception.resnet.v2-NLAll108
2024-06-12 17:15:49,427 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:15:56,695 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_NLAll_copy_NLAll')>}
2024-06-12 17:16:01,220 logger.py[line:35] INFO Insert 1 out of 1 Global New Layers
2024-06-12 17:16:01,221 logger.py[line:35] INFO insert ConvLSTM1D after conv2d_44_copy_NLAll_copy_NLAll
2024-06-12 17:16:01,221 logger.py[line:35] INFO Insert 1 out of 27 Local New Layers
2024-06-12 17:16:01,221 logger.py[line:35] INFO insert Conv2DTranspose after max_pooling2d_3_copy_NLAll_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.convolutional_recurrent.ConvLSTM1D object at 0x7fa1087d6a90>
2024-06-12 17:16:02,027 logger.py[line:35] INFO Converting output shape (None, 32, 32) to actual shape [None, 35, 35, 32]
[DEBUG] Inserting layer: <keras.layers.convolutional.Conv2DTranspose object at 0x7fa1084f6150>
2024-06-12 17:16:02,609 logger.py[line:35] INFO Converting output shape (None, 320, 17, 320) to actual shape [None, 17, 17, 320]
model outputs {'predictions_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_NLAll_copy_NLAll')>}
2024-06-12 17:16:05,375 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 109/2170
The Configuration Coverage is: 329/2049
The NDims Coverage Is: 56/117
The DType Coverage Is: 56/354
The Shape Coverage Is: 103/295
The Input Coverage Is: 215/766
2024-06-12 17:16:11,648 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:16:15,587 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:16:19,825 logger.py[line:35] INFO 2.9.0
2024-06-12 17:16:21,383 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:16:45,104 logger.py[line:35] INFO SUCCESS:Get prediction for inception.resnet.v2-NLAll108-NLAll26 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:16:47,022 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 31s
2024-06-12 17:16:47,022 logger.py[line:35] INFO loading the redis
2024-06-12 17:16:47,025 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:16:47,046 logger.py[line:35] INFO coverage_c=36812
time=35.2266058921814, cov_py=0, cov_c=36812
New test requirements invoked on framework tensorflow when updating inception.resnet.v2-NLAll108-NLAll26
2024-06-12 17:16:51,291 logger.py[line:35] INFO Success on backend: tensorflow of model inception.resnet.v2-NLAll108-NLAll26
2024-06-12 17:16:51,291 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:16:51,292 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:16:51,292 logger.py[line:35] INFO after_prediction
2024-06-12 17:16:51,292 logger.py[line:35] INFO New representative seed found: inception.resnet.v2-NLAll108-NLAll26
2024-06-12 17:16:51,906 logger.py[line:35] INFO INFO: Mutation progress 28/100
2024-06-12 17:16:51,906 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:16:51,906 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:16:51,906 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:16:51,906 logger.py[line:35] INFO Score for Edge is: 0.8714285714285714
2024-06-12 17:16:51,906 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:16:51,906 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:16:51,906 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:16:51,906 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:16:51,906 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:16:51,906 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:16:51,906 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:16:51,907 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6
2024-06-12 17:16:51,907 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:16:56,569 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge')>, 'cropping2d': <KerasTensor: shape=(None, 11, 10, 128) dtype=float32 (created by layer 'cropping2d_copy_Edge')>}
Choosing 10 To Insert
2024-06-12 17:16:57,670 logger.py[line:35] INFO Insert 10 Global New Edges
2024-06-12 17:16:57,670 logger.py[line:35] INFO Candidate Edge: ('PReLU', 'MaxPooling2D')
2024-06-12 17:16:58,882 logger.py[line:35] INFO Trying Adding Edge: ['PReLU', 'MaxPooling2D'] by Connecting p_re_lu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:00,136 logger.py[line:35] INFO Successfully Add Edge: ['PReLU', 'MaxPooling2D'] by Connecting p_re_lu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:00,136 logger.py[line:35] INFO Candidate Edge: ('DepthwiseConv2D', 'GlobalMaxPooling2D')
2024-06-12 17:17:01,387 logger.py[line:35] INFO Trying Adding Edge: ['DepthwiseConv2D', 'GlobalMaxPooling2D'] by Connecting depthwise_conv2d_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:02,502 logger.py[line:35] INFO Successfully Add Edge: ['DepthwiseConv2D', 'GlobalMaxPooling2D'] by Connecting depthwise_conv2d_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:02,502 logger.py[line:35] INFO Candidate Edge: ('GaussianDropout', 'GaussianDropout')
2024-06-12 17:17:04,016 logger.py[line:35] INFO Trying Adding Edge: ['GaussianDropout', 'GaussianDropout'] by Connecting gaussian_dropout_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and gaussian_dropout_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:05,114 logger.py[line:35] INFO Successfully Add Edge: ['GaussianDropout', 'GaussianDropout'] by Connecting gaussian_dropout_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and gaussian_dropout_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:05,114 logger.py[line:35] INFO Candidate Edge: ('SimpleRNN', 'SimpleRNN')
2024-06-12 17:17:06,319 logger.py[line:35] INFO Trying Adding Edge: ['SimpleRNN', 'SimpleRNN'] by Connecting simple_rnn_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and simple_rnn_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:07,621 logger.py[line:35] INFO Successfully Add Edge: ['SimpleRNN', 'SimpleRNN'] by Connecting simple_rnn_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and simple_rnn_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:07,621 logger.py[line:35] INFO Candidate Edge: ('SimpleRNN', 'Softmax')
2024-06-12 17:17:08,859 logger.py[line:35] INFO Trying Adding Edge: ['SimpleRNN', 'Softmax'] by Connecting simple_rnn_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_2 and softmax_insert_copy_Edge_copy_Edge
2024-06-12 17:17:09,978 logger.py[line:35] INFO Successfully Add Edge: ['SimpleRNN', 'Softmax'] by Connecting simple_rnn_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_2 and softmax_insert_copy_Edge_copy_Edge
2024-06-12 17:17:09,978 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'SpatialDropout2D')
2024-06-12 17:17:11,433 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'SpatialDropout2D'] by Connecting max_pooling2d_insert_copy_Edge_copy_Edge and spatial_dropout2d_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:12,550 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'SpatialDropout2D'] by Connecting max_pooling2d_insert_copy_Edge_copy_Edge and spatial_dropout2d_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:12,550 logger.py[line:35] INFO Candidate Edge: ('ActivityRegularization', 'ThresholdedReLU')
2024-06-12 17:17:13,796 logger.py[line:35] INFO Trying Adding Edge: ['ActivityRegularization', 'ThresholdedReLU'] by Connecting activity_regularization_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and thresholded_re_lu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:15,079 logger.py[line:35] INFO Successfully Add Edge: ['ActivityRegularization', 'ThresholdedReLU'] by Connecting activity_regularization_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and thresholded_re_lu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:15,079 logger.py[line:35] INFO Candidate Edge: ('SeparableConv1D', 'Conv1D')
2024-06-12 17:17:16,334 logger.py[line:35] INFO Trying Adding Edge: ['SeparableConv1D', 'Conv1D'] by Connecting separable_conv1d_insert_copy_NLAll_copy_Edge_copy_Edge and conv1d_insert_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:17,475 logger.py[line:35] INFO Successfully Add Edge: ['SeparableConv1D', 'Conv1D'] by Connecting separable_conv1d_insert_copy_NLAll_copy_Edge_copy_Edge and conv1d_insert_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:17,475 logger.py[line:35] INFO Candidate Edge: ('Conv2DTranspose', 'ActivityRegularization')
2024-06-12 17:17:18,950 logger.py[line:35] INFO Trying Adding Edge: ['Conv2DTranspose', 'ActivityRegularization'] by Connecting conv2d_transpose_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and activity_regularization_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:20,095 logger.py[line:35] INFO Successfully Add Edge: ['Conv2DTranspose', 'ActivityRegularization'] by Connecting conv2d_transpose_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge and activity_regularization_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:20,095 logger.py[line:35] INFO Candidate Edge: ('SpatialDropout2D', 'Conv2D')
2024-06-12 17:17:21,363 logger.py[line:35] INFO Trying Adding Edge: ['SpatialDropout2D', 'Conv2D'] by Connecting spatial_dropout2d_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_1 and conv4_block1_3_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:22,681 logger.py[line:35] INFO Successfully Add Edge: ['SpatialDropout2D', 'Conv2D'] by Connecting spatial_dropout2d_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_1 and conv4_block1_3_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge
2024-06-12 17:17:22,855 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 124/2170
The Configuration Coverage is: 330/2049
The NDims Coverage Is: 58/117
The DType Coverage Is: 57/354
The Shape Coverage Is: 110/295
The Input Coverage Is: 225/766
2024-06-12 17:17:25,371 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:17:29,218 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:17:33,359 logger.py[line:35] INFO 2.9.0
2024-06-12 17:17:34,945 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:17:46,260 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6-Edge27 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:17:47,988 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 18s
2024-06-12 17:17:47,988 logger.py[line:35] INFO loading the redis
2024-06-12 17:17:47,991 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:17:48,012 logger.py[line:35] INFO coverage_c=36812
time=22.46923017501831, cov_py=0, cov_c=36812
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6-Edge27
2024-06-12 17:17:52,654 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6-Edge27
2024-06-12 17:17:52,654 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:17:52,654 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:17:52,654 logger.py[line:35] INFO after_prediction
2024-06-12 17:17:52,654 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6-Edge27
2024-06-12 17:17:53,085 logger.py[line:35] INFO INFO: Mutation progress 29/100
2024-06-12 17:17:53,085 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:17:53,086 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:17:53,086 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:17:53,086 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:17:53,086 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:17:53,086 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:17:53,086 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:17:53,086 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:17:53,086 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:17:53,086 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:17:53,086 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:17:53,086 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-MDtype45-MDims17
2024-06-12 17:17:53,086 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:17:55,991 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:17:56,699 logger.py[line:35] INFO Generating model using LMerg
2024-06-12 17:17:56,703 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:17:56,874 logger.py[line:35] INFO Insert 2 out of 2 Global New Layers
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 72, in generate_model_by_model_mutation
    return InteractionMutationUtils.merge_layers(model=model, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 165, in merge_layers
    assert len(selected_layer_name_list) == 1
AssertionError
2024-06-12 17:17:57,495 logger.py[line:35] INFO INFO: Mutation progress 29/100
2024-06-12 17:17:57,495 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:17:57,495 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:17:57,495 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:17:57,495 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:17:57,495 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:17:57,495 logger.py[line:35] INFO Score for LMerg is: 0.8461538461538461
2024-06-12 17:17:57,495 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:17:57,496 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:17:57,496 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:17:57,496 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:17:57,496 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:17:57,496 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-LMerg10
2024-06-12 17:17:57,496 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:18:01,651 logger.py[line:35] INFO Generating model using LMerg
model outputs {'predictions_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:18:02,615 logger.py[line:35] INFO Insert 1 out of 2 Global New Layers
2024-06-12 17:18:02,616 logger.py[line:35] INFO Trying Merge Layers: conv3_block4_3_bn_copy_LMerg_copy_LMerg_copy_LMerg and conv3_block2_3_bn_copy_LMerg_copy_LMerg_copy_LMerg by Average
2024-06-12 17:18:03,494 logger.py[line:35] INFO Success on Merge Layers: conv3_block4_3_bn_copy_LMerg_copy_LMerg_copy_LMerg and conv3_block2_3_bn_copy_LMerg_copy_LMerg_copy_LMerg by Average
2024-06-12 17:18:03,568 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 124/2170
The Configuration Coverage is: 330/2049
The NDims Coverage Is: 58/117
The DType Coverage Is: 57/354
The Shape Coverage Is: 110/295
The Input Coverage Is: 225/766
2024-06-12 17:18:05,560 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:18:09,441 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:18:13,561 logger.py[line:35] INFO 2.9.0
2024-06-12 17:18:15,126 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:18:23,311 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-LMerg10-LMerg28 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:18:25,007 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 15s
2024-06-12 17:18:25,007 logger.py[line:35] INFO loading the redis
2024-06-12 17:18:25,010 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:18:25,032 logger.py[line:35] INFO coverage_c=36836
time=19.299177885055542, cov_py=0, cov_c=36836
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-LMerg10-LMerg28
2024-06-12 17:18:29,737 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-LMerg10-LMerg28
2024-06-12 17:18:29,737 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:18:29,737 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:18:29,737 logger.py[line:35] INFO after_prediction
2024-06-12 17:18:29,737 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-LMerg10-LMerg28
2024-06-12 17:18:30,132 logger.py[line:35] INFO INFO: Mutation progress 30/100
2024-06-12 17:18:30,132 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:18:30,132 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:18:30,132 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:18:30,132 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:18:30,132 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:18:30,132 logger.py[line:35] INFO Score for LMerg is: 0.8571428571428571
2024-06-12 17:18:30,132 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:18:30,132 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:18:30,132 logger.py[line:35] INFO Score for SpecialI is: 0.6666666666666666
2024-06-12 17:18:30,132 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:18:30,132 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:18:30,132 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24
2024-06-12 17:18:30,132 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:18:34,481 logger.py[line:35] INFO Generating model using SpecialI
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI')>, 'cropping2d': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI')>, 'cropping2d_1': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI')>, 'cropping2d_2': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI')>, 'cropping2d_3': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI')>, 'cropping2d_4': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI')>, 'cropping2d_5': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI')>, 'cropping2d_6': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI')>}
2024-06-12 17:18:35,535 logger.py[line:35] INFO Change Input Of Layer: conv3_block4_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI To: inf
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI')>, 'cropping2d_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI')>, 'cropping2d_1_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI')>, 'cropping2d_2_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI')>, 'cropping2d_3_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI')>, 'cropping2d_4_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI')>, 'cropping2d_5_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI')>, 'cropping2d_6_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI')>}
2024-06-12 17:18:36,648 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 124/2170
The Configuration Coverage is: 330/2049
The NDims Coverage Is: 58/117
The DType Coverage Is: 57/354
The Shape Coverage Is: 110/295
The Input Coverage Is: 225/766
2024-06-12 17:18:38,866 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:18:42,731 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:18:46,863 logger.py[line:35] INFO 2.9.0
2024-06-12 17:18:48,454 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:18:58,086 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:18:59,849 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 17s
2024-06-12 17:18:59,849 logger.py[line:35] INFO loading the redis
2024-06-12 17:18:59,852 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:18:59,873 logger.py[line:35] INFO coverage_c=36836
time=20.834949493408203, cov_py=0, cov_c=36836
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29
2024-06-12 17:19:04,123 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29
2024-06-12 17:19:04,123 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:19:04,123 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:19:04,123 logger.py[line:35] INFO after_prediction
2024-06-12 17:19:04,123 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29
2024-06-12 17:19:04,498 logger.py[line:35] INFO INFO: Mutation progress 31/100
2024-06-12 17:19:04,498 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:19:04,498 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:19:04,498 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:19:04,498 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:19:04,498 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:19:04,498 logger.py[line:35] INFO Score for LMerg is: 0.8571428571428571
2024-06-12 17:19:04,498 logger.py[line:35] INFO Score for MParam is: 0.8421052631578947
2024-06-12 17:19:04,498 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:19:04,498 logger.py[line:35] INFO Score for SpecialI is: 0.6538461538461539
2024-06-12 17:19:04,498 logger.py[line:35] INFO The last used seed is: SpecialI
2024-06-12 17:19:04,499 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:19:04,499 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-NLAll99
2024-06-12 17:19:04,499 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:19:08,801 logger.py[line:35] INFO Generating model using MParam
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam')>}
2024-06-12 17:19:09,816 logger.py[line:35] INFO Changing 1/15 of layer conv5_block1_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 17:19:09,816 logger.py[line:35] INFO changing config kernel_regularizer in layer conv5_block1_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam: from None to l2
2024-06-12 17:19:09,816 logger.py[line:35] INFO changing config dilation_rate in layer conv5_block1_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam: from (1, 1) to [1, 2]
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam')>}
2024-06-12 17:19:10,801 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 124/2170
The Configuration Coverage is: 332/2049
The NDims Coverage Is: 58/117
The DType Coverage Is: 57/354
The Shape Coverage Is: 110/295
The Input Coverage Is: 225/766
2024-06-12 17:19:12,789 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:19:16,619 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:19:20,762 logger.py[line:35] INFO 2.9.0
2024-06-12 17:19:22,330 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:19:31,152 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-NLAll99-MParam30 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:19:32,885 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:19:32,885 logger.py[line:35] INFO loading the redis
2024-06-12 17:19:32,888 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:19:32,909 logger.py[line:35] INFO coverage_c=36837
time=19.94866132736206, cov_py=0, cov_c=36837
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-NLAll99-MParam30
2024-06-12 17:19:37,066 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-NLAll99-MParam30
2024-06-12 17:19:37,066 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:19:37,066 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:19:37,066 logger.py[line:35] INFO after_prediction
2024-06-12 17:19:37,066 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-NLAll99-MParam30
2024-06-12 17:19:37,439 logger.py[line:35] INFO INFO: Mutation progress 32/100
2024-06-12 17:19:37,439 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:19:37,439 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:19:37,439 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:19:37,439 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:19:37,439 logger.py[line:35] INFO Score for MDims is: 0.8703703703703703
2024-06-12 17:19:37,439 logger.py[line:35] INFO Score for LMerg is: 0.8571428571428571
2024-06-12 17:19:37,439 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:19:37,439 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:19:37,439 logger.py[line:35] INFO Score for SpecialI is: 0.6538461538461539
2024-06-12 17:19:37,439 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 17:19:37,440 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:19:37,440 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MParam115
2024-06-12 17:19:37,440 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:19:40,349 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:19:40,998 logger.py[line:35] INFO Generating model using MDims
2024-06-12 17:19:41,001 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims')>}
2024-06-12 17:19:41,137 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:19:41,137 logger.py[line:35] INFO Global Layer Class: 0; Local Layer Class: 1; Total Layer Class: 1
2024-06-12 17:19:41,137 logger.py[line:35] INFO Changing 0 Layer's NDims.
2024-06-12 17:19:41,137 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:19:41,138 logger.py[line:35] INFO No Global NDims Can Be Found, Randomly Select NDims: 6 For Layer: dropout_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims
2024-06-12 17:19:41,140 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims')>}
2024-06-12 17:19:41,314 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:19:41,917 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 124/2170
The Configuration Coverage is: 332/2049
The NDims Coverage Is: 58/117
The DType Coverage Is: 57/354
The Shape Coverage Is: 110/295
The Input Coverage Is: 225/766
2024-06-12 17:19:42,093 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:19:45,995 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:19:49,987 logger.py[line:35] INFO 2.9.0
2024-06-12 17:19:51,591 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:19:54,202 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MParam115-MDims31 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:19:55,403 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:19:55,403 logger.py[line:35] INFO loading the redis
2024-06-12 17:19:55,406 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:19:55,427 logger.py[line:35] INFO coverage_c=36837
time=13.162027597427368, cov_py=0, cov_c=36837
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MParam115-MDims31
2024-06-12 17:20:00,025 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MParam115-MDims31
2024-06-12 17:20:00,026 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:20:00,026 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:20:00,026 logger.py[line:35] INFO after_prediction
2024-06-12 17:20:00,026 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MParam115-MDims31
2024-06-12 17:20:00,361 logger.py[line:35] INFO INFO: Mutation progress 33/100
2024-06-12 17:20:00,362 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:20:00,362 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:20:00,362 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:20:00,362 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:20:00,362 logger.py[line:35] INFO Score for LMerg is: 0.8571428571428571
2024-06-12 17:20:00,362 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:20:00,362 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:20:00,362 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:20:00,362 logger.py[line:35] INFO Score for SpecialI is: 0.6538461538461539
2024-06-12 17:20:00,362 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:20:00,362 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:20:00,362 logger.py[line:35] INFO Choose seed: lenet-LMerg90-NLAll105-NLAll116-Edge130
2024-06-12 17:20:00,362 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:20:03,921 logger.py[line:35] INFO Generating model using LMerg
model outputs {'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg')>, 'cropping1d': <KerasTensor: shape=(None, 10, 2) dtype=float32 (created by layer 'cropping1d_copy_LMerg')>, 'dropout_5_copy_LMerg_merge1_copy_NLAll_copy_NLAll_copy_Edge_1_2': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'dropout_5_copy_LMerg_merge1_copy_NLAll_copy_NLAll_copy_Edge_1_2_copy_LMerg')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1': <KerasTensor: shape=(None, 14, 14, 6) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1_copy_LMerg')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg')>, 'elu_insert_copy_Edge_1_2_1': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'elu_insert_copy_Edge_1_2_1_copy_LMerg')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1_copy_LMerg')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2_copy_LMerg')>, 'cropping1d_1': <KerasTensor: shape=(None, 10, 2) dtype=float32 (created by layer 'cropping1d_1_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:20:04,057 logger.py[line:35] INFO Insert 1 out of 1 Global New Layers
2024-06-12 17:20:04,057 logger.py[line:35] INFO Trying Merge Layers: dropout_5_copy_LMerg_merge1_copy_NLAll_copy_NLAll_copy_Edge_1_2_copy_LMerg and thresholded_re_lu_insert_copy_NLAll_copy_Edge_copy_LMerg by Dot
2024-06-12 17:20:04,212 logger.py[line:35] INFO Success on Merge Layers: dropout_5_copy_LMerg_merge1_copy_NLAll_copy_NLAll_copy_Edge_1_2_copy_LMerg and thresholded_re_lu_insert_copy_NLAll_copy_Edge_copy_LMerg by Dot
2024-06-12 17:20:04,297 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 135/2170
The Configuration Coverage is: 334/2049
The NDims Coverage Is: 61/117
The DType Coverage Is: 57/354
The Shape Coverage Is: 114/295
The Input Coverage Is: 232/766
2024-06-12 17:20:05,113 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:20:08,967 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:20:12,963 logger.py[line:35] INFO 2.9.0
2024-06-12 17:20:14,584 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:20:19,435 logger.py[line:35] INFO SUCCESS:Get prediction for lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:20:21,078 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:20:21,078 logger.py[line:35] INFO loading the redis
2024-06-12 17:20:21,081 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:20:21,103 logger.py[line:35] INFO coverage_c=36903
time=15.817959308624268, cov_py=0, cov_c=36903
New test requirements invoked on framework tensorflow when updating lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32
2024-06-12 17:20:25,385 logger.py[line:35] INFO Success on backend: tensorflow of model lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32
2024-06-12 17:20:25,385 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:20:25,385 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:20:25,385 logger.py[line:35] INFO after_prediction
2024-06-12 17:20:25,385 logger.py[line:35] INFO New representative seed found: lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32
2024-06-12 17:20:25,689 logger.py[line:35] INFO INFO: Mutation progress 34/100
2024-06-12 17:20:25,689 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:20:25,689 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:20:25,689 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:20:25,689 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:20:25,689 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:20:25,689 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:20:25,689 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:20:25,689 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:20:25,689 logger.py[line:35] INFO Score for SpecialI is: 0.6538461538461539
2024-06-12 17:20:25,689 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:20:25,689 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:20:25,689 logger.py[line:35] INFO Choose seed: alexnet
2024-06-12 17:20:25,689 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:20:29,012 logger.py[line:35] INFO Generating model using NLAll
model outputs {'dense_3': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_NLAll')>}
2024-06-12 17:20:29,126 logger.py[line:35] INFO Insert 5 out of 24 Local New Layers
2024-06-12 17:20:29,126 logger.py[line:35] INFO insert PReLU after conv2d_3_copy_NLAll
2024-06-12 17:20:29,126 logger.py[line:35] INFO insert SeparableConv2D after batch_normalization_3_copy_NLAll
2024-06-12 17:20:29,126 logger.py[line:35] INFO insert UpSampling2D after conv2d_5_copy_NLAll
2024-06-12 17:20:29,126 logger.py[line:35] INFO insert SpatialDropout2D after conv2d_4_copy_NLAll
2024-06-12 17:20:29,126 logger.py[line:35] INFO insert ThresholdedReLU after dropout_1_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.advanced_activations.PReLU object at 0x7fe2885a2e50>
2024-06-12 17:20:29,173 logger.py[line:35] INFO Converting output shape (None, 3, 3, 384) to actual shape [None, 3, 3, 384]
[DEBUG] Inserting layer: <keras.layers.core.spatial_dropout.SpatialDropout2D object at 0x7fe2885d1990>
2024-06-12 17:20:29,181 logger.py[line:35] INFO Converting output shape (None, 3, 3, 384) to actual shape [None, 3, 3, 384]
[DEBUG] Inserting layer: <keras.layers.convolutional.UpSampling2D object at 0x7fe288556d10>
2024-06-12 17:20:29,193 logger.py[line:35] INFO Converting output shape (None, 3, 15, 1280) to actual shape [None, 3, 3, 256]
[DEBUG] Inserting layer: <keras.layers.convolutional.SeparableConv2D object at 0x7fe288532fd0>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 65, in new_layer_addition
    y = layer(layer_input)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1939, in _create_c_op
    raise ValueError(e.message)
ValueError: Exception encountered when calling layer "separable_conv2d_insert" (type SeparableConv2D).

Negative dimension size caused by subtracting 9 from 1 for '{{node separable_conv2d_insert/separable_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_FLOAT, data_format="NCHW", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="VALID", strides=[1, 1, 1, 1]](Placeholder, separable_conv2d_insert/separable_conv2d/ReadVariableOp)' with input shapes: [?,1,1,256], [9,2,1,1].

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 1, 1, 256), dtype=float32)
2024-06-12 17:20:29,714 logger.py[line:35] INFO INFO: Mutation progress 34/100
2024-06-12 17:20:29,714 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:20:29,714 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:20:29,714 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:20:29,714 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:20:29,714 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:20:29,714 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:20:29,715 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:20:29,715 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:20:29,715 logger.py[line:35] INFO Score for SpecialI is: 0.6538461538461539
2024-06-12 17:20:29,715 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:20:29,715 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:20:29,715 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-LMerg10
2024-06-12 17:20:29,715 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:20:33,857 logger.py[line:35] INFO Generating model using SpecialI
model outputs {'predictions_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_SpecialI')>}
2024-06-12 17:20:34,822 logger.py[line:35] INFO Change Input Of Layer: conv4_block3_2_conv_copy_LMerg_copy_LMerg_copy_SpecialI To: inf
model outputs {'predictions_copy_LMerg_copy_LMerg_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_SpecialI')>}
2024-06-12 17:20:35,772 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 135/2170
The Configuration Coverage is: 334/2049
The NDims Coverage Is: 61/117
The DType Coverage Is: 57/354
The Shape Coverage Is: 114/295
The Input Coverage Is: 232/766
2024-06-12 17:20:37,762 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:20:41,722 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:20:45,861 logger.py[line:35] INFO 2.9.0
2024-06-12 17:20:47,443 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:20:55,618 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-LMerg10-SpecialI33 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:20:57,334 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 15s
2024-06-12 17:20:57,334 logger.py[line:35] INFO loading the redis
2024-06-12 17:20:57,337 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:20:57,359 logger.py[line:35] INFO coverage_c=36903
time=19.424501180648804, cov_py=0, cov_c=36903
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-LMerg10-SpecialI33
2024-06-12 17:21:01,762 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-LMerg10-SpecialI33
2024-06-12 17:21:01,762 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:21:01,762 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:21:01,762 logger.py[line:35] INFO after_prediction
2024-06-12 17:21:01,762 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-LMerg10-SpecialI33
2024-06-12 17:21:02,140 logger.py[line:35] INFO INFO: Mutation progress 35/100
2024-06-12 17:21:02,140 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:21:02,140 logger.py[line:35] INFO Score for NLAll is: 0.8909090909090909
2024-06-12 17:21:02,140 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:21:02,140 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:21:02,140 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:21:02,140 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:21:02,140 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:21:02,140 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:21:02,140 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:21:02,140 logger.py[line:35] INFO The last used seed is: SpecialI
2024-06-12 17:21:02,141 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:21:02,141 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-NLAll124-MDtype127
2024-06-12 17:21:02,141 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:21:05,053 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:05,852 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 17:21:05,855 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_NLAll')>}
2024-06-12 17:21:06,122 logger.py[line:35] INFO Insert 1 out of 18 Global New Layers
2024-06-12 17:21:06,123 logger.py[line:35] INFO insert AveragePooling1D after repeat_vector_insert_copy_NLAll_copy_NLAll_copy_MDtype_copy_NLAll
2024-06-12 17:21:06,126 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.pooling.AveragePooling1D object at 0x7f0360414450>
2024-06-12 17:21:06,316 logger.py[line:35] INFO Converting output shape (None, 2, 25) to actual shape [None, 2, 25]
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_NLAll')>}
2024-06-12 17:21:06,376 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:21:07,054 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 136/2170
The Configuration Coverage is: 338/2049
The NDims Coverage Is: 62/117
The DType Coverage Is: 60/354
The Shape Coverage Is: 115/295
The Input Coverage Is: 237/766
2024-06-12 17:21:07,301 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:21:11,139 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:21:15,139 logger.py[line:35] INFO 2.9.0
2024-06-12 17:21:16,713 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:21:22,077 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-NLAll54-NLAll124-MDtype127-NLAll34 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:21:23,701 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:21:23,701 logger.py[line:35] INFO loading the redis
2024-06-12 17:21:23,704 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:21:23,725 logger.py[line:35] INFO coverage_c=36942
time=16.252471446990967, cov_py=0, cov_c=36942
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-NLAll124-MDtype127-NLAll34
2024-06-12 17:21:27,958 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-NLAll54-NLAll124-MDtype127-NLAll34
2024-06-12 17:21:27,959 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:21:27,959 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:21:27,959 logger.py[line:35] INFO after_prediction
2024-06-12 17:21:27,959 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-NLAll54-NLAll124-MDtype127-NLAll34
2024-06-12 17:21:28,265 logger.py[line:35] INFO INFO: Mutation progress 36/100
2024-06-12 17:21:28,265 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:21:28,266 logger.py[line:35] INFO Score for NLAll is: 0.8928571428571429
2024-06-12 17:21:28,266 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:21:28,266 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:21:28,266 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:21:28,266 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:21:28,266 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:21:28,266 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:21:28,266 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:21:28,266 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:21:28,266 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:21:28,266 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-NLAll99-SpecialI119
2024-06-12 17:21:28,266 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:21:31,177 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:31,200 recurrent_v2.py[line:399] WARNING Layer gru_insert_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:32,052 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:21:32,055 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:32,253 recurrent_v2.py[line:399] WARNING Layer gru_insert_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_SpecialI_copy_MDtype')>}
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 91, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dtype(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 403, in mutate_dtype
    mode=mutation_mode
  File "/root/implementations/scripts/tools/architecture_utils.py", line 990, in choose_layers_for_mdtype
    current_dtype_set = set(input_diversity[layer_class]["dtype"])
KeyError: 'Conv3D'
2024-06-12 17:21:32,903 logger.py[line:35] INFO INFO: Mutation progress 36/100
2024-06-12 17:21:32,904 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:21:32,904 logger.py[line:35] INFO Score for NLAll is: 0.8928571428571429
2024-06-12 17:21:32,904 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:21:32,904 logger.py[line:35] INFO Score for Edge is: 0.875
2024-06-12 17:21:32,904 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:21:32,904 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:21:32,904 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:21:32,904 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:21:32,904 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:21:32,904 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:21:32,904 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:21:32,904 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118
2024-06-12 17:21:32,904 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:21:35,813 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:36,524 logger.py[line:35] INFO Generating model using Edge
2024-06-12 17:21:36,527 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge')>}
Choosing 6 To Insert
2024-06-12 17:21:36,693 logger.py[line:35] INFO Insert 6 Global New Edges
2024-06-12 17:21:36,693 logger.py[line:35] INFO Candidate Edge: ('GaussianDropout', 'Dropout')
2024-06-12 17:21:36,704 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:36,866 logger.py[line:35] INFO Trying Adding Edge: ['GaussianDropout', 'Dropout'] by Connecting gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge and dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge
2024-06-12 17:21:36,869 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:37,034 logger.py[line:35] INFO Successfully Add Edge: ['GaussianDropout', 'Dropout'] by Connecting gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge and dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge
2024-06-12 17:21:37,034 logger.py[line:35] INFO Candidate Edge: ('GlobalMaxPooling3D', 'Dropout')
2024-06-12 17:21:37,044 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:37,220 logger.py[line:35] INFO Trying Adding Edge: ['GlobalMaxPooling3D', 'Dropout'] by Connecting global_max_pooling3d_insert_copy_SpecialI_copy_SpecialI_copy_Edge and dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1
2024-06-12 17:21:37,223 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:37,394 logger.py[line:35] INFO Successfully Add Edge: ['GlobalMaxPooling3D', 'Dropout'] by Connecting global_max_pooling3d_insert_copy_SpecialI_copy_SpecialI_copy_Edge and dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1
2024-06-12 17:21:37,394 logger.py[line:35] INFO Candidate Edge: ('UpSampling2D', 'Dropout')
2024-06-12 17:21:37,404 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:37,571 logger.py[line:35] INFO Trying Adding Edge: ['UpSampling2D', 'Dropout'] by Connecting up_sampling2d_insert_copy_SpecialI_copy_SpecialI_copy_Edge and dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_1
2024-06-12 17:21:37,573 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:37,746 logger.py[line:35] INFO Successfully Add Edge: ['UpSampling2D', 'Dropout'] by Connecting up_sampling2d_insert_copy_SpecialI_copy_SpecialI_copy_Edge and dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_1
2024-06-12 17:21:37,746 logger.py[line:35] INFO Candidate Edge: ('UpSampling3D', 'GlobalMaxPooling3D')
2024-06-12 17:21:37,755 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:38,088 logger.py[line:35] INFO Trying Adding Edge: ['UpSampling3D', 'GlobalMaxPooling3D'] by Connecting up_sampling3d_insert_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge and global_max_pooling3d_insert_copy_SpecialI_copy_SpecialI_copy_Edge
2024-06-12 17:21:38,091 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:38,276 logger.py[line:35] INFO Successfully Add Edge: ['UpSampling3D', 'GlobalMaxPooling3D'] by Connecting up_sampling3d_insert_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge and global_max_pooling3d_insert_copy_SpecialI_copy_SpecialI_copy_Edge
2024-06-12 17:21:38,276 logger.py[line:35] INFO Candidate Edge: ('RepeatVector', 'LSTM')
2024-06-12 17:21:38,286 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:38,467 logger.py[line:35] INFO Trying Adding Edge: ['RepeatVector', 'LSTM'] by Connecting repeat_vector_insert_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge and lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge
2024-06-12 17:21:38,470 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:38,568 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:38,743 logger.py[line:35] INFO Successfully Add Edge: ['RepeatVector', 'LSTM'] by Connecting repeat_vector_insert_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge and lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge
2024-06-12 17:21:38,743 logger.py[line:35] INFO Candidate Edge: ('GlobalMaxPooling3D', 'GaussianDropout')
2024-06-12 17:21:38,754 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:38,767 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:39,030 logger.py[line:35] INFO Trying Adding Edge: ['GlobalMaxPooling3D', 'GaussianDropout'] by Connecting global_max_pooling3d_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2 and gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge
2024-06-12 17:21:39,033 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:39,211 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:39,305 logger.py[line:35] INFO Successfully Add Edge: ['GlobalMaxPooling3D', 'GaussianDropout'] by Connecting global_max_pooling3d_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2 and gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge
2024-06-12 17:21:39,367 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:21:40,014 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:21:40,028 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 143/2170
The Configuration Coverage is: 338/2049
The NDims Coverage Is: 63/117
The DType Coverage Is: 60/354
The Shape Coverage Is: 118/295
The Input Coverage Is: 241/766
2024-06-12 17:21:40,308 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:21:44,162 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:21:48,145 logger.py[line:35] INFO 2.9.0
2024-06-12 17:21:49,712 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:21:53,342 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:21:54,521 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 10s
2024-06-12 17:21:54,521 logger.py[line:35] INFO loading the redis
2024-06-12 17:21:54,524 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:21:54,546 logger.py[line:35] INFO coverage_c=36943
time=14.063791990280151, cov_py=0, cov_c=36943
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35
2024-06-12 17:21:58,797 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35
2024-06-12 17:21:58,798 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:21:58,798 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:21:58,798 logger.py[line:35] INFO after_prediction
2024-06-12 17:21:58,798 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35
2024-06-12 17:21:59,104 logger.py[line:35] INFO INFO: Mutation progress 37/100
2024-06-12 17:21:59,104 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:21:59,104 logger.py[line:35] INFO Score for NLAll is: 0.8928571428571429
2024-06-12 17:21:59,105 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:21:59,105 logger.py[line:35] INFO Score for Edge is: 0.8783783783783784
2024-06-12 17:21:59,105 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:21:59,105 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:21:59,105 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:21:59,105 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:21:59,105 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:21:59,105 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:21:59,105 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:21:59,105 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113
2024-06-12 17:21:59,105 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:22:02,016 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:22:02,704 logger.py[line:35] INFO Generating model using Edge
2024-06-12 17:22:02,708 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge')>}
Choosing 1 To Insert
2024-06-12 17:22:02,856 logger.py[line:35] INFO Insert 1 Global New Edges
2024-06-12 17:22:02,856 logger.py[line:35] INFO Candidate Edge: ('LSTM', 'RepeatVector')
2024-06-12 17:22:02,865 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:22:03,012 logger.py[line:35] INFO Trying Adding Edge: ['LSTM', 'RepeatVector'] by Connecting lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge and repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_Edge
2024-06-12 17:22:03,016 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:22:03,164 logger.py[line:35] INFO Successfully Add Edge: ['LSTM', 'RepeatVector'] by Connecting lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge and repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_Edge
2024-06-12 17:22:03,194 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:22:03,796 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 144/2170
The Configuration Coverage is: 338/2049
The NDims Coverage Is: 63/117
The DType Coverage Is: 60/354
The Shape Coverage Is: 118/295
The Input Coverage Is: 241/766
2024-06-12 17:22:03,963 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:22:07,834 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:22:11,820 logger.py[line:35] INFO 2.9.0
2024-06-12 17:22:13,400 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:22:16,096 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MDtype113-Edge36 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:22:17,291 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:22:17,292 logger.py[line:35] INFO loading the redis
2024-06-12 17:22:17,295 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:22:17,316 logger.py[line:35] INFO coverage_c=36943
time=13.178309917449951, cov_py=0, cov_c=36943
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MDtype113-Edge36
2024-06-12 17:22:21,589 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MDtype113-Edge36
2024-06-12 17:22:21,589 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:22:21,589 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:22:21,589 logger.py[line:35] INFO after_prediction
2024-06-12 17:22:21,589 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MDtype113-Edge36
2024-06-12 17:22:21,889 logger.py[line:35] INFO INFO: Mutation progress 38/100
2024-06-12 17:22:21,889 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:22:21,890 logger.py[line:35] INFO Score for NLAll is: 0.8928571428571429
2024-06-12 17:22:21,890 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:22:21,890 logger.py[line:35] INFO Score for Edge is: 0.881578947368421
2024-06-12 17:22:21,890 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:22:21,890 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:22:21,890 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:22:21,890 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:22:21,890 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:22:21,890 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:22:21,890 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:22:21,890 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118
2024-06-12 17:22:21,890 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:22:24,827 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:22:25,542 logger.py[line:35] INFO Generating model using LMerg
2024-06-12 17:22:25,545 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:22:25,709 logger.py[line:35] INFO Insert 2 out of 8 Local New Layer
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 72, in generate_model_by_model_mutation
    return InteractionMutationUtils.merge_layers(model=model, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 165, in merge_layers
    assert len(selected_layer_name_list) == 1
AssertionError
2024-06-12 17:22:26,144 logger.py[line:35] INFO INFO: Mutation progress 38/100
2024-06-12 17:22:26,144 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:22:26,144 logger.py[line:35] INFO Score for NLAll is: 0.8928571428571429
2024-06-12 17:22:26,144 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:22:26,144 logger.py[line:35] INFO Score for Edge is: 0.881578947368421
2024-06-12 17:22:26,145 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:22:26,145 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:22:26,145 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:22:26,145 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:22:26,145 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:22:26,145 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:22:26,145 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:22:26,145 logger.py[line:35] INFO Choose seed: alexnet
2024-06-12 17:22:26,145 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:22:29,490 logger.py[line:35] INFO Generating model using LMerg
model outputs {'dense_3': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:22:29,580 logger.py[line:35] INFO Insert 2 out of 8 Local New Layer
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 72, in generate_model_by_model_mutation
    return InteractionMutationUtils.merge_layers(model=model, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 165, in merge_layers
    assert len(selected_layer_name_list) == 1
AssertionError
2024-06-12 17:22:30,007 logger.py[line:35] INFO INFO: Mutation progress 38/100
2024-06-12 17:22:30,008 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:22:30,008 logger.py[line:35] INFO Score for NLAll is: 0.8928571428571429
2024-06-12 17:22:30,008 logger.py[line:35] INFO Score for MDtype is: 0.8902439024390244
2024-06-12 17:22:30,008 logger.py[line:35] INFO Score for Edge is: 0.881578947368421
2024-06-12 17:22:30,008 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:22:30,008 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:22:30,008 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:22:30,008 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:22:30,008 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:22:30,008 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:22:30,008 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:22:30,008 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29
2024-06-12 17:22:30,008 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:22:34,380 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype')>, 'cropping2d_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype')>, 'cropping2d_1_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype')>, 'cropping2d_2_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype')>, 'cropping2d_3_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype')>, 'cropping2d_4_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype')>, 'cropping2d_5_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype')>, 'cropping2d_6_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype')>}
2024-06-12 17:22:35,429 logger.py[line:35] INFO Change 2 Layer's DType Out Of 6 Layer classes
2024-06-12 17:22:35,429 logger.py[line:35] INFO Changing 2 out of 6 Layer's DType.
2024-06-12 17:22:35,430 logger.py[line:35] INFO Selecting a Global DType float32 For Layer conv4_block4_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype
2024-06-12 17:22:35,430 logger.py[line:35] INFO Selecting a Global DType float32 For Layer pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_1_copy_SpecialI_copy_MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype')>, 'cropping2d_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype')>, 'cropping2d_1_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype')>, 'cropping2d_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype')>, 'cropping2d_3_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype')>, 'cropping2d_4_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype')>, 'cropping2d_5_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype')>, 'cropping2d_6_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype')>}
2024-06-12 17:22:36,555 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 144/2170
The Configuration Coverage is: 338/2049
The NDims Coverage Is: 63/117
The DType Coverage Is: 60/354
The Shape Coverage Is: 118/295
The Input Coverage Is: 241/766
2024-06-12 17:22:38,772 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:22:42,605 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:22:46,737 logger.py[line:35] INFO 2.9.0
2024-06-12 17:22:48,322 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:22:57,962 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:22:59,672 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 17s
2024-06-12 17:22:59,672 logger.py[line:35] INFO loading the redis
2024-06-12 17:22:59,675 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:22:59,696 logger.py[line:35] INFO coverage_c=36943
time=20.750797033309937, cov_py=0, cov_c=36943
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37
2024-06-12 17:23:03,896 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37
2024-06-12 17:23:03,896 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:23:03,896 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:23:03,896 logger.py[line:35] INFO after_prediction
2024-06-12 17:23:03,896 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37
2024-06-12 17:23:04,272 logger.py[line:35] INFO INFO: Mutation progress 39/100
2024-06-12 17:23:04,272 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:23:04,273 logger.py[line:35] INFO Score for NLAll is: 0.8928571428571429
2024-06-12 17:23:04,273 logger.py[line:35] INFO Score for Edge is: 0.881578947368421
2024-06-12 17:23:04,273 logger.py[line:35] INFO Score for MDtype is: 0.8809523809523809
2024-06-12 17:23:04,273 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:23:04,273 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:23:04,273 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:23:04,273 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:23:04,273 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:23:04,273 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:23:04,273 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:23:04,273 logger.py[line:35] INFO Choose seed: inception.resnet.v2-NLAll108-NLAll26
2024-06-12 17:23:04,273 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:23:11,869 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_NLAll_copy_NLAll_copy_MDtype')>}
2024-06-12 17:23:15,603 logger.py[line:35] INFO Change 2 Layer's DType Out Of 8 Layer classes
2024-06-12 17:23:15,603 logger.py[line:35] INFO Changing 2 out of 8 Layer's DType.
2024-06-12 17:23:15,605 logger.py[line:35] INFO Selecting a Global DType double For Layer conv2d_104_copy_NLAll_copy_NLAll_copy_MDtype
2024-06-12 17:23:15,607 logger.py[line:35] INFO Selecting a Global DType float64 For Layer alpha_dropout_insert_copy_NLAll_copy_MDtype
model outputs {'predictions_copy_NLAll_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_NLAll_copy_NLAll_copy_MDtype')>}
2024-06-12 17:23:19,494 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 144/2170
The Configuration Coverage is: 338/2049
The NDims Coverage Is: 63/117
The DType Coverage Is: 61/354
The Shape Coverage Is: 118/295
The Input Coverage Is: 242/766
2024-06-12 17:23:25,734 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:23:29,614 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:23:33,859 logger.py[line:35] INFO 2.9.0
2024-06-12 17:23:35,423 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:23:59,364 logger.py[line:35] INFO SUCCESS:Get prediction for inception.resnet.v2-NLAll108-NLAll26-MDtype38 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:24:01,298 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 31s
2024-06-12 17:24:01,299 logger.py[line:35] INFO loading the redis
2024-06-12 17:24:01,301 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:24:01,323 logger.py[line:35] INFO coverage_c=36944
time=35.414281606674194, cov_py=0, cov_c=36944
New test requirements invoked on framework tensorflow when updating inception.resnet.v2-NLAll108-NLAll26-MDtype38
2024-06-12 17:24:05,631 logger.py[line:35] INFO Success on backend: tensorflow of model inception.resnet.v2-NLAll108-NLAll26-MDtype38
2024-06-12 17:24:05,632 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:24:05,632 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:24:05,632 logger.py[line:35] INFO after_prediction
2024-06-12 17:24:05,632 logger.py[line:35] INFO New representative seed found: inception.resnet.v2-NLAll108-NLAll26-MDtype38
2024-06-12 17:24:06,244 logger.py[line:35] INFO INFO: Mutation progress 40/100
2024-06-12 17:24:06,244 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:24:06,244 logger.py[line:35] INFO Score for NLAll is: 0.8928571428571429
2024-06-12 17:24:06,244 logger.py[line:35] INFO Score for MDtype is: 0.8837209302325582
2024-06-12 17:24:06,244 logger.py[line:35] INFO Score for Edge is: 0.881578947368421
2024-06-12 17:24:06,244 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:24:06,244 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:24:06,244 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:24:06,244 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:24:06,244 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:24:06,244 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:24:06,245 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:24:06,245 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6
2024-06-12 17:24:06,245 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:24:10,547 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype')>}
2024-06-12 17:24:11,526 logger.py[line:35] INFO Change 1 Layer's DType Out Of 5 Layer classes
2024-06-12 17:24:11,526 logger.py[line:35] INFO Changing 1 out of 5 Layer's DType.
2024-06-12 17:24:11,527 logger.py[line:35] INFO Selecting a Global DType float32 For Layer avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype')>}
2024-06-12 17:24:12,502 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 144/2170
The Configuration Coverage is: 338/2049
The NDims Coverage Is: 63/117
The DType Coverage Is: 61/354
The Shape Coverage Is: 118/295
The Input Coverage Is: 242/766
2024-06-12 17:24:14,502 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:24:18,364 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:24:22,489 logger.py[line:35] INFO 2.9.0
2024-06-12 17:24:24,085 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:24:32,712 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-MDtype39 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:24:34,429 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:24:34,429 logger.py[line:35] INFO loading the redis
2024-06-12 17:24:34,432 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:24:34,454 logger.py[line:35] INFO coverage_c=36944
time=19.776851415634155, cov_py=0, cov_c=36944
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-MDtype39
2024-06-12 17:24:38,706 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-MDtype39
2024-06-12 17:24:38,706 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:24:38,706 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:24:38,706 logger.py[line:35] INFO after_prediction
2024-06-12 17:24:38,706 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-MDtype39
2024-06-12 17:24:39,097 logger.py[line:35] INFO INFO: Mutation progress 41/100
2024-06-12 17:24:39,098 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:24:39,098 logger.py[line:35] INFO Score for NLAll is: 0.8928571428571429
2024-06-12 17:24:39,098 logger.py[line:35] INFO Score for Edge is: 0.881578947368421
2024-06-12 17:24:39,098 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:24:39,098 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:24:39,098 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:24:39,098 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:24:39,098 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:24:39,098 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:24:39,098 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:24:39,098 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:24:39,098 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35
2024-06-12 17:24:39,098 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:24:42,001 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:24:42,016 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:24:42,819 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 17:24:42,822 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:24:43,013 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2': <KerasTensor: shape=(None, 1, 9, 9, 225) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll')>, 'cropping2d': <KerasTensor: shape=(None, 11, 11, 225) dtype=float32 (created by layer 'cropping2d_copy_NLAll')>, 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2': <KerasTensor: shape=(None, 25) dtype=float32 (created by layer 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll')>, 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll')>}
2024-06-12 17:24:43,163 logger.py[line:35] INFO Insert 1 out of 17 Global New Layers
2024-06-12 17:24:43,163 logger.py[line:35] INFO insert DepthwiseConv1D after repeat_vector_insert_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll
2024-06-12 17:24:43,166 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.convolutional.DepthwiseConv1D object at 0x7f915036e110>
2024-06-12 17:24:43,347 logger.py[line:35] INFO Converting output shape (None, 2, 17) to actual shape [None, 2, 25]
2024-06-12 17:24:43,374 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 1, 9, 9, 225) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll')>, 'cropping2d_copy_NLAll': <KerasTensor: shape=(None, 11, 11, 225) dtype=float32 (created by layer 'cropping2d_copy_NLAll')>, 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 25) dtype=float32 (created by layer 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll')>, 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll')>}
2024-06-12 17:24:43,533 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:24:44,205 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:24:44,221 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 145/2170
The Configuration Coverage is: 353/2049
The NDims Coverage Is: 64/117
The DType Coverage Is: 62/354
The Shape Coverage Is: 119/295
The Input Coverage Is: 245/766
2024-06-12 17:24:44,516 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:24:48,496 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:24:52,539 logger.py[line:35] INFO 2.9.0
2024-06-12 17:24:54,129 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:24:57,867 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:24:59,105 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 10s
2024-06-12 17:24:59,105 logger.py[line:35] INFO loading the redis
2024-06-12 17:24:59,108 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:24:59,130 logger.py[line:35] INFO coverage_c=36944
time=14.439491748809814, cov_py=0, cov_c=36944
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40
2024-06-12 17:25:03,417 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40
2024-06-12 17:25:03,417 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:25:03,417 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:25:03,417 logger.py[line:35] INFO after_prediction
2024-06-12 17:25:03,417 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40
2024-06-12 17:25:03,730 logger.py[line:35] INFO INFO: Mutation progress 42/100
2024-06-12 17:25:03,730 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:25:03,730 logger.py[line:35] INFO Score for NLAll is: 0.8947368421052632
2024-06-12 17:25:03,730 logger.py[line:35] INFO Score for Edge is: 0.881578947368421
2024-06-12 17:25:03,731 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:25:03,731 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:25:03,731 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:25:03,731 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:25:03,731 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:25:03,731 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:25:03,731 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:25:03,731 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:25:03,731 logger.py[line:35] INFO Choose seed: inception.resnet.v2-NLAll108-NLAll26-MDtype38
2024-06-12 17:25:03,731 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:25:11,428 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_NLAll_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge')>}
Choosing 9 To Insert
2024-06-12 17:25:15,168 logger.py[line:35] INFO Insert 9 Global New Edges
2024-06-12 17:25:15,168 logger.py[line:35] INFO Candidate Edge: ('Conv2DTranspose', 'Conv2D')
2024-06-12 17:25:19,762 logger.py[line:35] INFO Trying Adding Edge: ['Conv2DTranspose', 'Conv2D'] by Connecting conv2d_transpose_insert_copy_MDtype_copy_Edge and conv2d_53_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge
2024-06-12 17:25:23,450 logger.py[line:35] INFO Successfully Add Edge: ['Conv2DTranspose', 'Conv2D'] by Connecting conv2d_transpose_insert_copy_MDtype_copy_Edge and conv2d_53_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge
2024-06-12 17:25:23,450 logger.py[line:35] INFO Candidate Edge: ('AveragePooling2D', 'AveragePooling2D')
2024-06-12 17:25:28,209 logger.py[line:35] INFO Trying Adding Edge: ['AveragePooling2D', 'AveragePooling2D'] by Connecting average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge and average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge
2024-06-12 17:25:31,686 logger.py[line:35] INFO Successfully Add Edge: ['AveragePooling2D', 'AveragePooling2D'] by Connecting average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge and average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge
2024-06-12 17:25:31,686 logger.py[line:35] INFO Candidate Edge: ('AlphaDropout', 'Conv2DTranspose')
2024-06-12 17:25:36,327 logger.py[line:35] INFO Trying Adding Edge: ['AlphaDropout', 'Conv2DTranspose'] by Connecting alpha_dropout_insert_copy_NLAll_copy_MDtype_copy_Edge and conv2d_transpose_insert_copy_MDtype_copy_Edge
2024-06-12 17:25:40,199 logger.py[line:35] INFO Successfully Add Edge: ['AlphaDropout', 'Conv2DTranspose'] by Connecting alpha_dropout_insert_copy_NLAll_copy_MDtype_copy_Edge and conv2d_transpose_insert_copy_MDtype_copy_Edge
2024-06-12 17:25:40,199 logger.py[line:35] INFO Candidate Edge: ('AlphaDropout', 'ConvLSTM1D')
2024-06-12 17:25:44,658 logger.py[line:35] INFO Trying Adding Edge: ['AlphaDropout', 'ConvLSTM1D'] by Connecting alpha_dropout_insert_copy_NLAll_copy_MDtype_copy_Edge and conv_lstm1d_insert_copy_MDtype_copy_Edge
2024-06-12 17:25:48,593 logger.py[line:35] INFO Successfully Add Edge: ['AlphaDropout', 'ConvLSTM1D'] by Connecting alpha_dropout_insert_copy_NLAll_copy_MDtype_copy_Edge and conv_lstm1d_insert_copy_MDtype_copy_Edge
2024-06-12 17:25:48,593 logger.py[line:35] INFO Candidate Edge: ('BatchNormalization', 'ConvLSTM1D')
2024-06-12 17:25:53,473 logger.py[line:35] INFO Trying Adding Edge: ['BatchNormalization', 'ConvLSTM1D'] by Connecting batch_normalization_136_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge and conv_lstm1d_insert_copy_MDtype_copy_Edge_1
2024-06-12 17:25:57,394 logger.py[line:35] INFO Successfully Add Edge: ['BatchNormalization', 'ConvLSTM1D'] by Connecting batch_normalization_136_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge and conv_lstm1d_insert_copy_MDtype_copy_Edge_1
2024-06-12 17:25:57,394 logger.py[line:35] INFO Candidate Edge: ('AlphaDropout', 'GlobalAveragePooling2D')
2024-06-12 17:26:02,422 logger.py[line:35] INFO Trying Adding Edge: ['AlphaDropout', 'GlobalAveragePooling2D'] by Connecting alpha_dropout_insert_copy_NLAll_copy_MDtype_copy_Edge and avg_pool_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge
2024-06-12 17:26:06,176 logger.py[line:35] INFO Successfully Add Edge: ['AlphaDropout', 'GlobalAveragePooling2D'] by Connecting alpha_dropout_insert_copy_NLAll_copy_MDtype_copy_Edge and avg_pool_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge
2024-06-12 17:26:06,177 logger.py[line:35] INFO Candidate Edge: ('Conv2DTranspose', 'Conv2DTranspose')
2024-06-12 17:26:11,180 logger.py[line:35] INFO Trying Adding Edge: ['Conv2DTranspose', 'Conv2DTranspose'] by Connecting conv2d_transpose_insert_copy_MDtype_copy_Edge_2 and conv2d_transpose_insert_copy_MDtype_copy_Edge_1
2024-06-12 17:26:15,127 logger.py[line:35] INFO Successfully Add Edge: ['Conv2DTranspose', 'Conv2DTranspose'] by Connecting conv2d_transpose_insert_copy_MDtype_copy_Edge_2 and conv2d_transpose_insert_copy_MDtype_copy_Edge_1
2024-06-12 17:26:15,127 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'ConvLSTM1D')
2024-06-12 17:26:20,186 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'ConvLSTM1D'] by Connecting max_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge and conv_lstm1d_insert_copy_MDtype_copy_Edge_1_2
2024-06-12 17:26:24,061 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'ConvLSTM1D'] by Connecting max_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge and conv_lstm1d_insert_copy_MDtype_copy_Edge_1_2
2024-06-12 17:26:24,062 logger.py[line:35] INFO Candidate Edge: ('AveragePooling2D', 'MaxPooling2D')
2024-06-12 17:26:29,137 logger.py[line:35] INFO Trying Adding Edge: ['AveragePooling2D', 'MaxPooling2D'] by Connecting average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2 and max_pooling2d_2_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge
2024-06-12 17:26:33,390 logger.py[line:35] INFO Successfully Add Edge: ['AveragePooling2D', 'MaxPooling2D'] by Connecting average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2 and max_pooling2d_2_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge
2024-06-12 17:26:33,765 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 157/2170
The Configuration Coverage is: 354/2049
The NDims Coverage Is: 64/117
The DType Coverage Is: 64/354
The Shape Coverage Is: 127/295
The Input Coverage Is: 255/766
2024-06-12 17:26:41,059 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:26:44,887 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:26:49,134 logger.py[line:35] INFO 2.9.0
2024-06-12 17:26:50,710 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:27:19,104 logger.py[line:35] INFO SUCCESS:Get prediction for inception.resnet.v2-NLAll108-NLAll26-MDtype38-Edge41 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:27:21,077 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 36s
2024-06-12 17:27:21,077 logger.py[line:35] INFO loading the redis
2024-06-12 17:27:21,080 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:27:21,102 logger.py[line:35] INFO coverage_c=37204
time=39.86455702781677, cov_py=0, cov_c=37204
New test requirements invoked on framework tensorflow when updating inception.resnet.v2-NLAll108-NLAll26-MDtype38-Edge41
2024-06-12 17:27:25,403 logger.py[line:35] INFO Success on backend: tensorflow of model inception.resnet.v2-NLAll108-NLAll26-MDtype38-Edge41
2024-06-12 17:27:25,403 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:27:25,403 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:27:25,403 logger.py[line:35] INFO after_prediction
2024-06-12 17:27:25,403 logger.py[line:35] INFO New representative seed found: inception.resnet.v2-NLAll108-NLAll26-MDtype38-Edge41
2024-06-12 17:27:26,041 logger.py[line:35] INFO INFO: Mutation progress 43/100
2024-06-12 17:27:26,041 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:27:26,041 logger.py[line:35] INFO Score for NLAll is: 0.8947368421052632
2024-06-12 17:27:26,041 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:27:26,041 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:27:26,041 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:27:26,041 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:27:26,041 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:27:26,041 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:27:26,041 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:27:26,041 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:27:26,042 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:27:26,042 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37
2024-06-12 17:27:26,042 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:27:30,426 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_1_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_3_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_4_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_5_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_6_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_NLAll')>}
2024-06-12 17:27:31,786 logger.py[line:35] INFO Insert 10 out of 29 Local New Layers
2024-06-12 17:27:31,786 logger.py[line:35] INFO insert LeakyReLU after conv2_block1_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,787 logger.py[line:35] INFO insert LayerNormalization after conv4_block4_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,787 logger.py[line:35] INFO insert ConvLSTM1D after pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_1_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,787 logger.py[line:35] INFO insert Cropping2D after cropping2d_2_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,787 logger.py[line:35] INFO insert UpSampling2D after conv4_block6_2_bn_copy_LMerg_merge1_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,787 logger.py[line:35] INFO insert SpatialDropout2D after conv4_block3_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,787 logger.py[line:35] INFO insert Softmax after cropping2d_5_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,787 logger.py[line:35] INFO insert Dropout after conv4_block1_0_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,787 logger.py[line:35] INFO insert ThresholdedReLU after cropping2d_5_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,787 logger.py[line:35] INFO insert AlphaDropout after cropping2d_5_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,788 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 2
2024-06-12 17:27:31,791 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [3]
2024-06-12 17:27:31,792 logger.py[line:35] INFO insert Conv1D after conv5_block3_add_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:31,796 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [5]
2024-06-12 17:27:31,796 logger.py[line:35] INFO insert UpSampling3D after conv4_block6_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 62, in new_layer_addition
    layer_list = selected_layer(output_shape)
  File "/root/implementations/scripts/generation/layer_pools.py", line 463, in conv_lstm_1d
    inserted_layer = ConfigurationUtils.random_config(candidate_layer)
  File "/root/implementations/scripts/generation/layer_pools.py", line 57, in random_config
    new_layer = layer.from_config(layer_config)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 970, in from_config
    return cls(**config)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 1134, in __init__
    **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 842, in __init__
    **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 141, in __init__
    'Unrolling is not possible with convolutional RNNs. '
TypeError: Unrolling is not possible with convolutional RNNs. Received: unroll=True
2024-06-12 17:27:32,468 logger.py[line:35] INFO INFO: Mutation progress 43/100
2024-06-12 17:27:32,468 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:27:32,468 logger.py[line:35] INFO Score for NLAll is: 0.8947368421052632
2024-06-12 17:27:32,468 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:27:32,468 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:27:32,468 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:27:32,468 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:27:32,468 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:27:32,468 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:27:32,468 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:27:32,468 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:27:32,469 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:27:32,469 logger.py[line:35] INFO Choose seed: resnet50-Edge65
2024-06-12 17:27:32,469 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:27:36,631 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_NLAll')>, 'cropping2d': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'cropping2d_copy_NLAll')>, 'avg_pool_copy_Edge_2': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_NLAll')>}
2024-06-12 17:27:37,859 logger.py[line:35] INFO Insert 8 out of 29 Local New Layers
2024-06-12 17:27:37,859 logger.py[line:35] INFO insert LayerNormalization after conv4_block1_1_conv_copy_Edge_copy_NLAll
2024-06-12 17:27:37,859 logger.py[line:35] INFO insert Cropping2D after cropping2d_copy_NLAll
2024-06-12 17:27:37,859 logger.py[line:35] INFO insert SeparableConv2D after conv5_block1_3_bn_copy_Edge_copy_NLAll
2024-06-12 17:27:37,860 logger.py[line:35] INFO insert TimeDistributed after conv3_block1_1_bn_copy_Edge_copy_NLAll
2024-06-12 17:27:37,860 logger.py[line:35] INFO insert Conv2DTranspose after conv5_block1_2_conv_copy_Edge_copy_NLAll
2024-06-12 17:27:37,860 logger.py[line:35] INFO insert GaussianNoise after conv4_block6_1_bn_copy_Edge_copy_NLAll
2024-06-12 17:27:37,860 logger.py[line:35] INFO insert DepthwiseConv2D after conv5_block3_2_conv_copy_Edge_copy_NLAll
2024-06-12 17:27:37,860 logger.py[line:35] INFO insert ReLU after conv2_block3_1_conv_copy_Edge_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ReLU object at 0x7f1338439ed0>
2024-06-12 17:27:38,003 logger.py[line:35] INFO Converting output shape (None, 56, 56, 64) to actual shape [None, 56, 56, 64]
[DEBUG] Inserting layer: <keras.layers.wrappers.TimeDistributed object at 0x7f1338402ed0>
2024-06-12 17:27:38,066 logger.py[line:35] INFO Converting output shape (None, 28, 28, 128) to actual shape [None, 28, 28, 128]
[DEBUG] Inserting layer: <keras.layers.normalization.layer_normalization.LayerNormalization object at 0x7f13382c36d0>
2024-06-12 17:27:38,276 logger.py[line:35] INFO Converting output shape (None, 14, 14, 256) to actual shape [None, 14, 14, 256]
[DEBUG] Inserting layer: <keras.layers.noise.GaussianNoise object at 0x7f13383233d0>
2024-06-12 17:27:38,542 logger.py[line:35] INFO Converting output shape (None, 14, 14, 256) to actual shape [None, 14, 14, 256]
[DEBUG] Inserting layer: <keras.layers.convolutional.Conv2DTranspose object at 0x7f13a4d76910>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 65, in new_layer_addition
    y = layer(layer_input)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/initializers/initializers_v2.py", line 674, in __call__
    'Identity matrix initializer can only be used for 2D matrices. '
ValueError: Identity matrix initializer can only be used for 2D matrices. Received: shape=(2, 3, 512, 512) of rank 4.
2024-06-12 17:27:39,275 logger.py[line:35] INFO INFO: Mutation progress 43/100
2024-06-12 17:27:39,275 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:27:39,275 logger.py[line:35] INFO Score for NLAll is: 0.8947368421052632
2024-06-12 17:27:39,275 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:27:39,275 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:27:39,275 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:27:39,275 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:27:39,275 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:27:39,275 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:27:39,275 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:27:39,275 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:27:39,276 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:27:39,276 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37
2024-06-12 17:27:39,276 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:27:43,680 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_1_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_3_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_4_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_5_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_6_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_NLAll')>}
2024-06-12 17:27:45,029 logger.py[line:35] INFO Insert 3 out of 29 Local New Layers
2024-06-12 17:27:45,030 logger.py[line:35] INFO insert DepthwiseConv2D after conv3_block3_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:45,030 logger.py[line:35] INFO insert TimeDistributed after conv5_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
2024-06-12 17:27:45,030 logger.py[line:35] INFO insert ReLU after conv5_block3_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.convolutional.DepthwiseConv2D object at 0x7f761049afd0>
2024-06-12 17:27:45,370 logger.py[line:35] INFO Converting output shape (None, 28, 20, 504) to actual shape [None, 28, 28, 512]
[DEBUG] Inserting layer: <keras.layers.wrappers.TimeDistributed object at 0x7f769df8cc50>
2024-06-12 17:27:45,890 logger.py[line:35] INFO Converting output shape (None, 7, 7, 2048) to actual shape [None, 7, 7, 2048]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ReLU object at 0x7f76102f1d90>
2024-06-12 17:27:45,904 logger.py[line:35] INFO Converting output shape (None, 7, 7, 512) to actual shape [None, 7, 7, 512]
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_NLAll')>, 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_NLAll')>}
2024-06-12 17:27:46,197 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 161/2170
The Configuration Coverage is: 359/2049
The NDims Coverage Is: 64/117
The DType Coverage Is: 64/354
The Shape Coverage Is: 130/295
The Input Coverage Is: 258/766
2024-06-12 17:27:48,453 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:27:52,330 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:27:56,453 logger.py[line:35] INFO 2.9.0
2024-06-12 17:27:58,057 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:28:07,968 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-NLAll42 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:28:09,697 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 17s
2024-06-12 17:28:09,697 logger.py[line:35] INFO loading the redis
2024-06-12 17:28:09,699 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:28:09,721 logger.py[line:35] INFO coverage_c=37204
time=21.08983612060547, cov_py=0, cov_c=37204
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-NLAll42
2024-06-12 17:28:14,012 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-NLAll42
2024-06-12 17:28:14,012 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:28:14,013 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:28:14,013 logger.py[line:35] INFO after_prediction
2024-06-12 17:28:14,013 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-NLAll42
2024-06-12 17:28:14,390 logger.py[line:35] INFO INFO: Mutation progress 44/100
2024-06-12 17:28:14,390 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:28:14,390 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:28:14,390 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:28:14,391 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:28:14,391 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:28:14,391 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:28:14,391 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:28:14,391 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:28:14,391 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:28:14,391 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:28:14,391 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:28:14,391 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MParam115-MDims31
2024-06-12 17:28:14,391 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:28:17,332 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:28:18,004 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 17:28:18,007 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll')>}
2024-06-12 17:28:18,201 logger.py[line:35] INFO Insert 1 out of 17 Global New Layers
2024-06-12 17:28:18,201 logger.py[line:35] INFO insert ConvLSTM2D after up_sampling3d_insert_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll
2024-06-12 17:28:18,204 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.convolutional_recurrent.ConvLSTM2D object at 0x7f3cb8792650>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 73, in new_layer_addition
    mylogger.info(f"Converting output shape {layer_input.shape} to actual shape {target_shape}")
AttributeError: 'list' object has no attribute 'shape'
2024-06-12 17:28:18,867 logger.py[line:35] INFO INFO: Mutation progress 44/100
2024-06-12 17:28:18,868 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:28:18,868 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:28:18,868 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:28:18,868 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:28:18,868 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:28:18,868 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:28:18,868 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:28:18,868 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:28:18,868 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:28:18,868 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:28:18,868 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:28:18,868 logger.py[line:35] INFO Choose seed: inception.resnet.v2-NLAll108-NLAll26-MDtype38-Edge41
2024-06-12 17:28:18,868 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:28:27,008 logger.py[line:35] INFO Generating model using MParam
model outputs {'predictions_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam')>, 'cropping2d': <KerasTensor: shape=(None, 10, 11, 48) dtype=float32 (created by layer 'cropping2d_copy_MParam')>, 'cropping2d_1': <KerasTensor: shape=(None, 11, 11, 192) dtype=float32 (created by layer 'cropping2d_1_copy_MParam')>, 'cropping2d_2': <KerasTensor: shape=(None, 10, 11, 32) dtype=float32 (created by layer 'cropping2d_2_copy_MParam')>, 'cropping1d': <KerasTensor: shape=(None, 10, 32) dtype=float32 (created by layer 'cropping1d_copy_MParam')>, 'cropping1d_1': <KerasTensor: shape=(None, 10, 192) dtype=float32 (created by layer 'cropping1d_1_copy_MParam')>, 'avg_pool_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 32) dtype=float32 (created by layer 'avg_pool_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2_copy_MParam')>, 'cropping2d_3': <KerasTensor: shape=(None, 10, 11, 32) dtype=float32 (created by layer 'cropping2d_3_copy_MParam')>, 'cropping1d_2': <KerasTensor: shape=(None, 10, 64) dtype=float32 (created by layer 'cropping1d_2_copy_MParam')>, 'max_pooling2d_2_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 17, 17, 192) dtype=float32 (created by layer 'max_pooling2d_2_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2_copy_MParam')>}
2024-06-12 17:28:31,396 logger.py[line:35] INFO Changing 3/15 of layer conv2d_124_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:28:31,396 logger.py[line:35] INFO changing config dilation_rate in layer conv2d_124_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from (1, 1) to [2, 3]
2024-06-12 17:28:31,396 logger.py[line:35] INFO changing config padding in layer conv2d_124_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from same to valid
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config kernel_regularizer in layer conv2d_124_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from None to l1
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config activity_regularizer in layer conv2d_124_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from None to l2
2024-06-12 17:28:31,397 logger.py[line:35] INFO Changing 3/15 of layer block35_6_conv_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config kernel_initializer in layer block35_6_conv_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}} to Orthogonal
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config activation in layer block35_6_conv_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from linear to hard_sigmoid
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config kernel_constraint in layer block35_6_conv_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from None to NonNeg
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config bias_regularizer in layer block35_6_conv_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from None to l2
2024-06-12 17:28:31,397 logger.py[line:35] INFO Changing 3/15 of layer conv2d_91_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config kernel_regularizer in layer conv2d_91_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from None to l1
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config dilation_rate in layer conv2d_91_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from (1, 1) to [2, 3]
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config bias_constraint in layer conv2d_91_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from None to UnitNorm
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config bias_initializer in layer conv2d_91_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from {'class_name': 'Zeros', 'config': {}} to lecun_uniform
2024-06-12 17:28:31,397 logger.py[line:35] INFO Changing 1/15 of layer conv2d_26_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config data_format in layer conv2d_26_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from channels_last to channels_first
2024-06-12 17:28:31,397 logger.py[line:35] INFO changing config kernel_initializer in layer conv2d_26_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}} to glorot_uniform
2024-06-12 17:28:31,397 logger.py[line:35] INFO Changing 1/15 of layer conv2d_130_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:28:31,398 logger.py[line:35] INFO changing config padding in layer conv2d_130_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from same to same
2024-06-12 17:28:31,398 logger.py[line:35] INFO changing config use_bias in layer conv2d_130_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from False to True
2024-06-12 17:28:31,398 logger.py[line:35] INFO Changing 1/5 of layer batch_normalization_169_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:28:31,398 logger.py[line:35] INFO changing config momentum in layer batch_normalization_169_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from 0.99 to 0.9132167181571526
2024-06-12 17:28:31,398 logger.py[line:35] INFO changing config scale in layer batch_normalization_169_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from False to True
2024-06-12 17:28:31,398 logger.py[line:35] INFO Changing 2/15 of layer block35_1_conv_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:28:31,398 logger.py[line:35] INFO changing config padding in layer block35_1_conv_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from same to valid
2024-06-12 17:28:31,399 logger.py[line:35] INFO changing config data_format in layer block35_1_conv_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from channels_last to channels_first
2024-06-12 17:28:31,399 logger.py[line:35] INFO changing config use_bias in layer block35_1_conv_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam: from True to True
2024-06-12 17:28:31,399 logger.py[line:35] INFO Changing 3/4 of layer average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2_copy_MParam's configuration
2024-06-12 17:28:31,399 logger.py[line:35] INFO changing config strides in layer average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2_copy_MParam: from (1, 1) to None
2024-06-12 17:28:31,399 logger.py[line:35] INFO changing config data_format in layer average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2_copy_MParam: from channels_last to channels_first
2024-06-12 17:28:31,399 logger.py[line:35] INFO changing config padding in layer average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2_copy_MParam: from same to same
2024-06-12 17:28:31,399 logger.py[line:35] INFO changing config pool_size in layer average_pooling2d_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_2_copy_MParam: from (3, 3) to [8, 7]
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 82, in generate_model_by_model_mutation
    architecture_measure=architecture_measure, max_layer_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 283, in mutate_param
    new_model = utils.ModelUtils.functional_model_operation(MParam_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 101, in functional_model_operation
    x = cloned_layer(layer_input_tensors)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "inception_resnet_v2.py", line 319, in <lambda>
ValueError: Exception encountered when calling layer "block35_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam" (type Lambda).

Dimensions must be equal, but are 35 and 320 for '{{node block35_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam/add}} = AddV2[T=DT_FLOAT](Placeholder, block35_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_Edge_copy_MParam/mul)' with input shapes: [?,35,35,320], [?,320,35,128].

Call arguments received:
  • inputs=['tf.Tensor(shape=(None, 35, 35, 320), dtype=float32)', 'tf.Tensor(shape=(None, 320, 35, 128), dtype=float32)']
  • mask=None
  • training=None
2024-06-12 17:28:32,408 logger.py[line:35] INFO INFO: Mutation progress 44/100
2024-06-12 17:28:32,408 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:28:32,409 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:28:32,409 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:28:32,409 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:28:32,409 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:28:32,409 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:28:32,409 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:28:32,409 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:28:32,409 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:28:32,409 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 17:28:32,409 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:28:32,409 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge6-Edge27
2024-06-12 17:28:32,409 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:28:37,222 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_copy_MDims')>, 'cropping2d_copy_Edge': <KerasTensor: shape=(None, 11, 10, 128) dtype=float32 (created by layer 'cropping2d_copy_Edge_copy_MDims')>, 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_2': <KerasTensor: shape=(None, 13, 13, 512) dtype=float16 (created by layer 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_2_copy_MDims')>, 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_2': <KerasTensor: shape=(None, 1017) dtype=float32 (created by layer 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_2_copy_MDims')>, 'cropping2d': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_MDims')>, 'softmax_insert_copy_Edge_copy_Edge_2': <KerasTensor: shape=(None, 2, 50) dtype=float32 (created by layer 'softmax_insert_copy_Edge_copy_Edge_2_copy_MDims')>, 'cropping2d_1': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'cropping2d_1_copy_MDims')>, 'cropping2d_2': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_2_copy_MDims')>, 'cropping1d': <KerasTensor: shape=(None, 10, 2038) dtype=float32 (created by layer 'cropping1d_copy_MDims')>, 'cropping2d_3': <KerasTensor: shape=(None, 11, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_MDims')>, 'cropping2d_4': <KerasTensor: shape=(None, 10, 10, 1024) dtype=float32 (created by layer 'cropping2d_4_copy_MDims')>}
2024-06-12 17:28:38,413 logger.py[line:35] INFO Change 2 Layer's Dimension Out Of 7 Layer classes
2024-06-12 17:28:38,413 logger.py[line:35] INFO Global Layer Class: 6; Local Layer Class: 1; Total Layer Class: 7
2024-06-12 17:28:38,413 logger.py[line:35] INFO Changing 2 out of 6 Layer's NDims.
2024-06-12 17:28:38,414 logger.py[line:35] INFO Selecting a Global NDims 6 For Layer activity_regularization_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_copy_MDims
2024-06-12 17:28:38,415 logger.py[line:35] INFO Selecting a Global NDims 2 For Layer p_re_lu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_Edge_copy_MDims
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 88, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dims(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 377, in mutate_dims
    new_model = InputMutationUtils.mdims(MDims_model, selected_layer_ndims_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 349, in mdims
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 340, in mdims_layer_addition
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/advanced_activations.py", line 147, in build
    param_shape[i - 1] = 1
IndexError: list assignment index out of range
2024-06-12 17:28:39,597 logger.py[line:35] INFO INFO: Mutation progress 44/100
2024-06-12 17:28:39,597 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:28:39,597 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:28:39,597 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:28:39,597 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:28:39,597 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:28:39,597 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:28:39,597 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:28:39,597 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:28:39,597 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:28:39,597 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:28:39,598 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:28:39,598 logger.py[line:35] INFO Choose seed: mobilenet.v2-MParam43
2024-06-12 17:28:39,598 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:28:43,643 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype')>}
2024-06-12 17:28:44,491 logger.py[line:35] INFO Change 1 Layer's DType Out Of 6 Layer classes
2024-06-12 17:28:44,491 logger.py[line:35] INFO Changing 1 out of 6 Layer's DType.
2024-06-12 17:28:44,492 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer block_3_expand_BN_copy_MParam_copy_MDtype
model outputs {'predictions_copy_MParam_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype')>}
2024-06-12 17:28:45,352 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 167/2170
The Configuration Coverage is: 379/2049
The NDims Coverage Is: 64/117
The DType Coverage Is: 65/354
The Shape Coverage Is: 136/295
The Input Coverage Is: 265/766
2024-06-12 17:28:47,071 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:28:50,940 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:28:55,069 logger.py[line:35] INFO 2.9.0
2024-06-12 17:28:56,659 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 230, in <module>
    predictor.predict()
  File "/root/implementations/scripts/prediction/predict_model.py", line 167, in predict
    pred = self.model.predict(self.input)
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/tensorflow/python/eager/execute.py", line 55, in quick_execute
    inputs, attrs, num_outputs)
tensorflow.python.framework.errors_impl.InternalError: Graph execution error:

Detected at node 'mobilenet.v2-MParam43-MDtype43/block_3_expand_BN_copy_MParam_copy_MDtype/FusedBatchNormV3' defined at (most recent call last):
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 193, in _run_module_as_main
      "__main__", mod_spec)
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 85, in _run_code
      exec(code, run_globals)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/__main__.py", line 8, in <module>
      sys.exit(main())
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 871, in main
      status = CoverageScript().command_line(argv)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 588, in command_line
      return self.do_run(options, args)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 746, in do_run
      runner.run()
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/execfile.py", line 247, in run
      exec(code, main_mod.__dict__)
    File "/root/implementations/scripts/prediction/predict_model.py", line 230, in <module>
      predictor.predict()
    File "/root/implementations/scripts/prediction/predict_model.py", line 167, in predict
      pred = self.model.predict(self.input)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1982, in predict
      tmp_batch_outputs = self.predict_function(iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1801, in predict_function
      return step_function(self, iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1790, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1783, in run_step
      outputs = model.predict_step(data)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1751, in predict_step
      return self(x, training=False)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 452, in call
      inputs, training=training, mask=mask)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 589, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 767, in call
      outputs = self._fused_batch_norm(inputs, training=training)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 624, in _fused_batch_norm
      training, train_op, _fused_batch_norm_inference)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/control_flow_util.py", line 106, in smart_cond
      pred, true_fn=true_fn, false_fn=false_fn, name=name)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 613, in _fused_batch_norm_inference
      data_format=self._data_format)
Node: 'mobilenet.v2-MParam43-MDtype43/block_3_expand_BN_copy_MParam_copy_MDtype/FusedBatchNormV3'
Detected at node 'mobilenet.v2-MParam43-MDtype43/block_3_expand_BN_copy_MParam_copy_MDtype/FusedBatchNormV3' defined at (most recent call last):
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 193, in _run_module_as_main
      "__main__", mod_spec)
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 85, in _run_code
      exec(code, run_globals)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/__main__.py", line 8, in <module>
      sys.exit(main())
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 871, in main
      status = CoverageScript().command_line(argv)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 588, in command_line
      return self.do_run(options, args)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 746, in do_run
      runner.run()
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/execfile.py", line 247, in run
      exec(code, main_mod.__dict__)
    File "/root/implementations/scripts/prediction/predict_model.py", line 230, in <module>
      predictor.predict()
    File "/root/implementations/scripts/prediction/predict_model.py", line 167, in predict
      pred = self.model.predict(self.input)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1982, in predict
      tmp_batch_outputs = self.predict_function(iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1801, in predict_function
      return step_function(self, iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1790, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1783, in run_step
      outputs = model.predict_step(data)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1751, in predict_step
      return self(x, training=False)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 452, in call
      inputs, training=training, mask=mask)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 589, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 767, in call
      outputs = self._fused_batch_norm(inputs, training=training)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 624, in _fused_batch_norm
      training, train_op, _fused_batch_norm_inference)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/control_flow_util.py", line 106, in smart_cond
      pred, true_fn=true_fn, false_fn=false_fn, name=name)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 613, in _fused_batch_norm_inference
      data_format=self._data_format)
Node: 'mobilenet.v2-MParam43-MDtype43/block_3_expand_BN_copy_MParam_copy_MDtype/FusedBatchNormV3'
2 root error(s) found.
  (0) INTERNAL:  Missing 0-th output from {{node mobilenet.v2-MParam43-MDtype43/block_3_expand_BN_copy_MParam_copy_MDtype/FusedBatchNormV3}}
	 [[mobilenet.v2-MParam43-MDtype43/block_3_expand_BN_copy_MParam_copy_MDtype/FusedBatchNormV3/_14]]
  (1) INTERNAL:  Missing 0-th output from {{node mobilenet.v2-MParam43-MDtype43/block_3_expand_BN_copy_MParam_copy_MDtype/FusedBatchNormV3}}
0 successful operations.
0 derived errors ignored. [Op:__inference_predict_function_4213]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 235, in <module>
    raise ValueError(f"CRASH ON BACKEND {flags.backend}!!!")
ValueError: CRASH ON BACKEND tensorflow!!!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:29:06,107 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 15s
2024-06-12 17:29:06,107 logger.py[line:35] INFO mobilenet.v2-MParam43-MDtype43 crash on backend tensorflow when predicting
2024-06-12 17:29:06,129 logger.py[line:35] INFO coverage_c=37243
time=18.881269693374634, cov_py=0, cov_c=37243
New test requirements invoked on framework tensorflow when updating mobilenet.v2-MParam43-MDtype43
2024-06-12 17:29:10,225 logger.py[line:35] INFO Fail on backend: tensorflow of model mobilenet.v2-MParam43-MDtype43
2024-06-12 17:29:10,225 logger.py[line:35] INFO Error: Move Crash model
2024-06-12 17:29:10,225 logger.py[line:35] INFO after_prediction
2024-06-12 17:29:10,539 logger.py[line:35] INFO INFO: Mutation progress 45/100
2024-06-12 17:29:10,539 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:29:10,539 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:29:10,539 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:29:10,539 logger.py[line:35] INFO Score for MDtype is: 0.8777777777777778
2024-06-12 17:29:10,539 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:29:10,539 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:29:10,539 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:29:10,539 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:29:10,539 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:29:10,539 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:29:10,539 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:29:10,539 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35
2024-06-12 17:29:10,540 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:29:13,444 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:29:13,459 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:29:14,260 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 17:29:14,263 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:29:14,440 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2': <KerasTensor: shape=(None, 1, 9, 9, 225) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll')>, 'cropping2d': <KerasTensor: shape=(None, 11, 11, 225) dtype=float32 (created by layer 'cropping2d_copy_NLAll')>, 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2': <KerasTensor: shape=(None, 25) dtype=float32 (created by layer 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll')>, 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll')>}
2024-06-12 17:29:14,582 logger.py[line:35] INFO Insert 3 out of 16 Global New Layers
2024-06-12 17:29:14,583 logger.py[line:35] INFO insert SpatialDropout1D after repeat_vector_insert_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll
2024-06-12 17:29:14,583 logger.py[line:35] INFO insert AveragePooling3D after up_sampling3d_insert_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll
2024-06-12 17:29:14,583 logger.py[line:35] INFO insert Conv3D after gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll
2024-06-12 17:29:14,586 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.pooling.AveragePooling3D object at 0x7f39804a33d0>
2024-06-12 17:29:14,708 logger.py[line:35] INFO Converting output shape (None, 1, 9, 9, 225) to actual shape [None, 1, 9, 9, 225]
[DEBUG] Inserting layer: <keras.layers.convolutional.Conv3D object at 0x7f39804b1390>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 65, in new_layer_addition
    y = layer(layer_input)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/initializers/initializers_v2.py", line 674, in __call__
    'Identity matrix initializer can only be used for 2D matrices. '
ValueError: Identity matrix initializer can only be used for 2D matrices. Received: shape=(225,) of rank 1.
2024-06-12 17:29:15,226 logger.py[line:35] INFO INFO: Mutation progress 45/100
2024-06-12 17:29:15,227 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:29:15,227 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:29:15,227 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:29:15,227 logger.py[line:35] INFO Score for MDtype is: 0.8777777777777778
2024-06-12 17:29:15,227 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:29:15,227 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:29:15,227 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:29:15,227 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:29:15,227 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:29:15,227 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:29:15,227 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:29:15,227 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120-MDtype126-MDims5
2024-06-12 17:29:15,227 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:29:18,751 logger.py[line:35] INFO Generating model using MParam
model outputs {'dense_3_copy_SpecialI_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam')>}
2024-06-12 17:29:18,869 logger.py[line:35] INFO Changing 1/1 of layer flatten_1_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam's configuration
2024-06-12 17:29:18,870 logger.py[line:35] INFO changing config data_format in layer flatten_1_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam: from channels_last to channels_first
2024-06-12 17:29:18,870 logger.py[line:35] INFO Changing 1/4 of layer max_pooling2d_2_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam's configuration
2024-06-12 17:29:18,870 logger.py[line:35] INFO changing config data_format in layer max_pooling2d_2_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam: from channels_last to channels_first
2024-06-12 17:29:18,870 logger.py[line:35] INFO changing config strides in layer max_pooling2d_2_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam: from (2, 2) to None
2024-06-12 17:29:18,870 logger.py[line:35] INFO Changing 3/15 of layer conv2d_2_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam's configuration
2024-06-12 17:29:18,870 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 17:29:18,870 logger.py[line:35] INFO changing config use_bias in layer conv2d_2_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam: from True to True
2024-06-12 17:29:18,870 logger.py[line:35] INFO changing config activity_regularizer in layer conv2d_2_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam: from None to l2
2024-06-12 17:29:18,870 logger.py[line:35] INFO changing config bias_constraint in layer conv2d_2_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam: from None to MaxNorm
2024-06-12 17:29:18,870 logger.py[line:35] INFO changing config data_format in layer conv2d_2_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam: from channels_last to channels_first
2024-06-12 17:29:18,870 logger.py[line:35] INFO Changing 1/5 of layer batch_normalization_3_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam's configuration
2024-06-12 17:29:18,871 logger.py[line:35] INFO changing config scale in layer batch_normalization_3_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam: from True to False
2024-06-12 17:29:18,871 logger.py[line:35] INFO changing config center in layer batch_normalization_3_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam: from True to False
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 82, in generate_model_by_model_mutation
    architecture_measure=architecture_measure, max_layer_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 283, in mutate_param
    new_model = utils.ModelUtils.functional_model_operation(MParam_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 101, in functional_model_operation
    x = cloned_layer(layer_input_tensors)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1939, in _create_c_op
    raise ValueError(e.message)
ValueError: Exception encountered when calling layer "max_pooling2d_3_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam" (type MaxPooling2D).

Negative dimension size caused by subtracting 3 from 2 for '{{node max_pooling2d_3_copy_SpecialI_copy_MDtype_copy_MDims_copy_MParam/MaxPool}} = MaxPool[T=DT_DOUBLE, data_format="NHWC", explicit_paddings=[], ksize=[1, 3, 3, 1], padding="VALID", strides=[1, 2, 2, 1]](Placeholder)' with input shapes: [?,256,2,256].

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 256, 2, 256), dtype=float64)
2024-06-12 17:29:19,360 logger.py[line:35] INFO INFO: Mutation progress 45/100
2024-06-12 17:29:19,360 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:29:19,360 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:29:19,360 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:29:19,360 logger.py[line:35] INFO Score for MDtype is: 0.8777777777777778
2024-06-12 17:29:19,360 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:29:19,360 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:29:19,360 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:29:19,360 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:29:19,360 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:29:19,360 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 17:29:19,361 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:29:19,361 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29
2024-06-12 17:29:19,361 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:29:23,772 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDims')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDims')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDims')>, 'cropping2d_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDims')>, 'cropping2d_1_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDims')>, 'cropping2d_2_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDims')>, 'cropping2d_3_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDims')>, 'cropping2d_4_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDims')>, 'cropping2d_5_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDims')>, 'cropping2d_6_copy_SpecialI': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDims')>}
2024-06-12 17:29:24,818 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:29:24,818 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:29:24,818 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:29:24,819 logger.py[line:35] INFO Selecting a Global NDims 3 For Layer conv2_block1_0_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDims
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 88, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dims(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 377, in mutate_dims
    new_model = InputMutationUtils.mdims(MDims_model, selected_layer_ndims_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 349, in mdims
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 340, in mdims_layer_addition
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 313, in build
    f'Invalid axis. Expected 0 <= axis < inputs.rank (with '
ValueError: Invalid axis. Expected 0 <= axis < inputs.rank (with inputs.rank=3). Received: layer.axis=ListWrapper([3])
2024-06-12 17:29:25,580 logger.py[line:35] INFO INFO: Mutation progress 45/100
2024-06-12 17:29:25,580 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:29:25,580 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:29:25,580 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:29:25,580 logger.py[line:35] INFO Score for MDtype is: 0.8777777777777778
2024-06-12 17:29:25,580 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:29:25,580 logger.py[line:35] INFO Score for MDims is: 0.8571428571428571
2024-06-12 17:29:25,580 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:29:25,580 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:29:25,580 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:29:25,580 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:29:25,580 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:29:25,580 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120
2024-06-12 17:29:25,580 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:29:28,975 logger.py[line:35] INFO Generating model using MDims
model outputs {'dense_3_copy_SpecialI': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims')>}
2024-06-12 17:29:29,067 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 3 Layer classes
2024-06-12 17:29:29,067 logger.py[line:35] INFO Global Layer Class: 2; Local Layer Class: 1; Total Layer Class: 3
2024-06-12 17:29:29,067 logger.py[line:35] INFO Changing 1 out of 2 Layer's NDims.
2024-06-12 17:29:29,068 logger.py[line:35] INFO Selecting a Global NDims 6 For Layer flatten_1_copy_SpecialI_copy_MDims
model outputs {'dense_3_copy_SpecialI_copy_MDims': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims')>}
2024-06-12 17:29:29,202 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 167/2170
The Configuration Coverage is: 379/2049
The NDims Coverage Is: 65/117
The DType Coverage Is: 65/354
The Shape Coverage Is: 136/295
The Input Coverage Is: 266/766
2024-06-12 17:29:29,984 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:29:33,819 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:29:37,847 logger.py[line:35] INFO 2.9.0
2024-06-12 17:29:39,412 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:29:43,491 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-SpecialI120-MDims44 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:29:45,079 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 17:29:45,079 logger.py[line:35] INFO loading the redis
2024-06-12 17:29:45,082 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:29:45,104 logger.py[line:35] INFO coverage_c=37243
time=14.946398496627808, cov_py=0, cov_c=37243
New test requirements invoked on framework tensorflow when updating alexnet-SpecialI120-MDims44
2024-06-12 17:29:49,288 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-SpecialI120-MDims44
2024-06-12 17:29:49,288 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:29:49,288 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:29:49,288 logger.py[line:35] INFO after_prediction
2024-06-12 17:29:49,288 logger.py[line:35] INFO New representative seed found: alexnet-SpecialI120-MDims44
2024-06-12 17:29:49,593 logger.py[line:35] INFO INFO: Mutation progress 46/100
2024-06-12 17:29:49,593 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:29:49,593 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:29:49,593 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:29:49,593 logger.py[line:35] INFO Score for MDtype is: 0.8777777777777778
2024-06-12 17:29:49,593 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:29:49,593 logger.py[line:35] INFO Score for MDims is: 0.8620689655172413
2024-06-12 17:29:49,593 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:29:49,593 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:29:49,593 logger.py[line:35] INFO Score for SpecialI is: 0.6428571428571429
2024-06-12 17:29:49,593 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:29:49,593 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:29:49,593 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-NLAll124-MDtype128
2024-06-12 17:29:49,594 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:29:52,527 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:29:53,321 logger.py[line:35] INFO Generating model using SpecialI
2024-06-12 17:29:53,324 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI')>}
2024-06-12 17:29:53,543 logger.py[line:35] INFO Change Input Of Layer: custom_crop_layer_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI To: 0.0
2024-06-12 17:29:53,546 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI')>}
2024-06-12 17:29:53,784 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:29:54,471 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 167/2170
The Configuration Coverage is: 379/2049
The NDims Coverage Is: 65/117
The DType Coverage Is: 65/354
The Shape Coverage Is: 136/295
The Input Coverage Is: 266/766
2024-06-12 17:29:54,711 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:29:58,616 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:30:02,609 logger.py[line:35] INFO 2.9.0
2024-06-12 17:30:04,179 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:30:09,545 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-NLAll54-NLAll124-MDtype128-SpecialI45 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:30:11,628 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 13s
2024-06-12 17:30:11,628 logger.py[line:35] INFO loading the redis
2024-06-12 17:30:11,631 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:30:11,653 logger.py[line:35] INFO coverage_c=37273
time=16.76852536201477, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-NLAll124-MDtype128-SpecialI45
2024-06-12 17:30:15,964 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-NLAll54-NLAll124-MDtype128-SpecialI45
2024-06-12 17:30:15,964 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:30:15,964 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:30:15,964 logger.py[line:35] INFO after_prediction
2024-06-12 17:30:15,964 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-NLAll54-NLAll124-MDtype128-SpecialI45
2024-06-12 17:30:16,281 logger.py[line:35] INFO INFO: Mutation progress 47/100
2024-06-12 17:30:16,281 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:30:16,281 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:30:16,281 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:30:16,281 logger.py[line:35] INFO Score for MDtype is: 0.8777777777777778
2024-06-12 17:30:16,281 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:30:16,281 logger.py[line:35] INFO Score for MDims is: 0.8620689655172413
2024-06-12 17:30:16,281 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:30:16,282 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:30:16,282 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:30:16,282 logger.py[line:35] INFO The last used seed is: SpecialI
2024-06-12 17:30:16,282 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:30:16,282 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113
2024-06-12 17:30:16,282 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:30:19,224 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:30:19,922 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:30:19,927 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype')>}
2024-06-12 17:30:20,075 logger.py[line:35] INFO Change 2 Layer's DType Out Of 4 Layer classes
2024-06-12 17:30:20,075 logger.py[line:35] INFO Changing 2 out of 4 Layer's DType.
2024-06-12 17:30:20,076 logger.py[line:35] INFO Selecting a Global DType float32 For Layer repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype
2024-06-12 17:30:20,076 logger.py[line:35] INFO Selecting a Global DType float16 For Layer dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype
2024-06-12 17:30:20,080 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype')>}
2024-06-12 17:30:20,253 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:30:20,863 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 167/2170
The Configuration Coverage is: 379/2049
The NDims Coverage Is: 65/117
The DType Coverage Is: 65/354
The Shape Coverage Is: 136/295
The Input Coverage Is: 266/766
2024-06-12 17:30:21,039 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:30:25,175 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:30:29,165 logger.py[line:35] INFO 2.9.0
2024-06-12 17:30:30,736 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:30:33,431 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MDtype113-MDtype46 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:30:34,583 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:30:34,583 logger.py[line:35] INFO loading the redis
2024-06-12 17:30:34,586 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:30:34,614 logger.py[line:35] INFO coverage_c=37273
time=13.40181589126587, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MDtype113-MDtype46
2024-06-12 17:30:38,886 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MDtype113-MDtype46
2024-06-12 17:30:38,887 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:30:38,887 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:30:38,887 logger.py[line:35] INFO after_prediction
2024-06-12 17:30:38,887 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MDtype113-MDtype46
2024-06-12 17:30:39,208 logger.py[line:35] INFO INFO: Mutation progress 48/100
2024-06-12 17:30:39,208 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:30:39,208 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:30:39,208 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:30:39,209 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:30:39,209 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:30:39,209 logger.py[line:35] INFO Score for MDims is: 0.8620689655172413
2024-06-12 17:30:39,209 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:30:39,209 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:30:39,209 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:30:39,209 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:30:39,209 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:30:39,209 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120
2024-06-12 17:30:39,209 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:30:42,560 logger.py[line:35] INFO Generating model using LMerg
model outputs {'dense_3_copy_SpecialI': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:30:42,652 logger.py[line:35] INFO Insert 2 out of 8 Local New Layer
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 72, in generate_model_by_model_mutation
    return InteractionMutationUtils.merge_layers(model=model, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 165, in merge_layers
    assert len(selected_layer_name_list) == 1
AssertionError
2024-06-12 17:30:43,076 logger.py[line:35] INFO INFO: Mutation progress 48/100
2024-06-12 17:30:43,077 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:30:43,077 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:30:43,077 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:30:43,077 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:30:43,077 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:30:43,077 logger.py[line:35] INFO Score for MDims is: 0.8620689655172413
2024-06-12 17:30:43,077 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:30:43,077 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:30:43,077 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:30:43,077 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:30:43,077 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:30:43,077 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-LMerg10-NLAll92-MDtype98
2024-06-12 17:30:43,077 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:30:47,331 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MDims')>}
2024-06-12 17:30:48,308 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 2 Layer classes
2024-06-12 17:30:48,309 logger.py[line:35] INFO Global Layer Class: 2; Local Layer Class: 0; Total Layer Class: 2
2024-06-12 17:30:48,309 logger.py[line:35] INFO Changing 1 out of 2 Layer's NDims.
2024-06-12 17:30:48,310 logger.py[line:35] INFO Selecting a Global NDims 3 For Layer time_distributed_insert_copy_MDtype_copy_MDims
model outputs {'predictions_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_NLAll_copy_MDtype_copy_MDims')>}
2024-06-12 17:30:49,405 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 167/2170
The Configuration Coverage is: 379/2049
The NDims Coverage Is: 66/117
The DType Coverage Is: 65/354
The Shape Coverage Is: 137/295
The Input Coverage Is: 268/766
2024-06-12 17:30:51,412 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:30:55,282 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:30:59,425 logger.py[line:35] INFO 2.9.0
2024-06-12 17:31:01,013 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:31:09,764 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-LMerg10-NLAll92-MDtype98-MDims47 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:31:11,498 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:31:11,498 logger.py[line:35] INFO loading the redis
2024-06-12 17:31:11,501 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:31:11,523 logger.py[line:35] INFO coverage_c=37273
time=19.931568384170532, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-LMerg10-NLAll92-MDtype98-MDims47
2024-06-12 17:31:15,701 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-LMerg10-NLAll92-MDtype98-MDims47
2024-06-12 17:31:15,701 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:31:15,701 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:31:15,701 logger.py[line:35] INFO after_prediction
2024-06-12 17:31:15,701 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-LMerg10-NLAll92-MDtype98-MDims47
2024-06-12 17:31:16,081 logger.py[line:35] INFO INFO: Mutation progress 49/100
2024-06-12 17:31:16,082 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:31:16,082 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:31:16,082 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:31:16,082 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:31:16,082 logger.py[line:35] INFO Score for MDims is: 0.8666666666666667
2024-06-12 17:31:16,082 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:31:16,082 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:31:16,082 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:31:16,082 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:31:16,082 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:31:16,082 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:31:16,082 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MParam115
2024-06-12 17:31:16,082 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:31:19,025 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:31:19,678 logger.py[line:35] INFO Generating model using MDims
2024-06-12 17:31:19,681 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims')>}
2024-06-12 17:31:19,822 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:31:19,822 logger.py[line:35] INFO Global Layer Class: 0; Local Layer Class: 1; Total Layer Class: 1
2024-06-12 17:31:19,822 logger.py[line:35] INFO Changing 0 Layer's NDims.
2024-06-12 17:31:19,822 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:31:19,822 logger.py[line:35] INFO No Global NDims Can Be Found, Randomly Select NDims: 4 For Layer: dropout_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims
2024-06-12 17:31:19,825 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims')>}
2024-06-12 17:31:19,988 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:31:20,588 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 167/2170
The Configuration Coverage is: 379/2049
The NDims Coverage Is: 66/117
The DType Coverage Is: 65/354
The Shape Coverage Is: 137/295
The Input Coverage Is: 268/766
2024-06-12 17:31:20,755 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:31:24,586 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:31:28,598 logger.py[line:35] INFO 2.9.0
2024-06-12 17:31:30,179 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:31:32,738 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MParam115-MDims48 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:31:33,944 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:31:33,944 logger.py[line:35] INFO loading the redis
2024-06-12 17:31:33,947 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:31:33,968 logger.py[line:35] INFO coverage_c=37273
time=13.040101766586304, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MParam115-MDims48
2024-06-12 17:31:38,188 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MParam115-MDims48
2024-06-12 17:31:38,189 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:31:38,189 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:31:38,189 logger.py[line:35] INFO after_prediction
2024-06-12 17:31:38,189 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MParam115-MDims48
2024-06-12 17:31:38,494 logger.py[line:35] INFO INFO: Mutation progress 50/100
2024-06-12 17:31:38,494 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:31:38,494 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:31:38,494 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:31:38,494 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:31:38,494 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:31:38,494 logger.py[line:35] INFO Score for MDims is: 0.8548387096774194
2024-06-12 17:31:38,494 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:31:38,494 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:31:38,494 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:31:38,494 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:31:38,495 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:31:38,495 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-Edge7
2024-06-12 17:31:38,495 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:31:42,884 logger.py[line:35] INFO Generating model using MParam
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam')>, 'cropping2d': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_MParam')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 3) dtype=float64 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2_copy_MParam')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2': <KerasTensor: shape=(None, 64) dtype=float64 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2_copy_MParam')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_1_2': <KerasTensor: shape=(None, 64) dtype=float64 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_1_2_copy_MParam')>, 'cropping2d_1': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_1_copy_MParam')>, 'conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2': <KerasTensor: shape=(None, 20, 20, 256) dtype=float32 (created by layer 'conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2_copy_MParam')>, 'conv5_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 14, 14, 256) dtype=float32 (created by layer 'conv5_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2_copy_MParam')>, 'cropping2d_2': <KerasTensor: shape=(None, 11, 11, 64) dtype=float32 (created by layer 'cropping2d_2_copy_MParam')>}
2024-06-12 17:31:43,925 logger.py[line:35] INFO Changing 1/5 of layer conv5_block2_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:31:43,925 logger.py[line:35] INFO changing config axis in layer conv5_block2_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from ListWrapper([3]) to -1
2024-06-12 17:31:43,925 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 17:31:43,925 logger.py[line:35] INFO changing config center in layer conv5_block2_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from True to False
2024-06-12 17:31:43,925 logger.py[line:35] INFO Changing 3/15 of layer conv5_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:31:43,925 logger.py[line:35] INFO changing config bias_regularizer in layer conv5_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from None to l1
2024-06-12 17:31:43,925 logger.py[line:35] INFO changing config padding in layer conv5_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from valid to valid
2024-06-12 17:31:43,926 logger.py[line:35] INFO changing config kernel_initializer in layer conv5_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}} to Identity
2024-06-12 17:31:43,926 logger.py[line:35] INFO changing config use_bias in layer conv5_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from True to True
2024-06-12 17:31:43,926 logger.py[line:35] INFO Changing 3/15 of layer conv3_block1_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:31:43,926 logger.py[line:35] INFO changing config padding in layer conv3_block1_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from same to same
2024-06-12 17:31:43,926 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 17:31:43,926 logger.py[line:35] INFO changing config activation in layer conv3_block1_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from linear to exponential
2024-06-12 17:31:43,926 logger.py[line:35] INFO changing config dilation_rate in layer conv3_block1_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from (1, 1) to [2, 3]
2024-06-12 17:31:43,926 logger.py[line:35] INFO changing config kernel_regularizer in layer conv3_block1_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from None to l1
2024-06-12 17:31:43,926 logger.py[line:35] INFO Changing 1/5 of layer conv2_block1_0_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:31:43,927 logger.py[line:35] INFO changing config center in layer conv2_block1_0_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from True to False
2024-06-12 17:31:43,927 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 17:31:43,927 logger.py[line:35] INFO changing config scale in layer conv2_block1_0_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from True to False
2024-06-12 17:31:43,927 logger.py[line:35] INFO Changing 3/5 of layer conv3_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam's configuration
2024-06-12 17:31:43,927 logger.py[line:35] INFO changing config center in layer conv3_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from True to False
2024-06-12 17:31:43,927 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 17:31:43,927 logger.py[line:35] INFO changing config scale in layer conv3_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from True to True
2024-06-12 17:31:43,927 logger.py[line:35] INFO changing config momentum in layer conv3_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from 0.99 to 0.138227115272627
2024-06-12 17:31:43,927 logger.py[line:35] INFO changing config axis in layer conv3_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MParam: from ListWrapper([3]) to -1
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 82, in generate_model_by_model_mutation
    architecture_measure=architecture_measure, max_layer_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 283, in mutate_param
    new_model = utils.ModelUtils.functional_model_operation(MParam_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 276, in change_layer_config
    x = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/initializers/initializers_v2.py", line 674, in __call__
    'Identity matrix initializer can only be used for 2D matrices. '
ValueError: Identity matrix initializer can only be used for 2D matrices. Received: shape=(1, 1, 2048, 512) of rank 4.
2024-06-12 17:31:45,376 logger.py[line:35] INFO INFO: Mutation progress 50/100
2024-06-12 17:31:45,376 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:31:45,376 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:31:45,376 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:31:45,376 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:31:45,376 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:31:45,376 logger.py[line:35] INFO Score for MDims is: 0.8548387096774194
2024-06-12 17:31:45,376 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:31:45,376 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:31:45,376 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:31:45,376 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 17:31:45,376 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:31:45,376 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-LMerg10
2024-06-12 17:31:45,376 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:31:49,542 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_NLAll')>}
2024-06-12 17:31:50,763 logger.py[line:35] INFO Insert 10 out of 23 Local New Layers
2024-06-12 17:31:50,764 logger.py[line:35] INFO insert LocallyConnected2D after pool1_pad_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,764 logger.py[line:35] INFO insert LayerNormalization after conv3_block1_1_conv_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,764 logger.py[line:35] INFO insert SpatialDropout2D after conv2_block2_2_conv_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,764 logger.py[line:35] INFO insert GlobalMaxPooling2D after pool1_pool_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,764 logger.py[line:35] INFO insert LeakyReLU after conv4_block5_1_bn_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,764 logger.py[line:35] INFO insert DepthwiseConv2D after pool1_pool_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,764 logger.py[line:35] INFO insert AveragePooling2D after conv3_block4_3_bn_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,764 logger.py[line:35] INFO insert AlphaDropout after pool1_pad_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,764 logger.py[line:35] INFO insert ConvLSTM1D after pool1_pad_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,765 logger.py[line:35] INFO insert GaussianNoise after conv2_block1_0_bn_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,765 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 3
2024-06-12 17:31:50,768 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [3]
2024-06-12 17:31:50,768 logger.py[line:35] INFO insert SpatialDropout1D after conv2_block1_0_conv_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,772 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [3]
2024-06-12 17:31:50,772 logger.py[line:35] INFO insert Cropping1D after conv4_block4_3_bn_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:31:50,776 logger.py[line:35] INFO insert SpatialDropout2D after conv4_block4_add_copy_LMerg_copy_LMerg_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.convolutional_recurrent.ConvLSTM1D object at 0x7f8a563cdd10>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 73, in new_layer_addition
    mylogger.info(f"Converting output shape {layer_input.shape} to actual shape {target_shape}")
AttributeError: 'list' object has no attribute 'shape'
2024-06-12 17:31:51,577 logger.py[line:35] INFO INFO: Mutation progress 50/100
2024-06-12 17:31:51,577 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:31:51,577 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:31:51,577 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:31:51,577 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:31:51,577 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:31:51,577 logger.py[line:35] INFO Score for MDims is: 0.8548387096774194
2024-06-12 17:31:51,577 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:31:51,577 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:31:51,577 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:31:51,577 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:31:51,578 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:31:51,578 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113-MDtype46
2024-06-12 17:31:51,578 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:31:54,520 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:31:55,216 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:31:55,220 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>}
2024-06-12 17:31:55,376 logger.py[line:35] INFO Change 1 Layer's DType Out Of 4 Layer classes
2024-06-12 17:31:55,376 logger.py[line:35] INFO Changing 1 out of 4 Layer's DType.
2024-06-12 17:31:55,376 logger.py[line:35] INFO Selecting a Global DType double For Layer dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype
2024-06-12 17:31:55,380 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 91, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dtype(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 426, in mutate_dtype
    new_model = utils.ModelUtils.functional_model_operation(MDtype_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 101, in functional_model_operation
    x = cloned_layer(layer_input_tensors)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/autograph/impl/api.py", line 699, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: Exception encountered when calling layer "custom_cast_layer_copy_MDtype" (type CustomCastLayer).

in user code:

    File "/root/implementations/scripts/generation/custom_layers.py", line 24, in call  *
        output = tf.cast(inputs, self.target_dtype)

    ValueError: Shapes must be equal rank, but are 3 and 2
    	From merging shape 0 with other shapes. for '{{node custom_cast_layer_copy_MDtype/Cast/x}} = Pack[N=2, T=DT_FLOAT, axis=0](Placeholder, Placeholder_1)' with input shapes: [?,1,240], [?,25].


Call arguments received:
  • inputs=['tf.Tensor(shape=(None, 1, 240), dtype=float32)', 'tf.Tensor(shape=(None, 25), dtype=float32)']
  • kwargs={'training': 'None'}
2024-06-12 17:31:55,963 logger.py[line:35] INFO INFO: Mutation progress 50/100
2024-06-12 17:31:55,963 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:31:55,963 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:31:55,963 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:31:55,964 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:31:55,964 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:31:55,964 logger.py[line:35] INFO Score for MDims is: 0.8548387096774194
2024-06-12 17:31:55,964 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:31:55,964 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:31:55,964 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:31:55,964 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:31:55,964 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:31:55,964 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-Edge7
2024-06-12 17:31:55,964 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:32:00,347 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_NLAll')>, 'cropping2d': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_NLAll')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 3) dtype=float64 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2_copy_NLAll')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2': <KerasTensor: shape=(None, 64) dtype=float64 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2_copy_NLAll')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_1_2': <KerasTensor: shape=(None, 64) dtype=float64 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_1_2_copy_NLAll')>, 'cropping2d_1': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_1_copy_NLAll')>, 'conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2': <KerasTensor: shape=(None, 20, 20, 256) dtype=float32 (created by layer 'conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2_copy_NLAll')>, 'conv5_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 14, 14, 256) dtype=float32 (created by layer 'conv5_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2_copy_NLAll')>, 'cropping2d_2': <KerasTensor: shape=(None, 11, 11, 64) dtype=float32 (created by layer 'cropping2d_2_copy_NLAll')>}
2024-06-12 17:32:01,657 logger.py[line:35] INFO Insert 8 out of 29 Local New Layers
2024-06-12 17:32:01,658 logger.py[line:35] INFO insert PReLU after conv3_block3_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_NLAll
2024-06-12 17:32:01,658 logger.py[line:35] INFO insert SeparableConv2D after conv4_block3_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_NLAll
2024-06-12 17:32:01,658 logger.py[line:35] INFO insert ActivityRegularization after cropping2d_2_copy_NLAll
2024-06-12 17:32:01,658 logger.py[line:35] INFO insert TimeDistributed after pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_copy_NLAll
2024-06-12 17:32:01,658 logger.py[line:35] INFO insert BatchNormalization after cropping2d_1_copy_NLAll
2024-06-12 17:32:01,658 logger.py[line:35] INFO insert LocallyConnected2D after pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_copy_NLAll
2024-06-12 17:32:01,658 logger.py[line:35] INFO insert Conv2D after cropping2d_2_copy_NLAll
2024-06-12 17:32:01,658 logger.py[line:35] INFO insert AveragePooling2D after conv3_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_NLAll
2024-06-12 17:32:01,658 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 2
2024-06-12 17:32:01,663 logger.py[line:35] INFO insert Conv2DTranspose after conv4_block3_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_NLAll
2024-06-12 17:32:01,667 logger.py[line:35] INFO insert DepthwiseConv2D after conv5_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.local.LocallyConnected2D object at 0x7f2f20669390>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 65, in new_layer_addition
    y = layer(layer_input)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/backend.py", line 1843, in truncated_normal
    seed=self.make_legacy_seed())
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[56,56,64,56,56,10] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:TruncatedNormal]
2024-06-12 17:32:12,188 logger.py[line:35] INFO INFO: Mutation progress 50/100
2024-06-12 17:32:12,188 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:32:12,188 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:32:12,188 logger.py[line:35] INFO Score for Edge is: 0.8846153846153846
2024-06-12 17:32:12,188 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:32:12,188 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:32:12,188 logger.py[line:35] INFO Score for MDims is: 0.8548387096774194
2024-06-12 17:32:12,188 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:32:12,188 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:32:12,188 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:32:12,188 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:32:12,189 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:32:12,189 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113
2024-06-12 17:32:12,189 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:32:15,116 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:32:15,805 logger.py[line:35] INFO Generating model using Edge
2024-06-12 17:32:15,810 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge')>}
Choosing 3 To Insert
2024-06-12 17:32:15,959 logger.py[line:35] INFO Insert 3 Global New Edges
2024-06-12 17:32:15,959 logger.py[line:35] INFO Candidate Edge: ('UpSampling3D', 'UpSampling3D')
2024-06-12 17:32:15,967 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:32:16,117 logger.py[line:35] INFO Trying Adding Edge: ['UpSampling3D', 'UpSampling3D'] by Connecting up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_Edge and up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_Edge
2024-06-12 17:32:16,121 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:32:16,318 logger.py[line:35] INFO Successfully Add Edge: ['UpSampling3D', 'UpSampling3D'] by Connecting up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_Edge and up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_Edge
2024-06-12 17:32:16,318 logger.py[line:35] INFO Candidate Edge: ('RepeatVector', 'Dropout')
2024-06-12 17:32:16,326 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:32:16,527 logger.py[line:35] INFO Trying Adding Edge: ['RepeatVector', 'Dropout'] by Connecting repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge
2024-06-12 17:32:16,532 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:32:16,730 logger.py[line:35] INFO Successfully Add Edge: ['RepeatVector', 'Dropout'] by Connecting repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge
2024-06-12 17:32:16,730 logger.py[line:35] INFO Candidate Edge: ('Dropout', 'Dropout')
2024-06-12 17:32:16,739 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:32:17,035 logger.py[line:35] INFO Trying Adding Edge: ['Dropout', 'Dropout'] by Connecting dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge_1 and dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge_2
2024-06-12 17:32:17,040 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:32:17,239 logger.py[line:35] INFO Successfully Add Edge: ['Dropout', 'Dropout'] by Connecting dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge_1 and dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge_2
2024-06-12 17:32:17,281 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:32:18,082 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 171/2170
The Configuration Coverage is: 380/2049
The NDims Coverage Is: 67/117
The DType Coverage Is: 66/354
The Shape Coverage Is: 139/295
The Input Coverage Is: 272/766
2024-06-12 17:32:18,302 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:32:22,182 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:32:26,176 logger.py[line:35] INFO 2.9.0
2024-06-12 17:32:27,727 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:32:31,524 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MDtype113-Edge49 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:32:32,691 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 10s
2024-06-12 17:32:32,691 logger.py[line:35] INFO loading the redis
2024-06-12 17:32:32,694 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:32:32,716 logger.py[line:35] INFO coverage_c=37273
time=14.234735012054443, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MDtype113-Edge49
2024-06-12 17:32:37,009 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MDtype113-Edge49
2024-06-12 17:32:37,009 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:32:37,010 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:32:37,010 logger.py[line:35] INFO after_prediction
2024-06-12 17:32:37,010 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MDtype113-Edge49
2024-06-12 17:32:37,309 logger.py[line:35] INFO INFO: Mutation progress 51/100
2024-06-12 17:32:37,309 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:32:37,309 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:32:37,309 logger.py[line:35] INFO Score for Edge is: 0.8875
2024-06-12 17:32:37,309 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:32:37,310 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:32:37,310 logger.py[line:35] INFO Score for MDims is: 0.8548387096774194
2024-06-12 17:32:37,310 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:32:37,310 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:32:37,310 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:32:37,310 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:32:37,310 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:32:37,310 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll58
2024-06-12 17:32:37,310 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:32:40,265 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:32:40,960 logger.py[line:35] INFO Generating model using MDims
2024-06-12 17:32:40,963 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_MDims')>}
2024-06-12 17:32:41,113 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:32:41,113 logger.py[line:35] INFO Global Layer Class: 0; Local Layer Class: 1; Total Layer Class: 1
2024-06-12 17:32:41,113 logger.py[line:35] INFO Changing 0 Layer's NDims.
2024-06-12 17:32:41,113 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:32:41,113 logger.py[line:35] INFO No Global NDims Can Be Found, Randomly Select NDims: 6 For Layer: dropout_1_copy_NLAll_copy_NLAll_copy_MDims
2024-06-12 17:32:41,116 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_MDims')>}
2024-06-12 17:32:41,304 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:32:41,930 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 172/2170
The Configuration Coverage is: 380/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 67/354
The Shape Coverage Is: 141/295
The Input Coverage Is: 276/766
2024-06-12 17:32:42,122 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:32:45,975 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:32:49,972 logger.py[line:35] INFO 2.9.0
2024-06-12 17:32:51,552 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:32:54,328 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-NLAll58-MDims50 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:32:55,482 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:32:55,483 logger.py[line:35] INFO loading the redis
2024-06-12 17:32:55,485 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:32:55,507 logger.py[line:35] INFO coverage_c=37273
time=13.210317850112915, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll58-MDims50
2024-06-12 17:32:59,742 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-NLAll58-MDims50
2024-06-12 17:32:59,742 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:32:59,742 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:32:59,742 logger.py[line:35] INFO after_prediction
2024-06-12 17:32:59,742 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-NLAll58-MDims50
2024-06-12 17:33:00,047 logger.py[line:35] INFO INFO: Mutation progress 52/100
2024-06-12 17:33:00,048 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:33:00,048 logger.py[line:35] INFO Score for NLAll is: 0.896551724137931
2024-06-12 17:33:00,048 logger.py[line:35] INFO Score for Edge is: 0.8875
2024-06-12 17:33:00,048 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:33:00,048 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:33:00,048 logger.py[line:35] INFO Score for MDims is: 0.859375
2024-06-12 17:33:00,048 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:33:00,048 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:33:00,048 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:33:00,048 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:33:00,048 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:33:00,048 logger.py[line:35] INFO Choose seed: mobilenet.v2-MParam43
2024-06-12 17:33:00,048 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:33:04,097 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_NLAll')>}
2024-06-12 17:33:05,175 logger.py[line:35] INFO Insert 8 out of 28 Local New Layers
2024-06-12 17:33:05,175 logger.py[line:35] INFO insert Softmax after block_9_depthwise_relu_copy_MParam_copy_NLAll
2024-06-12 17:33:05,176 logger.py[line:35] INFO insert GlobalMaxPooling2D after block_9_expand_relu_copy_MParam_copy_NLAll
2024-06-12 17:33:05,176 logger.py[line:35] INFO insert AlphaDropout after expanded_conv_depthwise_copy_MParam_copy_NLAll
2024-06-12 17:33:05,176 logger.py[line:35] INFO insert Cropping2D after block_14_depthwise_copy_MParam_copy_NLAll
2024-06-12 17:33:05,176 logger.py[line:35] INFO insert PReLU after block_6_expand_relu_copy_MParam_copy_NLAll
2024-06-12 17:33:05,176 logger.py[line:35] INFO insert GaussianNoise after block_16_project_BN_copy_MParam_copy_NLAll
2024-06-12 17:33:05,176 logger.py[line:35] INFO insert TimeDistributed after block_10_depthwise_relu_copy_MParam_copy_NLAll
2024-06-12 17:33:05,176 logger.py[line:35] INFO insert DepthwiseConv2D after block_14_depthwise_copy_MParam_copy_NLAll
2024-06-12 17:33:05,176 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 1
2024-06-12 17:33:05,185 logger.py[line:35] INFO insert Softmax after block_14_project_BN_copy_MParam_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.noise.AlphaDropout object at 0x7f14902b8990>
2024-06-12 17:33:05,209 logger.py[line:35] INFO Converting output shape (None, 112, 112, 32) to actual shape [None, 112, 112, 32]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.PReLU object at 0x7f1490202e90>
2024-06-12 17:33:05,473 logger.py[line:35] INFO Converting output shape (None, 28, 28, 192) to actual shape [None, 28, 28, 192]
[DEBUG] Inserting layer: <keras.layers.pooling.GlobalMaxPooling2D object at 0x7f1490192810>
2024-06-12 17:33:05,618 logger.py[line:35] INFO Converting output shape (None, 14) to actual shape [None, 14, 14, 384]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.Softmax object at 0x7f1490163dd0>
2024-06-12 17:33:05,718 logger.py[line:35] INFO Converting output shape (None, 14, 14, 384) to actual shape [None, 14, 14, 384]
[DEBUG] Inserting layer: <keras.layers.wrappers.TimeDistributed object at 0x7f14901b5c50>
2024-06-12 17:33:05,768 logger.py[line:35] INFO Converting output shape (None, 14, 14, 384) to actual shape [None, 14, 14, 384]
[DEBUG] Inserting layer: <keras.layers.convolutional.DepthwiseConv2D object at 0x7f14900e51d0>
2024-06-12 17:33:05,943 logger.py[line:35] INFO Converting output shape (None, 2, 3, 960) to actual shape [None, 7, 7, 960]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.Softmax object at 0x7f149010ab90>
2024-06-12 17:33:05,984 logger.py[line:35] INFO Converting output shape (None, 7, 7, 160) to actual shape [None, 7, 7, 160]
[DEBUG] Inserting layer: <keras.layers.noise.GaussianNoise object at 0x7f1490156a10>
2024-06-12 17:33:06,071 logger.py[line:35] INFO Converting output shape (None, 7, 7, 320) to actual shape [None, 7, 7, 320]
model outputs {'predictions_copy_MParam_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_NLAll')>}
2024-06-12 17:33:06,171 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 182/2170
The Configuration Coverage is: 391/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 67/354
The Shape Coverage Is: 146/295
The Input Coverage Is: 281/766
2024-06-12 17:33:07,942 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:33:11,806 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:33:15,946 logger.py[line:35] INFO 2.9.0
2024-06-12 17:33:17,541 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:33:25,416 logger.py[line:35] INFO SUCCESS:Get prediction for mobilenet.v2-MParam43-NLAll51 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:33:27,120 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 15s
2024-06-12 17:33:27,120 logger.py[line:35] INFO loading the redis
2024-06-12 17:33:27,123 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:33:27,144 logger.py[line:35] INFO coverage_c=37273
time=19.025747299194336, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating mobilenet.v2-MParam43-NLAll51
2024-06-12 17:33:31,383 logger.py[line:35] INFO Success on backend: tensorflow of model mobilenet.v2-MParam43-NLAll51
2024-06-12 17:33:31,384 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:33:31,384 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:33:31,384 logger.py[line:35] INFO after_prediction
2024-06-12 17:33:31,384 logger.py[line:35] INFO New representative seed found: mobilenet.v2-MParam43-NLAll51
2024-06-12 17:33:31,753 logger.py[line:35] INFO INFO: Mutation progress 53/100
2024-06-12 17:33:31,753 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:33:31,753 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:33:31,753 logger.py[line:35] INFO Score for Edge is: 0.8875
2024-06-12 17:33:31,753 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:33:31,753 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:33:31,753 logger.py[line:35] INFO Score for MDims is: 0.859375
2024-06-12 17:33:31,753 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:33:31,753 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:33:31,753 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:33:31,753 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:33:31,753 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:33:31,753 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-NLAll99
2024-06-12 17:33:31,753 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:33:36,115 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge')>}
Choosing 7 To Insert
2024-06-12 17:33:37,174 logger.py[line:35] INFO Insert 2 Global New Edges
2024-06-12 17:33:37,175 logger.py[line:35] INFO Insert 5 Local New Edges
2024-06-12 17:33:37,175 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'GlobalMaxPooling2D')
2024-06-12 17:33:38,170 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'GlobalMaxPooling2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and global_max_pooling2d_insert_copy_Edge
2024-06-12 17:33:39,093 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'GlobalMaxPooling2D'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and global_max_pooling2d_insert_copy_Edge
2024-06-12 17:33:39,093 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'GlobalMaxPooling2D')
2024-06-12 17:33:40,345 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'GlobalMaxPooling2D'] by Connecting conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and global_max_pooling2d_insert_copy_Edge_1
2024-06-12 17:33:41,254 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'GlobalMaxPooling2D'] by Connecting conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and global_max_pooling2d_insert_copy_Edge_1
2024-06-12 17:33:41,254 logger.py[line:35] INFO Candidate Edge: ('BatchNormalization', 'GlobalAveragePooling2D')
2024-06-12 17:33:42,257 logger.py[line:35] INFO Trying Adding Edge: ['BatchNormalization', 'GlobalAveragePooling2D'] by Connecting conv3_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:43,158 logger.py[line:35] INFO Successfully Add Edge: ['BatchNormalization', 'GlobalAveragePooling2D'] by Connecting conv3_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:43,158 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'BatchNormalization')
2024-06-12 17:33:44,317 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'BatchNormalization'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and conv3_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:45,230 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'BatchNormalization'] by Connecting pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and conv3_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:45,230 logger.py[line:35] INFO Candidate Edge: ('BatchNormalization', 'Conv2D')
2024-06-12 17:33:46,244 logger.py[line:35] INFO Trying Adding Edge: ['BatchNormalization', 'Conv2D'] by Connecting conv4_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and conv4_block5_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:47,367 logger.py[line:35] INFO Successfully Add Edge: ['BatchNormalization', 'Conv2D'] by Connecting conv4_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and conv4_block5_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:47,367 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'MaxPooling2D')
2024-06-12 17:33:48,377 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'MaxPooling2D'] by Connecting conv3_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:49,293 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'MaxPooling2D'] by Connecting conv3_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:49,293 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'Conv2D')
2024-06-12 17:33:50,310 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'Conv2D'] by Connecting conv5_block3_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and conv5_block3_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:51,413 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'Conv2D'] by Connecting conv5_block3_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge and conv5_block3_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_Edge
2024-06-12 17:33:51,543 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 184/2170
The Configuration Coverage is: 391/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 67/354
The Shape Coverage Is: 148/295
The Input Coverage Is: 283/766
2024-06-12 17:33:53,649 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:33:57,535 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:34:01,682 logger.py[line:35] INFO 2.9.0
2024-06-12 17:34:03,277 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:34:12,740 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-NLAll99-Edge52 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:34:14,451 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:34:14,451 logger.py[line:35] INFO loading the redis
2024-06-12 17:34:14,454 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:34:14,476 logger.py[line:35] INFO coverage_c=37273
time=20.647655725479126, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-NLAll99-Edge52
2024-06-12 17:34:18,782 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-NLAll99-Edge52
2024-06-12 17:34:18,782 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:34:18,782 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:34:18,782 logger.py[line:35] INFO after_prediction
2024-06-12 17:34:18,782 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-NLAll99-Edge52
2024-06-12 17:34:19,159 logger.py[line:35] INFO INFO: Mutation progress 54/100
2024-06-12 17:34:19,159 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:34:19,159 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:34:19,159 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:34:19,159 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:34:19,159 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:34:19,159 logger.py[line:35] INFO Score for MDims is: 0.859375
2024-06-12 17:34:19,160 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:34:19,160 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:34:19,160 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:34:19,160 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:34:19,160 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:34:19,160 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-LMerg10
2024-06-12 17:34:19,160 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:34:23,366 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_NLAll')>}
2024-06-12 17:34:24,672 logger.py[line:35] INFO Insert 7 out of 22 Local New Layers
2024-06-12 17:34:24,673 logger.py[line:35] INFO insert UpSampling2D after conv3_block1_3_bn_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:34:24,673 logger.py[line:35] INFO insert PReLU after conv3_block4_1_conv_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:34:24,673 logger.py[line:35] INFO insert ReLU after avg_pool_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:34:24,673 logger.py[line:35] INFO insert ThresholdedReLU after avg_pool_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:34:24,673 logger.py[line:35] INFO insert SeparableConv2D after conv4_block3_1_bn_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:34:24,673 logger.py[line:35] INFO insert AveragePooling2D after conv3_block3_1_bn_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:34:24,673 logger.py[line:35] INFO insert GaussianNoise after pool1_pad_copy_LMerg_copy_LMerg_copy_NLAll
2024-06-12 17:34:24,673 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 1
2024-06-12 17:34:24,677 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [5]
2024-06-12 17:34:24,677 logger.py[line:35] INFO insert ZeroPadding3D after conv4_block5_add_copy_LMerg_copy_LMerg_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.noise.GaussianNoise object at 0x7f36d076e210>
2024-06-12 17:34:24,704 logger.py[line:35] INFO Converting output shape (None, 114, 114, 64) to actual shape [None, 114, 114, 64]
[DEBUG] Inserting layer: <keras.layers.convolutional.UpSampling2D object at 0x7f37000620d0>
2024-06-12 17:34:24,933 logger.py[line:35] INFO Converting output shape (None, 28, 224, 4096) to actual shape [None, 28, 28, 512]
[DEBUG] Inserting layer: <keras.layers.pooling.AveragePooling2D object at 0x7f36d06b78d0>
2024-06-12 17:34:25,078 logger.py[line:35] INFO Converting output shape (None, 28, 28, 128) to actual shape [None, 28, 28, 128]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.PReLU object at 0x7f36d05cdf90>
2024-06-12 17:34:25,130 logger.py[line:35] INFO Converting output shape (None, 28, 28, 128) to actual shape [None, 28, 28, 128]
[DEBUG] Inserting layer: <keras.layers.convolutional.SeparableConv2D object at 0x7f3767fe5d90>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 65, in new_layer_addition
    y = layer(layer_input)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/initializers/initializers_v2.py", line 674, in __call__
    'Identity matrix initializer can only be used for 2D matrices. '
ValueError: Identity matrix initializer can only be used for 2D matrices. Received: shape=(3, 3, 14, 1) of rank 4.
2024-06-12 17:34:25,946 logger.py[line:35] INFO INFO: Mutation progress 54/100
2024-06-12 17:34:25,946 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:34:25,946 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:34:25,946 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:34:25,946 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:34:25,946 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:34:25,946 logger.py[line:35] INFO Score for MDims is: 0.859375
2024-06-12 17:34:25,946 logger.py[line:35] INFO Score for MParam is: 0.85
2024-06-12 17:34:25,946 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:34:25,946 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:34:25,946 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:34:25,947 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:34:25,947 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-NLAll99-MParam30
2024-06-12 17:34:25,947 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:34:30,378 logger.py[line:35] INFO Generating model using MParam
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam')>}
2024-06-12 17:34:31,432 logger.py[line:35] INFO Changing 3/15 of layer conv4_block6_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam's configuration
2024-06-12 17:34:31,433 logger.py[line:35] INFO changing config bias_initializer in layer conv4_block6_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam: from {'class_name': 'Zeros', 'config': {}} to Ones
2024-06-12 17:34:31,433 logger.py[line:35] INFO changing config dilation_rate in layer conv4_block6_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam: from (1, 1) to [3, 4]
2024-06-12 17:34:31,433 logger.py[line:35] INFO changing config kernel_regularizer in layer conv4_block6_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam: from None to l2
2024-06-12 17:34:31,433 logger.py[line:35] INFO changing config activation in layer conv4_block6_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam: from linear to softsign
2024-06-12 17:34:31,433 logger.py[line:35] INFO Changing 2/5 of layer conv3_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam's configuration
2024-06-12 17:34:31,433 logger.py[line:35] INFO changing config center in layer conv3_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam: from True to True
2024-06-12 17:34:31,433 logger.py[line:35] INFO changing config momentum in layer conv3_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam: from 0.99 to 0.2601650867562615
2024-06-12 17:34:31,433 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 17:34:31,433 logger.py[line:35] INFO changing config scale in layer conv3_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam: from True to True
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MParam_copy_MParam')>}
2024-06-12 17:34:32,443 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 184/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 67/354
The Shape Coverage Is: 148/295
The Input Coverage Is: 283/766
2024-06-12 17:34:34,453 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:34:38,594 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:34:42,754 logger.py[line:35] INFO 2.9.0
2024-06-12 17:34:44,352 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:34:53,273 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-NLAll99-MParam30-MParam53 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:34:54,960 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:34:54,960 logger.py[line:35] INFO loading the redis
2024-06-12 17:34:54,963 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:34:54,991 logger.py[line:35] INFO coverage_c=37273
time=20.36281681060791, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-NLAll99-MParam30-MParam53
2024-06-12 17:34:59,213 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-NLAll99-MParam30-MParam53
2024-06-12 17:34:59,213 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:34:59,213 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:34:59,213 logger.py[line:35] INFO after_prediction
2024-06-12 17:34:59,213 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-NLAll99-MParam30-MParam53
2024-06-12 17:34:59,579 logger.py[line:35] INFO INFO: Mutation progress 55/100
2024-06-12 17:34:59,580 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:34:59,580 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:34:59,580 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:34:59,580 logger.py[line:35] INFO Score for MDtype is: 0.8804347826086957
2024-06-12 17:34:59,580 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:34:59,580 logger.py[line:35] INFO Score for MDims is: 0.859375
2024-06-12 17:34:59,580 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:34:59,580 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:34:59,580 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:34:59,580 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 17:34:59,580 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:34:59,580 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113
2024-06-12 17:34:59,580 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:35:02,544 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:35:03,231 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:35:03,235 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype')>}
2024-06-12 17:35:03,384 logger.py[line:35] INFO Change 1 Layer's DType Out Of 4 Layer classes
2024-06-12 17:35:03,384 logger.py[line:35] INFO Changing 1 out of 4 Layer's DType.
2024-06-12 17:35:03,384 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer dropout_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype
2024-06-12 17:35:03,388 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype')>}
2024-06-12 17:35:03,567 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:35:04,165 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 184/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 148/295
The Input Coverage Is: 284/766
2024-06-12 17:35:04,334 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:35:08,208 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:35:12,280 logger.py[line:35] INFO 2.9.0
2024-06-12 17:35:13,865 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:35:16,562 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MDtype113-MDtype54 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:35:17,765 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:35:17,766 logger.py[line:35] INFO loading the redis
2024-06-12 17:35:17,769 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:35:17,790 logger.py[line:35] INFO coverage_c=37273
time=13.281957864761353, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MDtype113-MDtype54
2024-06-12 17:35:21,997 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MDtype113-MDtype54
2024-06-12 17:35:21,997 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:35:21,997 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:35:21,997 logger.py[line:35] INFO after_prediction
2024-06-12 17:35:21,997 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MDtype113-MDtype54
2024-06-12 17:35:22,297 logger.py[line:35] INFO INFO: Mutation progress 56/100
2024-06-12 17:35:22,297 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:35:22,297 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:35:22,297 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:35:22,297 logger.py[line:35] INFO Score for MDtype is: 0.8829787234042553
2024-06-12 17:35:22,297 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:35:22,297 logger.py[line:35] INFO Score for MDims is: 0.859375
2024-06-12 17:35:22,297 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:35:22,297 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:35:22,297 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:35:22,297 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:35:22,297 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:35:22,297 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-MDtype45-MDims17
2024-06-12 17:35:22,297 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:35:25,258 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:35:25,955 logger.py[line:35] INFO Generating model using MDims
2024-06-12 17:35:25,958 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims')>}
2024-06-12 17:35:26,119 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:35:26,119 logger.py[line:35] INFO Global Layer Class: 0; Local Layer Class: 1; Total Layer Class: 1
2024-06-12 17:35:26,119 logger.py[line:35] INFO Changing 0 Layer's NDims.
2024-06-12 17:35:26,119 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:35:26,119 logger.py[line:35] INFO No Global NDims Can Be Found, Randomly Select NDims: 6 For Layer: dropout_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims
2024-06-12 17:35:26,122 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims')>}
2024-06-12 17:35:26,317 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:35:26,955 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 184/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 148/295
The Input Coverage Is: 284/766
2024-06-12 17:35:27,141 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:35:31,033 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:35:35,032 logger.py[line:35] INFO 2.9.0
2024-06-12 17:35:36,600 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:35:39,358 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-MDtype45-MDims17-MDims55 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:35:40,490 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:35:40,491 logger.py[line:35] INFO loading the redis
2024-06-12 17:35:40,494 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:35:40,515 logger.py[line:35] INFO coverage_c=37273
time=13.193467617034912, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-MDtype45-MDims17-MDims55
2024-06-12 17:35:44,767 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-MDtype45-MDims17-MDims55
2024-06-12 17:35:44,767 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:35:44,767 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:35:44,767 logger.py[line:35] INFO after_prediction
2024-06-12 17:35:44,767 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-MDtype45-MDims17-MDims55
2024-06-12 17:35:45,065 logger.py[line:35] INFO INFO: Mutation progress 57/100
2024-06-12 17:35:45,065 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:35:45,065 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:35:45,065 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:35:45,065 logger.py[line:35] INFO Score for MDtype is: 0.8829787234042553
2024-06-12 17:35:45,065 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:35:45,065 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:35:45,065 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:35:45,065 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:35:45,066 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:35:45,066 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:35:45,066 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:35:45,066 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94
2024-06-12 17:35:45,066 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:35:49,426 logger.py[line:35] INFO Generating model using LMerg
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:35:50,409 logger.py[line:35] INFO Insert 2 out of 8 Local New Layer
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 72, in generate_model_by_model_mutation
    return InteractionMutationUtils.merge_layers(model=model, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 165, in merge_layers
    assert len(selected_layer_name_list) == 1
AssertionError
2024-06-12 17:35:50,881 logger.py[line:35] INFO INFO: Mutation progress 57/100
2024-06-12 17:35:50,881 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:35:50,881 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:35:50,881 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:35:50,881 logger.py[line:35] INFO Score for MDtype is: 0.8829787234042553
2024-06-12 17:35:50,881 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:35:50,881 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:35:50,881 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:35:50,881 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:35:50,881 logger.py[line:35] INFO Score for SpecialI is: 0.6333333333333333
2024-06-12 17:35:50,881 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:35:50,882 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:35:50,882 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14
2024-06-12 17:35:50,882 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:35:55,350 logger.py[line:35] INFO Generating model using SpecialI
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims_copy_SpecialI')>}
2024-06-12 17:35:56,362 logger.py[line:35] INFO Change Input Of Layer: conv5_block1_0_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims_copy_SpecialI To: 0.0
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims_copy_SpecialI')>}
2024-06-12 17:35:57,365 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 184/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 148/295
The Input Coverage Is: 284/766
2024-06-12 17:35:59,405 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:36:03,347 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:36:07,493 logger.py[line:35] INFO 2.9.0
2024-06-12 17:36:09,114 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:36:18,249 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14-SpecialI56 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:36:19,963 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:36:19,963 logger.py[line:35] INFO loading the redis
2024-06-12 17:36:19,966 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:36:19,987 logger.py[line:35] INFO coverage_c=37273
time=20.40687108039856, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14-SpecialI56
2024-06-12 17:36:24,259 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14-SpecialI56
2024-06-12 17:36:24,259 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:36:24,259 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:36:24,259 logger.py[line:35] INFO after_prediction
2024-06-12 17:36:24,259 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14-SpecialI56
2024-06-12 17:36:24,634 logger.py[line:35] INFO INFO: Mutation progress 58/100
2024-06-12 17:36:24,634 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:36:24,634 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:36:24,634 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:36:24,634 logger.py[line:35] INFO Score for MDtype is: 0.8829787234042553
2024-06-12 17:36:24,634 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:36:24,634 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:36:24,634 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:36:24,634 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:36:24,634 logger.py[line:35] INFO Score for SpecialI is: 0.625
2024-06-12 17:36:24,634 logger.py[line:35] INFO The last used seed is: SpecialI
2024-06-12 17:36:24,634 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:36:24,634 logger.py[line:35] INFO Choose seed: densenet121
2024-06-12 17:36:24,635 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:36:30,103 logger.py[line:35] INFO Generating model using SpecialI
model outputs {'predictions': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_SpecialI')>}
2024-06-12 17:36:32,012 logger.py[line:35] INFO Change Input Of Layer: conv3_block3_0_relu_copy_SpecialI To: inf
model outputs {'predictions_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_SpecialI')>}
2024-06-12 17:36:34,327 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 184/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 148/295
The Input Coverage Is: 284/766
2024-06-12 17:36:37,692 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:36:41,588 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:36:45,712 logger.py[line:35] INFO 2.9.0
2024-06-12 17:36:47,283 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:37:00,744 logger.py[line:35] INFO SUCCESS:Get prediction for densenet121-SpecialI57 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:37:02,609 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 21s
2024-06-12 17:37:02,610 logger.py[line:35] INFO loading the redis
2024-06-12 17:37:02,612 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:37:02,634 logger.py[line:35] INFO coverage_c=37273
time=24.762946605682373, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating densenet121-SpecialI57
2024-06-12 17:37:06,849 logger.py[line:35] INFO Success on backend: tensorflow of model densenet121-SpecialI57
2024-06-12 17:37:06,849 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:37:06,849 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:37:06,850 logger.py[line:35] INFO after_prediction
2024-06-12 17:37:06,850 logger.py[line:35] INFO New representative seed found: densenet121-SpecialI57
2024-06-12 17:37:07,315 logger.py[line:35] INFO INFO: Mutation progress 59/100
2024-06-12 17:37:07,315 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:37:07,315 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:37:07,315 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:37:07,315 logger.py[line:35] INFO Score for MDtype is: 0.8829787234042553
2024-06-12 17:37:07,316 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:37:07,316 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:37:07,316 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:37:07,316 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:37:07,316 logger.py[line:35] INFO Score for SpecialI is: 0.6176470588235294
2024-06-12 17:37:07,316 logger.py[line:35] INFO The last used seed is: SpecialI
2024-06-12 17:37:07,316 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:37:07,316 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131
2024-06-12 17:37:07,316 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:37:11,698 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MDims')>}
2024-06-12 17:37:12,731 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:37:12,731 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:37:12,731 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:37:12,732 logger.py[line:35] INFO Selecting a Global NDims 3 For Layer conv4_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MDims
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 88, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dims(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 377, in mutate_dims
    new_model = InputMutationUtils.mdims(MDims_model, selected_layer_ndims_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 349, in mdims
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 340, in mdims_layer_addition
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 313, in build
    f'Invalid axis. Expected 0 <= axis < inputs.rank (with '
ValueError: Invalid axis. Expected 0 <= axis < inputs.rank (with inputs.rank=3). Received: layer.axis=ListWrapper([3])
2024-06-12 17:37:14,002 logger.py[line:35] INFO INFO: Mutation progress 59/100
2024-06-12 17:37:14,002 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:37:14,002 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:37:14,002 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:37:14,002 logger.py[line:35] INFO Score for MDtype is: 0.8829787234042553
2024-06-12 17:37:14,002 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:37:14,002 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:37:14,002 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:37:14,002 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:37:14,002 logger.py[line:35] INFO Score for SpecialI is: 0.6176470588235294
2024-06-12 17:37:14,002 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:37:14,003 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:37:14,003 logger.py[line:35] INFO Choose seed: inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4
2024-06-12 17:37:14,003 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:37:21,520 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MDims')>}
2024-06-12 17:37:25,107 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:37:25,107 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:37:25,107 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:37:25,110 logger.py[line:35] INFO Selecting a Global NDims 3 For Layer batch_normalization_27_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MDims
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 88, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dims(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 377, in mutate_dims
    new_model = InputMutationUtils.mdims(MDims_model, selected_layer_ndims_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 349, in mdims
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 340, in mdims_layer_addition
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 313, in build
    f'Invalid axis. Expected 0 <= axis < inputs.rank (with '
ValueError: Invalid axis. Expected 0 <= axis < inputs.rank (with inputs.rank=3). Received: layer.axis=ListWrapper([3])
2024-06-12 17:37:26,349 logger.py[line:35] INFO INFO: Mutation progress 59/100
2024-06-12 17:37:26,349 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:37:26,349 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:37:26,349 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:37:26,349 logger.py[line:35] INFO Score for MDtype is: 0.8829787234042553
2024-06-12 17:37:26,349 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:37:26,349 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:37:26,349 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:37:26,349 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:37:26,349 logger.py[line:35] INFO Score for SpecialI is: 0.6176470588235294
2024-06-12 17:37:26,349 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:37:26,349 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:37:26,349 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131-Edge7
2024-06-12 17:37:26,349 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:37:30,785 logger.py[line:35] INFO Generating model using MShape
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_copy_MShape')>, 'cropping2d': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_MShape')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 3) dtype=float64 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2_copy_MShape')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2': <KerasTensor: shape=(None, 64) dtype=float64 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2_copy_MShape')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_1_2': <KerasTensor: shape=(None, 64) dtype=float64 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_1_2_copy_MShape')>, 'cropping2d_1': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_1_copy_MShape')>, 'conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2': <KerasTensor: shape=(None, 20, 20, 256) dtype=float32 (created by layer 'conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_1_2_copy_MShape')>, 'conv5_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 14, 14, 256) dtype=float32 (created by layer 'conv5_block1_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2_copy_MShape')>, 'cropping2d_2': <KerasTensor: shape=(None, 11, 11, 64) dtype=float32 (created by layer 'cropping2d_2_copy_MShape')>}
2024-06-12 17:37:31,866 logger.py[line:35] INFO Change 1 Layer's Shape Out Of 6 Layer classes
2024-06-12 17:37:31,866 logger.py[line:35] INFO Changing 1 out of 6 Layer's Shape.
2024-06-12 17:37:31,867 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2_copy_MShape From [None, 56, 56, 64] To [None, 0, 3, 5]
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 94, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_shape(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 483, in mutate_shape
    new_model = InputMutationUtils.mshape(MShape_model, selected_layer_shape_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 456, in mshape
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 447, in mshape_layer_mutation
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1939, in _create_c_op
    raise ValueError(e.message)
ValueError: Exception encountered when calling layer "pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2_copy_MShape" (type MaxPooling2D).

Negative dimension size caused by subtracting 3 from 0 for '{{node pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_Edge_2_copy_MShape/MaxPool}} = MaxPool[T=DT_FLOAT, data_format="NHWC", explicit_paddings=[], ksize=[1, 3, 3, 1], padding="VALID", strides=[1, 2, 2, 1]](Placeholder)' with input shapes: [?,0,3,5].

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 0, 3, 5), dtype=float32)
2024-06-12 17:37:33,499 logger.py[line:35] INFO INFO: Mutation progress 59/100
2024-06-12 17:37:33,499 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:37:33,499 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:37:33,499 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:37:33,499 logger.py[line:35] INFO Score for MDtype is: 0.8829787234042553
2024-06-12 17:37:33,499 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:37:33,499 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:37:33,499 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:37:33,500 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:37:33,500 logger.py[line:35] INFO Score for SpecialI is: 0.6176470588235294
2024-06-12 17:37:33,500 logger.py[line:35] INFO The last used seed is: MShape
2024-06-12 17:37:33,500 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:37:33,500 logger.py[line:35] INFO Choose seed: resnet50-Edge65
2024-06-12 17:37:33,500 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:37:37,711 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype')>, 'cropping2d': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'cropping2d_copy_MDtype')>, 'avg_pool_copy_Edge_2': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype')>}
2024-06-12 17:37:38,730 logger.py[line:35] INFO Change 1 Layer's DType Out Of 6 Layer classes
2024-06-12 17:37:38,730 logger.py[line:35] INFO Changing 1 out of 6 Layer's DType.
2024-06-12 17:37:38,731 logger.py[line:35] INFO Selecting a Global DType float32 For Layer pool1_pool_copy_Edge_copy_MDtype
model outputs {'predictions_copy_Edge_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype')>, 'cropping2d_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'cropping2d_copy_MDtype')>, 'avg_pool_copy_Edge_2_copy_MDtype': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype')>}
2024-06-12 17:37:39,717 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 184/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 148/295
The Input Coverage Is: 284/766
2024-06-12 17:37:41,660 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:37:45,624 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:37:49,729 logger.py[line:35] INFO 2.9.0
2024-06-12 17:37:51,294 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:37:59,669 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-Edge65-MDtype58 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:38:01,389 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 15s
2024-06-12 17:38:01,389 logger.py[line:35] INFO loading the redis
2024-06-12 17:38:01,392 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:38:01,414 logger.py[line:35] INFO coverage_c=37273
time=19.57591938972473, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating resnet50-Edge65-MDtype58
2024-06-12 17:38:05,700 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-Edge65-MDtype58
2024-06-12 17:38:05,700 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:38:05,700 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:38:05,700 logger.py[line:35] INFO after_prediction
2024-06-12 17:38:05,700 logger.py[line:35] INFO New representative seed found: resnet50-Edge65-MDtype58
2024-06-12 17:38:06,071 logger.py[line:35] INFO INFO: Mutation progress 60/100
2024-06-12 17:38:06,071 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:38:06,071 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:38:06,071 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:38:06,071 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:38:06,071 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:38:06,071 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:38:06,071 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:38:06,071 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:38:06,071 logger.py[line:35] INFO Score for SpecialI is: 0.6176470588235294
2024-06-12 17:38:06,072 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:38:06,072 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:38:06,072 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113-MDtype54
2024-06-12 17:38:06,072 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:38:09,040 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:38:09,736 logger.py[line:35] INFO Generating model using SpecialI
2024-06-12 17:38:09,741 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI')>}
2024-06-12 17:38:09,891 logger.py[line:35] INFO Change Input Of Layer: custom_cast_layer_1_copy_SpecialI To: nan
2024-06-12 17:38:09,895 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI')>}
2024-06-12 17:38:10,066 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:38:10,673 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 184/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 148/295
The Input Coverage Is: 284/766
2024-06-12 17:38:10,846 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:38:14,688 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:38:18,678 logger.py[line:35] INFO 2.9.0
2024-06-12 17:38:20,272 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:38:22,947 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:38:24,096 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:38:24,096 logger.py[line:35] INFO loading the redis
2024-06-12 17:38:24,098 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:38:24,120 logger.py[line:35] INFO coverage_c=37273
time=13.098026990890503, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59
2024-06-12 17:38:28,292 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59
2024-06-12 17:38:28,292 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:38:28,292 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:38:28,292 logger.py[line:35] INFO after_prediction
2024-06-12 17:38:28,293 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59
2024-06-12 17:38:28,595 logger.py[line:35] INFO INFO: Mutation progress 61/100
2024-06-12 17:38:28,595 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:38:28,595 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:38:28,595 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:38:28,595 logger.py[line:35] INFO Score for MDtype is: 0.875
2024-06-12 17:38:28,595 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:38:28,595 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:38:28,595 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:38:28,595 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:38:28,595 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:38:28,595 logger.py[line:35] INFO The last used seed is: SpecialI
2024-06-12 17:38:28,595 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:38:28,595 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120-MDims44
2024-06-12 17:38:28,595 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:38:32,029 logger.py[line:35] INFO Generating model using MDtype
model outputs {'dense_3_copy_SpecialI_copy_MDims': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype')>}
2024-06-12 17:38:32,126 logger.py[line:35] INFO Change 2 Layer's DType Out Of 5 Layer classes
2024-06-12 17:38:32,126 logger.py[line:35] INFO Changing 2 out of 5 Layer's DType.
2024-06-12 17:38:32,127 logger.py[line:35] INFO Selecting a Global DType float32 For Layer dropout_2_copy_SpecialI_copy_MDims_copy_MDtype
2024-06-12 17:38:32,127 logger.py[line:35] INFO Selecting a Global DType float16 For Layer batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype')>}
2024-06-12 17:38:32,273 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 184/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 148/295
The Input Coverage Is: 284/766
2024-06-12 17:38:33,068 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:38:36,931 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:38:40,915 logger.py[line:35] INFO 2.9.0
2024-06-12 17:38:42,507 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:38:46,659 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-SpecialI120-MDims44-MDtype60 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:38:48,291 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 17:38:48,292 logger.py[line:35] INFO loading the redis
2024-06-12 17:38:48,294 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:38:48,316 logger.py[line:35] INFO coverage_c=37273
time=15.073372840881348, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating alexnet-SpecialI120-MDims44-MDtype60
2024-06-12 17:38:52,982 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-SpecialI120-MDims44-MDtype60
2024-06-12 17:38:52,982 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:38:52,982 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:38:52,983 logger.py[line:35] INFO after_prediction
2024-06-12 17:38:52,983 logger.py[line:35] INFO New representative seed found: alexnet-SpecialI120-MDims44-MDtype60
2024-06-12 17:38:53,323 logger.py[line:35] INFO INFO: Mutation progress 62/100
2024-06-12 17:38:53,323 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:38:53,323 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:38:53,323 logger.py[line:35] INFO Score for Edge is: 0.8902439024390244
2024-06-12 17:38:53,323 logger.py[line:35] INFO Score for MDtype is: 0.8775510204081632
2024-06-12 17:38:53,323 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:38:53,323 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:38:53,323 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:38:53,323 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:38:53,323 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:38:53,323 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:38:53,324 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:38:53,324 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1
2024-06-12 17:38:53,324 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:38:58,068 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge')>}
Choosing 7 To Insert
2024-06-12 17:38:59,163 logger.py[line:35] INFO Insert 7 Global New Edges
2024-06-12 17:38:59,163 logger.py[line:35] INFO Candidate Edge: ('DepthwiseConv2D', 'ELU')
2024-06-12 17:39:00,361 logger.py[line:35] INFO Trying Adding Edge: ['DepthwiseConv2D', 'ELU'] by Connecting depthwise_conv2d_insert_copy_NLAll_copy_NLAll_copy_Edge and elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:01,542 logger.py[line:35] INFO Successfully Add Edge: ['DepthwiseConv2D', 'ELU'] by Connecting depthwise_conv2d_insert_copy_NLAll_copy_NLAll_copy_Edge and elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:01,542 logger.py[line:35] INFO Candidate Edge: ('Softmax', 'Softmax')
2024-06-12 17:39:02,735 logger.py[line:35] INFO Trying Adding Edge: ['Softmax', 'Softmax'] by Connecting softmax_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge and softmax_insert_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:03,828 logger.py[line:35] INFO Successfully Add Edge: ['Softmax', 'Softmax'] by Connecting softmax_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge and softmax_insert_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:03,828 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'SpatialDropout2D')
2024-06-12 17:39:05,215 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'SpatialDropout2D'] by Connecting zero_padding2d_insert_copy_Edge and spatial_dropout2d_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:06,331 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'SpatialDropout2D'] by Connecting zero_padding2d_insert_copy_Edge and spatial_dropout2d_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:06,332 logger.py[line:35] INFO Candidate Edge: ('SpatialDropout2D', 'MaxPooling2D')
2024-06-12 17:39:07,583 logger.py[line:35] INFO Trying Adding Edge: ['SpatialDropout2D', 'MaxPooling2D'] by Connecting spatial_dropout2d_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2 and pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:08,883 logger.py[line:35] INFO Successfully Add Edge: ['SpatialDropout2D', 'MaxPooling2D'] by Connecting spatial_dropout2d_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2 and pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:08,883 logger.py[line:35] INFO Candidate Edge: ('ZeroPadding2D', 'PReLU')
2024-06-12 17:39:10,114 logger.py[line:35] INFO Trying Adding Edge: ['ZeroPadding2D', 'PReLU'] by Connecting zero_padding2d_insert_copy_NLAll_copy_NLAll_copy_Edge and p_re_lu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:11,236 logger.py[line:35] INFO Successfully Add Edge: ['ZeroPadding2D', 'PReLU'] by Connecting zero_padding2d_insert_copy_NLAll_copy_NLAll_copy_Edge and p_re_lu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:11,236 logger.py[line:35] INFO Candidate Edge: ('ActivityRegularization', 'Conv2D')
2024-06-12 17:39:12,694 logger.py[line:35] INFO Trying Adding Edge: ['ActivityRegularization', 'Conv2D'] by Connecting activity_regularization_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge and conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:13,814 logger.py[line:35] INFO Successfully Add Edge: ['ActivityRegularization', 'Conv2D'] by Connecting activity_regularization_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge and conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:13,814 logger.py[line:35] INFO Candidate Edge: ('Softmax', 'GlobalMaxPooling2D')
2024-06-12 17:39:15,044 logger.py[line:35] INFO Trying Adding Edge: ['Softmax', 'GlobalMaxPooling2D'] by Connecting softmax_insert_copy_Edge and global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:16,335 logger.py[line:35] INFO Successfully Add Edge: ['Softmax', 'GlobalMaxPooling2D'] by Connecting softmax_insert_copy_Edge and global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge
2024-06-12 17:39:16,474 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 192/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 150/295
The Input Coverage Is: 286/766
2024-06-12 17:39:18,934 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:39:22,798 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:39:26,916 logger.py[line:35] INFO 2.9.0
2024-06-12 17:39:28,510 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:39:39,349 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:39:41,066 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 18s
2024-06-12 17:39:41,066 logger.py[line:35] INFO loading the redis
2024-06-12 17:39:41,069 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:39:41,090 logger.py[line:35] INFO coverage_c=37273
time=21.980540990829468, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61
2024-06-12 17:39:45,395 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61
2024-06-12 17:39:45,396 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:39:45,396 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:39:45,396 logger.py[line:35] INFO after_prediction
2024-06-12 17:39:45,396 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61
2024-06-12 17:39:45,786 logger.py[line:35] INFO INFO: Mutation progress 63/100
2024-06-12 17:39:45,786 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:39:45,786 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:39:45,786 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:39:45,786 logger.py[line:35] INFO Score for MDtype is: 0.8775510204081632
2024-06-12 17:39:45,786 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:39:45,786 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:39:45,786 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:39:45,786 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:39:45,786 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:39:45,786 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:39:45,786 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:39:45,786 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MParam115-MDims8
2024-06-12 17:39:45,786 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:39:48,761 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:39:49,425 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:39:49,428 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_MDtype')>}
2024-06-12 17:39:49,582 logger.py[line:35] INFO Change 1 Layer's DType Out Of 4 Layer classes
2024-06-12 17:39:49,582 logger.py[line:35] INFO Changing 1 out of 4 Layer's DType.
2024-06-12 17:39:49,583 logger.py[line:35] INFO Selecting a Global DType float64 For Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_MDtype
2024-06-12 17:39:49,585 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 91, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dtype(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 426, in mutate_dtype
    new_model = utils.ModelUtils.functional_model_operation(MDtype_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 416, in mdtype_mutation
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/recurrent.py", line 679, in __call__
    return super(RNN, self).__call__(inputs, **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/backend.py", line 2134, in dot
    out = tf.matmul(x, y)
TypeError: Exception encountered when calling layer "lstm_cell_2" (type LSTMCell).

Input 'b' of 'MatMul' Op has type float32 that does not match type float64 of argument 'a'.

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 240), dtype=float32)
  • states=('tf.Tensor(shape=(None, 25), dtype=float64)', 'tf.Tensor(shape=(None, 25), dtype=float64)')
  • training=None
2024-06-12 17:39:50,062 logger.py[line:35] INFO INFO: Mutation progress 63/100
2024-06-12 17:39:50,062 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:39:50,062 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:39:50,062 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:39:50,062 logger.py[line:35] INFO Score for MDtype is: 0.8775510204081632
2024-06-12 17:39:50,062 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:39:50,062 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:39:50,062 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:39:50,062 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:39:50,062 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:39:50,062 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:39:50,063 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:39:50,063 logger.py[line:35] INFO Choose seed: lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32
2024-06-12 17:39:50,063 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:39:53,708 logger.py[line:35] INFO Generating model using Edge
model outputs {'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_Edge')>, 'cropping1d_copy_LMerg': <KerasTensor: shape=(None, 10, 2) dtype=float32 (created by layer 'cropping1d_copy_LMerg_copy_Edge')>, 'dot_copy_ML': <KerasTensor: shape=(None, 10, 10, 10, 10) dtype=float32 (created by layer 'dot_copy_ML_copy_Edge')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1_copy_LMerg': <KerasTensor: shape=(None, 14, 14, 6) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1_copy_LMerg_copy_Edge')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg_copy_Edge')>, 'elu_insert_copy_Edge_1_2_1_copy_LMerg': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'elu_insert_copy_Edge_1_2_1_copy_LMerg_copy_Edge')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1_copy_LMerg': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1_copy_LMerg_copy_Edge')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2_copy_LMerg': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2_copy_LMerg_copy_Edge')>, 'cropping1d_1_copy_LMerg': <KerasTensor: shape=(None, 10, 2) dtype=float32 (created by layer 'cropping1d_1_copy_LMerg_copy_Edge')>}
Choosing 7 To Insert
2024-06-12 17:39:53,873 logger.py[line:35] INFO Insert 7 Global New Edges
2024-06-12 17:39:53,874 logger.py[line:35] INFO Candidate Edge: ('LeakyReLU', 'AveragePooling2D')
2024-06-12 17:39:54,042 logger.py[line:35] INFO Trying Adding Edge: ['LeakyReLU', 'AveragePooling2D'] by Connecting leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg_copy_Edge and average_pooling2d_9_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_Edge
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 75, in generate_model_by_model_mutation
    return InteractionMutationUtils.connect_layers(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 209, in connect_layers
    Edge_model = ArchitectureUtils.connect_two_layers(Edge_model, layer1_name, layer2_name)
  File "/root/implementations/scripts/tools/architecture_utils.py", line 635, in connect_two_layers
    edge_output = right_cloned_layer(left_output)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1939, in _create_c_op
    raise ValueError(e.message)
ValueError: Exception encountered when calling layer "average_pooling2d_9_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_Edge_2" (type AveragePooling2D).

Negative dimension size caused by subtracting 2 from 1 for '{{node average_pooling2d_9_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_Edge_2/AvgPool}} = AvgPool[T=DT_FLOAT, data_format="NHWC", ksize=[1, 2, 2, 1], padding="VALID", strides=[1, 2, 2, 1]](Placeholder)' with input shapes: [?,1,1,120].

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 1, 1, 120), dtype=float32)
2024-06-12 17:39:54,677 logger.py[line:35] INFO INFO: Mutation progress 63/100
2024-06-12 17:39:54,677 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:39:54,677 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:39:54,677 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:39:54,677 logger.py[line:35] INFO Score for MDtype is: 0.8775510204081632
2024-06-12 17:39:54,677 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:39:54,677 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:39:54,677 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:39:54,677 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:39:54,677 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:39:54,678 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:39:54,678 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:39:54,678 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131
2024-06-12 17:39:54,678 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:39:59,039 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_NLAll')>}
2024-06-12 17:40:00,288 logger.py[line:35] INFO Insert 7 out of 22 Local New Layers
2024-06-12 17:40:00,288 logger.py[line:35] INFO insert ELU after pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_NLAll
2024-06-12 17:40:00,289 logger.py[line:35] INFO insert Softmax after conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_NLAll
2024-06-12 17:40:00,289 logger.py[line:35] INFO insert Conv2DTranspose after conv3_block4_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_NLAll
2024-06-12 17:40:00,289 logger.py[line:35] INFO insert GaussianNoise after conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_NLAll
2024-06-12 17:40:00,289 logger.py[line:35] INFO insert Flatten after conv4_block4_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_NLAll
2024-06-12 17:40:00,289 logger.py[line:35] INFO insert ActivityRegularization after avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_NLAll
2024-06-12 17:40:00,289 logger.py[line:35] INFO insert AveragePooling2D after conv4_block3_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_NLAll
2024-06-12 17:40:00,289 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 1
2024-06-12 17:40:00,292 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [3]
2024-06-12 17:40:00,293 logger.py[line:35] INFO insert LSTM after conv4_block6_2_relu_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.noise.GaussianNoise object at 0x7f77f038f290>
2024-06-12 17:40:00,299 logger.py[line:35] INFO Converting output shape (None, 230, 230, 3) to actual shape [None, 230, 230, 3]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ELU object at 0x7f77f03b5a10>
2024-06-12 17:40:00,322 logger.py[line:35] INFO Converting output shape (None, 56, 56, 64) to actual shape [None, 56, 56, 64]
[DEBUG] Inserting layer: <keras.layers.convolutional.Conv2DTranspose object at 0x7f785fd1bc50>
2024-06-12 17:40:00,690 logger.py[line:35] INFO Converting output shape (None, 128, 2, 128) to actual shape [None, 7, 2, 128]
[DEBUG] Inserting layer: <keras.layers.pooling.AveragePooling2D object at 0x7f77f019d050>
2024-06-12 17:40:00,850 logger.py[line:35] INFO Converting output shape (None, 14, 14, 256) to actual shape [None, 14, 14, 256]
[DEBUG] Inserting layer: <keras.layers.core.flatten.Flatten object at 0x7f77f0146a50>
2024-06-12 17:40:00,908 logger.py[line:35] INFO Converting output shape (None, 50176) to actual shape [None, 14, 14, 256]
2024-06-12 17:40:01,064 recurrent_v2.py[line:1127] WARNING Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomDropDimLayer object at 0x7f77f01c9510>
[DEBUG] Inserting layer: <keras.layers.recurrent_v2.LSTM object at 0x7f77f01fe350>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 73, in new_layer_addition
    mylogger.info(f"Converting output shape {layer_input.shape} to actual shape {target_shape}")
AttributeError: 'list' object has no attribute 'shape'
2024-06-12 17:40:02,109 logger.py[line:35] INFO INFO: Mutation progress 63/100
2024-06-12 17:40:02,109 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:40:02,109 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:40:02,109 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:40:02,109 logger.py[line:35] INFO Score for MDtype is: 0.8775510204081632
2024-06-12 17:40:02,109 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:40:02,109 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:40:02,109 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:40:02,109 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:40:02,109 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:40:02,109 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:40:02,109 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:40:02,110 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-NLAll124-MDtype128-SpecialI45
2024-06-12 17:40:02,110 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:40:05,076 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:40:05,869 logger.py[line:35] INFO Generating model using MParam
2024-06-12 17:40:05,872 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam')>}
2024-06-12 17:40:06,089 logger.py[line:35] INFO Changing 1/1 of layer softmax_insert_copy_MDtype_copy_SpecialI_copy_MParam's configuration
2024-06-12 17:40:06,090 logger.py[line:35] INFO changing config axis in layer softmax_insert_copy_MDtype_copy_SpecialI_copy_MParam: from -2 to -1
2024-06-12 17:40:06,090 logger.py[line:35] INFO Changing 1/2 of layer up_sampling2d_insert_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam's configuration
2024-06-12 17:40:06,090 logger.py[line:35] INFO changing config data_format in layer up_sampling2d_insert_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam: from channels_last to channels_first
2024-06-12 17:40:06,090 logger.py[line:35] INFO changing config interpolation in layer up_sampling2d_insert_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam: from nearest to bilinear
2024-06-12 17:40:06,090 logger.py[line:35] INFO Changing 1/1 of layer up_sampling3d_insert_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam's configuration
2024-06-12 17:40:06,090 logger.py[line:35] INFO changing config data_format in layer up_sampling3d_insert_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam: from channels_first to channels_first
2024-06-12 17:40:06,093 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 82, in generate_model_by_model_mutation
    architecture_measure=architecture_measure, max_layer_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 283, in mutate_param
    new_model = utils.ModelUtils.functional_model_operation(MParam_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 101, in functional_model_operation
    x = cloned_layer(layer_input_tensors)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/autograph/impl/api.py", line 699, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: Exception encountered when calling layer "custom_drop_dim_layer_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam" (type CustomDropDimLayer).

in user code:

    File "/root/implementations/scripts/generation/custom_layers.py", line 235, in call  *
        return inputs[indices]

    ValueError: slice index 0 of dimension 1 out of bounds. for '{{node custom_drop_dim_layer_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam/strided_slice}} = StridedSlice[Index=DT_INT32, T=DT_FLOAT, begin_mask=13, ellipsis_mask=0, end_mask=13, new_axis_mask=0, shrink_axis_mask=2](Placeholder, custom_drop_dim_layer_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam/strided_slice/stack, custom_drop_dim_layer_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam/strided_slice/stack_1, custom_drop_dim_layer_1_copy_NLAll_copy_NLAll_copy_MDtype_copy_SpecialI_copy_MParam/strided_slice/stack_2)' with input shapes: [?,0,9,1575], [4], [4], [4] and with computed input tensors: input[1] = <0 0 0 0>, input[2] = <0 1 0 0>, input[3] = <1 1 1 1>.


Call arguments received:
  • inputs=tf.Tensor(shape=(None, 0, 9, 1575), dtype=float32)
  • kwargs={'training': 'None'}
2024-06-12 17:40:06,721 logger.py[line:35] INFO INFO: Mutation progress 63/100
2024-06-12 17:40:06,721 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:40:06,721 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:40:06,721 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:40:06,721 logger.py[line:35] INFO Score for MDtype is: 0.8775510204081632
2024-06-12 17:40:06,721 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:40:06,722 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:40:06,722 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:40:06,722 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:40:06,722 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:40:06,722 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 17:40:06,722 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:40:06,722 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-NLAll124-MDtype127
2024-06-12 17:40:06,722 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:40:09,696 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:40:10,497 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:40:10,500 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype')>}
2024-06-12 17:40:10,724 logger.py[line:35] INFO Change 2 Layer's DType Out Of 10 Layer classes
2024-06-12 17:40:10,724 logger.py[line:35] INFO Changing 2 out of 10 Layer's DType.
2024-06-12 17:40:10,724 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer conv3d_transpose_insert_copy_MDtype_copy_MDtype
2024-06-12 17:40:10,724 logger.py[line:35] INFO Selecting a Global DType float16 For Layer separable_conv1d_insert_copy_MDtype_copy_MDtype
2024-06-12 17:40:10,727 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype')>}
2024-06-12 17:40:10,989 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:40:11,646 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_NLAll_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 192/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 150/295
The Input Coverage Is: 286/766
2024-06-12 17:40:11,906 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:40:15,788 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:40:19,777 logger.py[line:35] INFO 2.9.0
2024-06-12 17:40:21,348 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 229, in <module>
    predictor.before_predict()
  File "/root/implementations/scripts/prediction/predict_model.py", line 116, in before_predict
    self.model = keras.models.load_model(self.model_path, custom_objects=custom_objects())
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/backend.py", line 4019, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype_numpy(x)))
ValueError: No cast function available.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 235, in <module>
    raise ValueError(f"CRASH ON BACKEND {flags.backend}!!!")
ValueError: CRASH ON BACKEND tensorflow!!!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:40:23,594 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 7s
2024-06-12 17:40:23,594 logger.py[line:35] INFO lstm2-NLAll38-NLAll54-NLAll124-MDtype127-MDtype62 crash on backend tensorflow when predicting
2024-06-12 17:40:23,619 logger.py[line:35] INFO coverage_c=37273
time=11.537328958511353, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-NLAll124-MDtype127-MDtype62
2024-06-12 17:40:27,903 logger.py[line:35] INFO Fail on backend: tensorflow of model lstm2-NLAll38-NLAll54-NLAll124-MDtype127-MDtype62
2024-06-12 17:40:27,903 logger.py[line:35] INFO Error: Move Crash model
2024-06-12 17:40:27,903 logger.py[line:35] INFO after_prediction
2024-06-12 17:40:28,203 logger.py[line:35] INFO INFO: Mutation progress 64/100
2024-06-12 17:40:28,203 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:40:28,204 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:40:28,204 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:40:28,204 logger.py[line:35] INFO Score for MDtype is: 0.87
2024-06-12 17:40:28,204 logger.py[line:35] INFO Score for LMerg is: 0.8666666666666667
2024-06-12 17:40:28,204 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:40:28,204 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:40:28,204 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:40:28,204 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:40:28,204 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:40:28,204 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:40:28,204 logger.py[line:35] INFO Choose seed: lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32
2024-06-12 17:40:28,204 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:40:31,862 logger.py[line:35] INFO Generating model using LMerg
model outputs {'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_LMerg')>, 'cropping1d_copy_LMerg': <KerasTensor: shape=(None, 10, 2) dtype=float32 (created by layer 'cropping1d_copy_LMerg_copy_LMerg')>, 'dot_copy_ML': <KerasTensor: shape=(None, 10, 10, 10, 10) dtype=float32 (created by layer 'dot_copy_ML_copy_LMerg')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1_copy_LMerg': <KerasTensor: shape=(None, 14, 14, 6) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1_copy_LMerg_copy_LMerg')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg_copy_LMerg')>, 'elu_insert_copy_Edge_1_2_1_copy_LMerg': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'elu_insert_copy_Edge_1_2_1_copy_LMerg_copy_LMerg')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1_copy_LMerg': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1_copy_LMerg_copy_LMerg')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2_copy_LMerg': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2_copy_LMerg_copy_LMerg')>, 'cropping1d_1_copy_LMerg': <KerasTensor: shape=(None, 10, 2) dtype=float32 (created by layer 'cropping1d_1_copy_LMerg_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:40:32,023 logger.py[line:35] INFO Insert 1 out of 8 Local New Layer
2024-06-12 17:40:32,023 logger.py[line:35] INFO Trying Merge Layers: cropping1d_1_copy_LMerg_copy_LMerg and cropping1d_copy_LMerg_copy_LMerg by Concatenate
2024-06-12 17:40:32,182 logger.py[line:35] INFO Success on Merge Layers: cropping1d_1_copy_LMerg_copy_LMerg and cropping1d_copy_LMerg_copy_LMerg by Concatenate
2024-06-12 17:40:32,266 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 192/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 150/295
The Input Coverage Is: 286/766
2024-06-12 17:40:33,094 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:40:36,967 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:40:40,959 logger.py[line:35] INFO 2.9.0
2024-06-12 17:40:42,548 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:40:47,391 logger.py[line:35] INFO SUCCESS:Get prediction for lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32-LMerg63 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:40:49,027 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:40:49,027 logger.py[line:35] INFO loading the redis
2024-06-12 17:40:49,030 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:40:49,052 logger.py[line:35] INFO coverage_c=37273
time=15.783461809158325, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32-LMerg63
2024-06-12 17:40:53,270 logger.py[line:35] INFO Success on backend: tensorflow of model lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32-LMerg63
2024-06-12 17:40:53,270 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:40:53,270 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:40:53,270 logger.py[line:35] INFO after_prediction
2024-06-12 17:40:53,270 logger.py[line:35] INFO New representative seed found: lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32-LMerg63
2024-06-12 17:40:53,575 logger.py[line:35] INFO INFO: Mutation progress 65/100
2024-06-12 17:40:53,575 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:40:53,575 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:40:53,575 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:40:53,575 logger.py[line:35] INFO Score for MDtype is: 0.87
2024-06-12 17:40:53,575 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:40:53,575 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:40:53,575 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:40:53,575 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:40:53,575 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:40:53,575 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:40:53,575 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:40:53,576 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37
2024-06-12 17:40:53,576 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:40:58,038 logger.py[line:35] INFO Generating model using MShape
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MShape')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MShape')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MShape')>, 'cropping2d_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_MShape')>, 'cropping2d_1_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MShape')>, 'cropping2d_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MShape')>, 'cropping2d_3_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MShape')>, 'cropping2d_4_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MShape')>, 'cropping2d_5_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MShape')>, 'cropping2d_6_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MShape')>}
2024-06-12 17:40:59,103 logger.py[line:35] INFO Change 2 Layer's Shape Out Of 6 Layer classes
2024-06-12 17:40:59,103 logger.py[line:35] INFO Changing 2 out of 6 Layer's Shape.
2024-06-12 17:40:59,104 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: cropping2d_4_copy_SpecialI_copy_MDtype_copy_MShape From [None, 56, 56, 64] To [None, 4, 3, 3]
2024-06-12 17:40:59,104 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: conv3_block4_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MShape From [None, 28, 28, 512] To [None, 1, 4, 6]
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 94, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_shape(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 483, in mutate_shape
    new_model = InputMutationUtils.mshape(MShape_model, selected_layer_shape_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 456, in mshape
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 447, in mshape_layer_mutation
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional.py", line 3554, in call
    raise ValueError('Argument `cropping` must be '
ValueError: Exception encountered when calling layer "cropping2d_4_copy_SpecialI_copy_MDtype_copy_MShape" (type Cropping2D).

Argument `cropping` must be greater than the input shape. Received: inputs.shape=(None, 4, 3, 3), and cropping=((23, 23), (23, 23))

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 4, 3, 3), dtype=float32)
2024-06-12 17:41:00,607 logger.py[line:35] INFO INFO: Mutation progress 65/100
2024-06-12 17:41:00,607 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:41:00,607 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:41:00,607 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:41:00,607 logger.py[line:35] INFO Score for MDtype is: 0.87
2024-06-12 17:41:00,607 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:41:00,607 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:41:00,608 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:41:00,608 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:41:00,608 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:41:00,608 logger.py[line:35] INFO The last used seed is: MShape
2024-06-12 17:41:00,608 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:41:00,608 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120-MDims44
2024-06-12 17:41:00,608 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:41:04,046 logger.py[line:35] INFO Generating model using MDtype
model outputs {'dense_3_copy_SpecialI_copy_MDims': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype')>}
2024-06-12 17:41:04,143 logger.py[line:35] INFO Change 2 Layer's DType Out Of 5 Layer classes
2024-06-12 17:41:04,143 logger.py[line:35] INFO Changing 2 out of 5 Layer's DType.
2024-06-12 17:41:04,144 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer dropout_2_copy_SpecialI_copy_MDims_copy_MDtype
2024-06-12 17:41:04,144 logger.py[line:35] INFO Selecting a Global DType float64 For Layer conv2d_5_copy_SpecialI_copy_MDims_copy_MDtype
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype')>}
2024-06-12 17:41:04,292 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 192/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 150/295
The Input Coverage Is: 286/766
2024-06-12 17:41:05,111 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:41:09,029 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:41:13,156 logger.py[line:35] INFO 2.9.0
2024-06-12 17:41:14,743 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:41:18,949 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-SpecialI120-MDims44-MDtype64 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:41:20,689 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 17:41:20,689 logger.py[line:35] INFO loading the redis
2024-06-12 17:41:20,692 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:41:20,713 logger.py[line:35] INFO coverage_c=37273
time=15.42757248878479, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating alexnet-SpecialI120-MDims44-MDtype64
2024-06-12 17:41:25,311 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-SpecialI120-MDims44-MDtype64
2024-06-12 17:41:25,312 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:41:25,312 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:41:25,312 logger.py[line:35] INFO after_prediction
2024-06-12 17:41:25,312 logger.py[line:35] INFO New representative seed found: alexnet-SpecialI120-MDims44-MDtype64
2024-06-12 17:41:25,646 logger.py[line:35] INFO INFO: Mutation progress 66/100
2024-06-12 17:41:25,646 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:41:25,647 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:41:25,647 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:41:25,647 logger.py[line:35] INFO Score for MDtype is: 0.8725490196078431
2024-06-12 17:41:25,647 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:41:25,647 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:41:25,647 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:41:25,647 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:41:25,647 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:41:25,647 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:41:25,647 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:41:25,647 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-MDtype45-MDims17-MDims55
2024-06-12 17:41:25,647 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:41:28,617 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:41:29,335 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:41:29,338 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype')>}
2024-06-12 17:41:29,511 logger.py[line:35] INFO Change 1 Layer's DType Out Of 4 Layer classes
2024-06-12 17:41:29,511 logger.py[line:35] INFO Changing 1 out of 4 Layer's DType.
2024-06-12 17:41:29,512 logger.py[line:35] INFO Selecting a Global DType half For Layer dropout_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype
2024-06-12 17:41:29,515 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype')>}
2024-06-12 17:41:29,706 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:41:30,327 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 192/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 68/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 150/295
The Input Coverage Is: 286/766
2024-06-12 17:41:30,521 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:41:34,360 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:41:38,388 logger.py[line:35] INFO 2.9.0
2024-06-12 17:41:39,973 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:41:42,769 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype65 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:41:43,967 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:41:43,967 logger.py[line:35] INFO loading the redis
2024-06-12 17:41:43,970 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:41:43,992 logger.py[line:35] INFO coverage_c=37273
time=13.294604063034058, cov_py=0, cov_c=37273
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype65
2024-06-12 17:41:48,215 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype65
2024-06-12 17:41:48,215 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:41:48,215 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:41:48,215 logger.py[line:35] INFO after_prediction
2024-06-12 17:41:48,215 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype65
2024-06-12 17:41:48,520 logger.py[line:35] INFO INFO: Mutation progress 67/100
2024-06-12 17:41:48,520 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:41:48,520 logger.py[line:35] INFO Score for NLAll is: 0.8983050847457628
2024-06-12 17:41:48,520 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:41:48,520 logger.py[line:35] INFO Score for MDtype is: 0.8653846153846154
2024-06-12 17:41:48,520 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:41:48,520 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:41:48,520 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:41:48,520 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:41:48,520 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:41:48,520 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:41:48,520 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:41:48,520 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-LMerg10
2024-06-12 17:41:48,521 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:41:52,756 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_NLAll')>}
2024-06-12 17:41:53,983 logger.py[line:35] INFO Insert 1 out of 22 Local New Layers
2024-06-12 17:41:53,983 logger.py[line:35] INFO insert ThresholdedReLU after avg_pool_copy_LMerg_copy_LMerg_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ThresholdedReLU object at 0x7f5808044590>
2024-06-12 17:41:54,847 logger.py[line:35] INFO Converting output shape (None, 2048) to actual shape [None, 2048]
model outputs {'predictions_copy_LMerg_copy_LMerg_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_NLAll')>}
2024-06-12 17:41:54,934 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 193/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 69/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 151/295
The Input Coverage Is: 288/766
2024-06-12 17:41:56,746 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:42:00,592 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:42:04,717 logger.py[line:35] INFO 2.9.0
2024-06-12 17:42:06,321 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:42:14,503 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-LMerg10-NLAll66 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:42:16,206 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 15s
2024-06-12 17:42:16,206 logger.py[line:35] INFO loading the redis
2024-06-12 17:42:16,209 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:42:16,231 logger.py[line:35] INFO coverage_c=37276
time=19.30815076828003, cov_py=0, cov_c=37276
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-LMerg10-NLAll66
2024-06-12 17:42:20,506 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-LMerg10-NLAll66
2024-06-12 17:42:20,506 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:42:20,506 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:42:20,506 logger.py[line:35] INFO after_prediction
2024-06-12 17:42:20,506 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-LMerg10-NLAll66
2024-06-12 17:42:20,880 logger.py[line:35] INFO INFO: Mutation progress 68/100
2024-06-12 17:42:20,880 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:42:20,880 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:42:20,880 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:42:20,880 logger.py[line:35] INFO Score for MDtype is: 0.8653846153846154
2024-06-12 17:42:20,880 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:42:20,880 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:42:20,880 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:42:20,880 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:42:20,880 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:42:20,880 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:42:20,880 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:42:20,880 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113-MDtype46
2024-06-12 17:42:20,880 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:42:23,869 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:42:24,567 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 17:42:24,572 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll')>}
2024-06-12 17:42:24,759 logger.py[line:35] INFO Insert 6 out of 14 Global New Layers
2024-06-12 17:42:24,759 logger.py[line:35] INFO insert SpatialDropout1D after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,759 logger.py[line:35] INFO insert ConvLSTM2D after up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,759 logger.py[line:35] INFO insert GlobalAveragePooling1D after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,759 logger.py[line:35] INFO insert ZeroPadding3D after up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,759 logger.py[line:35] INFO insert ZeroPadding1D after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,759 logger.py[line:35] INFO insert MaxPooling3D after up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,759 logger.py[line:35] INFO Insert 4 out of 18 Local New Layers
2024-06-12 17:42:24,759 logger.py[line:35] INFO insert ELU after lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,759 logger.py[line:35] INFO insert TimeDistributed after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,760 logger.py[line:35] INFO insert Cropping1D after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,760 logger.py[line:35] INFO insert Softmax after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,760 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 3
2024-06-12 17:42:24,760 logger.py[line:35] INFO insert AveragePooling2D after custom_drop_dim_layer_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,761 logger.py[line:35] INFO insert Cropping2D after custom_expand_layer_1_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,761 logger.py[line:35] INFO insert ZeroPadding1D after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:42:24,766 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ELU object at 0x7fb1f80c4dd0>
2024-06-12 17:42:24,859 logger.py[line:35] INFO Converting output shape (None, 25) to actual shape [None, 25]
[DEBUG] Inserting layer: <keras.layers.convolutional.Cropping2D object at 0x7fb1f805f8d0>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 65, in new_layer_addition
    y = layer(layer_input)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional.py", line 3536, in call
    raise ValueError('Argument `cropping` must be '
ValueError: Exception encountered when calling layer "cropping2d_insert" (type Cropping2D).

Argument `cropping` must be greater than the input shape. Received: inputs.shape=(None, 1, 1, 25), and cropping=((1, 1), (1, 1))

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 1, 1, 25), dtype=float32)
2024-06-12 17:42:25,310 logger.py[line:35] INFO INFO: Mutation progress 68/100
2024-06-12 17:42:25,310 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:42:25,310 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:42:25,310 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:42:25,310 logger.py[line:35] INFO Score for MDtype is: 0.8653846153846154
2024-06-12 17:42:25,310 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:42:25,310 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:42:25,310 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:42:25,310 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:42:25,310 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:42:25,310 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:42:25,311 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:42:25,311 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37
2024-06-12 17:42:25,311 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:42:29,768 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_1_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_3_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_4_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_5_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_6_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype')>}
2024-06-12 17:42:30,891 logger.py[line:35] INFO Change 1 Layer's DType Out Of 6 Layer classes
2024-06-12 17:42:30,891 logger.py[line:35] INFO Changing 1 out of 6 Layer's DType.
2024-06-12 17:42:30,892 logger.py[line:35] INFO Selecting a Global DType float32 For Layer conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype')>, 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype')>}
2024-06-12 17:42:32,013 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 193/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 69/117
The DType Coverage Is: 68/354
The Shape Coverage Is: 151/295
The Input Coverage Is: 288/766
2024-06-12 17:42:34,290 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:42:38,180 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:42:42,310 logger.py[line:35] INFO 2.9.0
2024-06-12 17:42:43,894 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:42:53,609 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:42:55,347 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 17s
2024-06-12 17:42:55,347 logger.py[line:35] INFO loading the redis
2024-06-12 17:42:55,350 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:42:55,371 logger.py[line:35] INFO coverage_c=37276
time=20.903939723968506, cov_py=0, cov_c=37276
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67
2024-06-12 17:43:00,010 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67
2024-06-12 17:43:00,011 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:43:00,011 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:43:00,011 logger.py[line:35] INFO after_prediction
2024-06-12 17:43:00,011 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67
2024-06-12 17:43:00,413 logger.py[line:35] INFO INFO: Mutation progress 69/100
2024-06-12 17:43:00,413 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:43:00,413 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:43:00,413 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:43:00,413 logger.py[line:35] INFO Score for MDtype is: 0.8584905660377359
2024-06-12 17:43:00,413 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:43:00,413 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:43:00,413 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:43:00,414 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:43:00,414 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:43:00,414 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:43:00,414 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:43:00,414 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40
2024-06-12 17:43:00,414 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:43:03,386 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:43:03,405 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:43:04,228 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:43:04,231 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:43:04,425 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 1, 9, 9, 225) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll_copy_MDtype')>, 'cropping2d_copy_NLAll': <KerasTensor: shape=(None, 11, 11, 225) dtype=float32 (created by layer 'cropping2d_copy_NLAll_copy_MDtype')>, 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 25) dtype=float32 (created by layer 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype')>, 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype')>}
2024-06-12 17:43:04,523 logger.py[line:35] INFO Change 5 Layer's DType Out Of 9 Layer classes
2024-06-12 17:43:04,523 logger.py[line:35] INFO Changing 5 out of 9 Layer's DType.
2024-06-12 17:43:04,523 logger.py[line:35] INFO Selecting a Global DType float16 For Layer up_sampling2d_insert_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype
2024-06-12 17:43:04,523 logger.py[line:35] INFO Selecting a Global DType float16 For Layer cropping2d_copy_NLAll_copy_MDtype
2024-06-12 17:43:04,523 logger.py[line:35] INFO Selecting a Global DType float16 For Layer repeat_vector_insert_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype
2024-06-12 17:43:04,524 logger.py[line:35] INFO Selecting a Global DType float16 For Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll_copy_MDtype
2024-06-12 17:43:04,524 logger.py[line:35] INFO Selecting a Global DType double For Layer up_sampling3d_insert_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype
2024-06-12 17:43:04,527 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 91, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dtype(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 426, in mutate_dtype
    new_model = utils.ModelUtils.functional_model_operation(MDtype_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 416, in mdtype_mutation
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/recurrent.py", line 679, in __call__
    return super(RNN, self).__call__(inputs, **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/backend.py", line 2134, in dot
    out = tf.matmul(x, y)
TypeError: Exception encountered when calling layer "lstm_cell_4" (type LSTMCell).

Input 'b' of 'MatMul' Op has type float32 that does not match type float16 of argument 'a'.

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 240), dtype=float32)
  • states=('tf.Tensor(shape=(None, 25), dtype=float16)', 'tf.Tensor(shape=(None, 25), dtype=float16)')
  • training=None
2024-06-12 17:43:05,040 logger.py[line:35] INFO INFO: Mutation progress 69/100
2024-06-12 17:43:05,040 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:43:05,040 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:43:05,040 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:43:05,040 logger.py[line:35] INFO Score for MDtype is: 0.8584905660377359
2024-06-12 17:43:05,040 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:43:05,040 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:43:05,040 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:43:05,040 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:43:05,040 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:43:05,040 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:43:05,041 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:43:05,041 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40
2024-06-12 17:43:05,041 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:43:08,022 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:43:08,041 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:43:08,857 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:43:08,860 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:43:09,052 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 1, 9, 9, 225) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll_copy_MDtype')>, 'cropping2d_copy_NLAll': <KerasTensor: shape=(None, 11, 11, 225) dtype=float32 (created by layer 'cropping2d_copy_NLAll_copy_MDtype')>, 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 25) dtype=float32 (created by layer 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype')>, 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype')>}
2024-06-12 17:43:09,149 logger.py[line:35] INFO Change 2 Layer's DType Out Of 9 Layer classes
2024-06-12 17:43:09,149 logger.py[line:35] INFO Changing 2 out of 9 Layer's DType.
2024-06-12 17:43:09,149 logger.py[line:35] INFO Selecting a Global DType float64 For Layer dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll_copy_MDtype
2024-06-12 17:43:09,149 logger.py[line:35] INFO Selecting a Global DType float64 For Layer up_sampling2d_insert_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype
2024-06-12 17:43:09,152 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:43:09,382 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1, 9, 9, 225) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_2_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'custom_cast_layer_3')>, 'cropping2d_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 11, 11, 225) dtype=float32 (created by layer 'cropping2d_copy_NLAll_copy_MDtype')>, 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 25) dtype=float32 (created by layer 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype')>, 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype')>}
2024-06-12 17:43:09,534 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:43:10,202 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:43:10,219 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 193/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 69/117
The DType Coverage Is: 70/354
The Shape Coverage Is: 151/295
The Input Coverage Is: 290/766
2024-06-12 17:43:10,522 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:43:14,381 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:43:18,375 logger.py[line:35] INFO 2.9.0
2024-06-12 17:43:19,979 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:43:23,791 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40-MDtype68 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:43:24,940 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 10s
2024-06-12 17:43:24,940 logger.py[line:35] INFO loading the redis
2024-06-12 17:43:24,942 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:43:24,964 logger.py[line:35] INFO coverage_c=37276
time=14.266217231750488, cov_py=0, cov_c=37276
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40-MDtype68
2024-06-12 17:43:29,209 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40-MDtype68
2024-06-12 17:43:29,209 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:43:29,209 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:43:29,209 logger.py[line:35] INFO after_prediction
2024-06-12 17:43:29,210 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40-MDtype68
2024-06-12 17:43:29,518 logger.py[line:35] INFO INFO: Mutation progress 70/100
2024-06-12 17:43:29,518 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:43:29,518 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:43:29,519 logger.py[line:35] INFO Score for Edge is: 0.8928571428571429
2024-06-12 17:43:29,519 logger.py[line:35] INFO Score for MDtype is: 0.8611111111111112
2024-06-12 17:43:29,519 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:43:29,519 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:43:29,519 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:43:29,519 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:43:29,519 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:43:29,519 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:43:29,519 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:43:29,519 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120-MDims44-MDtype64
2024-06-12 17:43:29,519 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:43:32,997 logger.py[line:35] INFO Generating model using Edge
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge')>}
Choosing 10 To Insert
2024-06-12 17:43:33,104 logger.py[line:35] INFO Insert 3 Global New Edges
2024-06-12 17:43:33,104 logger.py[line:35] INFO Insert 7 Local New Edges
2024-06-12 17:43:33,104 logger.py[line:35] INFO Candidate Edge: ('Flatten', 'Dropout')
2024-06-12 17:43:33,214 logger.py[line:35] INFO Trying Adding Edge: ['Flatten', 'Dropout'] by Connecting flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:33,318 logger.py[line:35] INFO Successfully Add Edge: ['Flatten', 'Dropout'] by Connecting flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:33,318 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'Dropout')
2024-06-12 17:43:33,430 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'Dropout'] by Connecting conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2
2024-06-12 17:43:33,536 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'Dropout'] by Connecting conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2
2024-06-12 17:43:33,536 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'Flatten')
2024-06-12 17:43:33,651 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'Flatten'] by Connecting conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:33,759 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'Flatten'] by Connecting conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:33,759 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'Conv2D')
2024-06-12 17:43:33,880 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'Conv2D'] by Connecting max_pooling2d_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:33,995 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'Conv2D'] by Connecting max_pooling2d_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:33,995 logger.py[line:35] INFO Candidate Edge: ('BatchNormalization', 'Conv2D')
2024-06-12 17:43:34,123 logger.py[line:35] INFO Trying Adding Edge: ['BatchNormalization', 'Conv2D'] by Connecting batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:34,245 logger.py[line:35] INFO Successfully Add Edge: ['BatchNormalization', 'Conv2D'] by Connecting batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:34,245 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'Dropout')
2024-06-12 17:43:34,540 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'Dropout'] by Connecting max_pooling2d_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1
2024-06-12 17:43:34,664 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'Dropout'] by Connecting max_pooling2d_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1
2024-06-12 17:43:34,664 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'BatchNormalization')
2024-06-12 17:43:34,796 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'BatchNormalization'] by Connecting conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1 and batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:34,929 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'BatchNormalization'] by Connecting conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1 and batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:34,929 logger.py[line:35] INFO Candidate Edge: ('Flatten', 'Flatten')
2024-06-12 17:43:35,078 logger.py[line:35] INFO Trying Adding Edge: ['Flatten', 'Flatten'] by Connecting flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1 and flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2
2024-06-12 17:43:35,212 logger.py[line:35] INFO Successfully Add Edge: ['Flatten', 'Flatten'] by Connecting flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1 and flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2
2024-06-12 17:43:35,212 logger.py[line:35] INFO Candidate Edge: ('MaxPooling2D', 'Flatten')
2024-06-12 17:43:35,360 logger.py[line:35] INFO Trying Adding Edge: ['MaxPooling2D', 'Flatten'] by Connecting max_pooling2d_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2
2024-06-12 17:43:35,495 logger.py[line:35] INFO Successfully Add Edge: ['MaxPooling2D', 'Flatten'] by Connecting max_pooling2d_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2
2024-06-12 17:43:35,495 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'Conv2D')
2024-06-12 17:43:35,645 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'Conv2D'] by Connecting conv2d_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and conv2d_5_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:35,789 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'Conv2D'] by Connecting conv2d_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge and conv2d_5_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 17:43:35,886 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 196/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 69/117
The DType Coverage Is: 70/354
The Shape Coverage Is: 151/295
The Input Coverage Is: 290/766
2024-06-12 17:43:36,898 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:43:40,734 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:43:44,727 logger.py[line:35] INFO 2.9.0
2024-06-12 17:43:46,312 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:43:51,179 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-SpecialI120-MDims44-MDtype64-Edge69 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:43:52,794 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:43:52,794 logger.py[line:35] INFO loading the redis
2024-06-12 17:43:52,797 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:43:52,819 logger.py[line:35] INFO coverage_c=37276
time=15.744609594345093, cov_py=0, cov_c=37276
New test requirements invoked on framework tensorflow when updating alexnet-SpecialI120-MDims44-MDtype64-Edge69
2024-06-12 17:43:56,999 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-SpecialI120-MDims44-MDtype64-Edge69
2024-06-12 17:43:56,999 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:43:56,999 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:43:56,999 logger.py[line:35] INFO after_prediction
2024-06-12 17:43:56,999 logger.py[line:35] INFO New representative seed found: alexnet-SpecialI120-MDims44-MDtype64-Edge69
2024-06-12 17:43:57,307 logger.py[line:35] INFO INFO: Mutation progress 71/100
2024-06-12 17:43:57,308 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:43:57,308 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:43:57,308 logger.py[line:35] INFO Score for Edge is: 0.8953488372093024
2024-06-12 17:43:57,308 logger.py[line:35] INFO Score for MDtype is: 0.8611111111111112
2024-06-12 17:43:57,308 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:43:57,308 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:43:57,308 logger.py[line:35] INFO Score for LMerg is: 0.84375
2024-06-12 17:43:57,308 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:43:57,308 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:43:57,308 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:43:57,308 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:43:57,308 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37
2024-06-12 17:43:57,308 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:44:01,768 logger.py[line:35] INFO Generating model using LMerg
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_LMerg')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_LMerg')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_LMerg')>, 'cropping2d_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_LMerg')>, 'cropping2d_1_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_LMerg')>, 'cropping2d_2_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_LMerg')>, 'cropping2d_3_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_LMerg')>, 'cropping2d_4_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_LMerg')>, 'cropping2d_5_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_LMerg')>, 'cropping2d_6_copy_SpecialI_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:44:02,885 logger.py[line:35] INFO Insert 1 out of 8 Local New Layer
2024-06-12 17:44:02,892 logger.py[line:35] INFO Trying Merge Layers: avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_1_copy_SpecialI_copy_MDtype_copy_LMerg and custom_cast_layer_1_copy_Edge_copy_SpecialI_copy_MDtype_copy_LMerg by Concatenate
2024-06-12 17:44:03,848 logger.py[line:35] INFO Success on Merge Layers: avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_1_copy_SpecialI_copy_MDtype_copy_LMerg and custom_cast_layer_1_copy_Edge_copy_SpecialI_copy_MDtype_copy_LMerg by Concatenate
2024-06-12 17:44:04,001 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 196/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 69/117
The DType Coverage Is: 70/354
The Shape Coverage Is: 151/295
The Input Coverage Is: 290/766
2024-06-12 17:44:06,278 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:44:10,186 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:44:14,331 logger.py[line:35] INFO 2.9.0
2024-06-12 17:44:15,915 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:44:25,595 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-LMerg70 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:44:27,353 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 17s
2024-06-12 17:44:27,353 logger.py[line:35] INFO loading the redis
2024-06-12 17:44:27,356 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:44:27,378 logger.py[line:35] INFO coverage_c=37281
time=20.919570446014404, cov_py=0, cov_c=37281
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-LMerg70
2024-06-12 17:44:31,706 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-LMerg70
2024-06-12 17:44:31,706 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:44:31,706 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:44:31,706 logger.py[line:35] INFO after_prediction
2024-06-12 17:44:31,706 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-LMerg70
2024-06-12 17:44:32,092 logger.py[line:35] INFO INFO: Mutation progress 72/100
2024-06-12 17:44:32,092 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:44:32,092 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:44:32,092 logger.py[line:35] INFO Score for Edge is: 0.8953488372093024
2024-06-12 17:44:32,092 logger.py[line:35] INFO Score for MDtype is: 0.8611111111111112
2024-06-12 17:44:32,092 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:44:32,092 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:44:32,092 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:44:32,092 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:44:32,092 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:44:32,092 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:44:32,092 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:44:32,092 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-NLAll99-MDtype111-MDims14-SpecialI56
2024-06-12 17:44:32,092 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:44:36,723 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims_copy_SpecialI_copy_MDims')>}
2024-06-12 17:44:37,656 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:44:37,656 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 0; Total Layer Class: 1
2024-06-12 17:44:37,656 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:44:37,657 logger.py[line:35] INFO Selecting a Global NDims 3 For Layer conv3_block2_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_MDtype_copy_MDims_copy_SpecialI_copy_MDims
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 88, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_dims(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 377, in mutate_dims
    new_model = InputMutationUtils.mdims(MDims_model, selected_layer_ndims_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 349, in mdims
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 340, in mdims_layer_addition
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 313, in build
    f'Invalid axis. Expected 0 <= axis < inputs.rank (with '
ValueError: Invalid axis. Expected 0 <= axis < inputs.rank (with inputs.rank=3). Received: layer.axis=ListWrapper([3])
2024-06-12 17:44:38,504 logger.py[line:35] INFO INFO: Mutation progress 72/100
2024-06-12 17:44:38,505 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:44:38,505 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:44:38,505 logger.py[line:35] INFO Score for Edge is: 0.8953488372093024
2024-06-12 17:44:38,505 logger.py[line:35] INFO Score for MDtype is: 0.8611111111111112
2024-06-12 17:44:38,505 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:44:38,505 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:44:38,505 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:44:38,505 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:44:38,505 logger.py[line:35] INFO Score for SpecialI is: 0.6111111111111112
2024-06-12 17:44:38,505 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:44:38,505 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:44:38,505 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40-MDtype68
2024-06-12 17:44:38,505 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:44:41,485 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:44:41,505 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:44:42,351 logger.py[line:35] INFO Generating model using SpecialI
2024-06-12 17:44:42,354 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:44:42,556 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype_copy_SpecialI')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1, 9, 9, 225) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI')>, 'custom_cast_layer_3': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'custom_cast_layer_3_copy_SpecialI')>, 'cropping2d_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 11, 11, 225) dtype=float32 (created by layer 'cropping2d_copy_NLAll_copy_MDtype_copy_SpecialI')>, 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 25) dtype=float32 (created by layer 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI')>, 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI')>}
2024-06-12 17:44:42,650 logger.py[line:35] INFO Change Input Of Layer: custom_cast_layer_copy_SpecialI To: 0.0
2024-06-12 17:44:42,653 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:44:42,858 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_copy_NLAll_copy_MDtype_copy_SpecialI')>, 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1, 9, 9, 225) dtype=float32 (created by layer 'dropout_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI')>, 'custom_cast_layer_3_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'custom_cast_layer_3_copy_SpecialI')>, 'cropping2d_copy_NLAll_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 11, 11, 225) dtype=float32 (created by layer 'cropping2d_copy_NLAll_copy_MDtype_copy_SpecialI')>, 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 25) dtype=float32 (created by layer 'lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI')>, 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'gaussian_dropout_insert_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI')>}
2024-06-12 17:44:43,013 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:44:43,688 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_1_copy_NLAll_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:44:43,705 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_NLAll_copy_SpecialI_copy_SpecialI_copy_Edge_2_copy_NLAll_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 196/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 69/117
The DType Coverage Is: 70/354
The Shape Coverage Is: 151/295
The Input Coverage Is: 290/766
2024-06-12 17:44:44,011 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:44:47,850 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:44:51,852 logger.py[line:35] INFO 2.9.0
2024-06-12 17:44:53,445 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:44:57,306 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40-MDtype68-SpecialI71 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:44:58,559 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 10s
2024-06-12 17:44:58,559 logger.py[line:35] INFO loading the redis
2024-06-12 17:44:58,562 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:44:58,583 logger.py[line:35] INFO coverage_c=37281
time=14.391993284225464, cov_py=0, cov_c=37281
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40-MDtype68-SpecialI71
2024-06-12 17:45:03,178 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40-MDtype68-SpecialI71
2024-06-12 17:45:03,179 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:45:03,179 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:45:03,179 logger.py[line:35] INFO after_prediction
2024-06-12 17:45:03,179 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-NLAll54-SpecialI75-SpecialI118-Edge35-NLAll40-MDtype68-SpecialI71
2024-06-12 17:45:03,533 logger.py[line:35] INFO INFO: Mutation progress 73/100
2024-06-12 17:45:03,533 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:45:03,533 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:45:03,533 logger.py[line:35] INFO Score for Edge is: 0.8953488372093024
2024-06-12 17:45:03,533 logger.py[line:35] INFO Score for MDtype is: 0.8611111111111112
2024-06-12 17:45:03,533 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:45:03,533 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:45:03,533 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:45:03,533 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:45:03,533 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:45:03,533 logger.py[line:35] INFO The last used seed is: SpecialI
2024-06-12 17:45:03,534 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:45:03,534 logger.py[line:35] INFO Choose seed: resnet50-Edge65-MDtype132-SpecialI1-MShape20
2024-06-12 17:45:03,534 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:45:07,903 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype')>, 'custom_cast_layer_5_copy_SpecialI_copy_MShape': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI_copy_MShape_copy_MDtype')>, 'custom_pad_layer_1': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'custom_pad_layer_1_copy_MDtype')>}
2024-06-12 17:45:08,889 logger.py[line:35] INFO Change 2 Layer's DType Out Of 6 Layer classes
2024-06-12 17:45:08,889 logger.py[line:35] INFO Changing 2 out of 6 Layer's DType.
2024-06-12 17:45:08,889 logger.py[line:35] INFO Selecting a Global DType half For Layer cropping2d_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype
2024-06-12 17:45:08,890 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer conv4_block5_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype')>, 'custom_cast_layer_5_copy_SpecialI_copy_MShape_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI_copy_MShape_copy_MDtype')>, 'custom_pad_layer_1_copy_MDtype': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'custom_pad_layer_1_copy_MDtype')>}
2024-06-12 17:45:09,890 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 196/2170
The Configuration Coverage is: 395/2049
The NDims Coverage Is: 69/117
The DType Coverage Is: 71/354
The Shape Coverage Is: 151/295
The Input Coverage Is: 291/766
2024-06-12 17:45:11,975 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:45:15,838 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:45:19,988 logger.py[line:35] INFO 2.9.0
2024-06-12 17:45:21,577 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 230, in <module>
    predictor.predict()
  File "/root/implementations/scripts/prediction/predict_model.py", line 167, in predict
    pred = self.model.predict(self.input)
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/tensorflow/python/eager/execute.py", line 55, in quick_execute
    inputs, attrs, num_outputs)
tensorflow.python.framework.errors_impl.InternalError: Graph execution error:

Detected at node 'resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72/conv4_block5_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype/FusedBatchNormV3' defined at (most recent call last):
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 193, in _run_module_as_main
      "__main__", mod_spec)
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 85, in _run_code
      exec(code, run_globals)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/__main__.py", line 8, in <module>
      sys.exit(main())
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 871, in main
      status = CoverageScript().command_line(argv)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 588, in command_line
      return self.do_run(options, args)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 746, in do_run
      runner.run()
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/execfile.py", line 247, in run
      exec(code, main_mod.__dict__)
    File "/root/implementations/scripts/prediction/predict_model.py", line 230, in <module>
      predictor.predict()
    File "/root/implementations/scripts/prediction/predict_model.py", line 167, in predict
      pred = self.model.predict(self.input)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1982, in predict
      tmp_batch_outputs = self.predict_function(iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1801, in predict_function
      return step_function(self, iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1790, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1783, in run_step
      outputs = model.predict_step(data)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1751, in predict_step
      return self(x, training=False)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 452, in call
      inputs, training=training, mask=mask)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 589, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 767, in call
      outputs = self._fused_batch_norm(inputs, training=training)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 624, in _fused_batch_norm
      training, train_op, _fused_batch_norm_inference)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/control_flow_util.py", line 106, in smart_cond
      pred, true_fn=true_fn, false_fn=false_fn, name=name)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 613, in _fused_batch_norm_inference
      data_format=self._data_format)
Node: 'resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72/conv4_block5_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype/FusedBatchNormV3'
Detected at node 'resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72/conv4_block5_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype/FusedBatchNormV3' defined at (most recent call last):
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 193, in _run_module_as_main
      "__main__", mod_spec)
    File "/opt/conda/envs/tensorflow/lib/python3.7/runpy.py", line 85, in _run_code
      exec(code, run_globals)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/__main__.py", line 8, in <module>
      sys.exit(main())
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 871, in main
      status = CoverageScript().command_line(argv)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 588, in command_line
      return self.do_run(options, args)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/cmdline.py", line 746, in do_run
      runner.run()
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/coverage/execfile.py", line 247, in run
      exec(code, main_mod.__dict__)
    File "/root/implementations/scripts/prediction/predict_model.py", line 230, in <module>
      predictor.predict()
    File "/root/implementations/scripts/prediction/predict_model.py", line 167, in predict
      pred = self.model.predict(self.input)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1982, in predict
      tmp_batch_outputs = self.predict_function(iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1801, in predict_function
      return step_function(self, iterator)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1790, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1783, in run_step
      outputs = model.predict_step(data)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1751, in predict_step
      return self(x, training=False)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 452, in call
      inputs, training=training, mask=mask)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/functional.py", line 589, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/engine/base_layer.py", line 1096, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 767, in call
      outputs = self._fused_batch_norm(inputs, training=training)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 624, in _fused_batch_norm
      training, train_op, _fused_batch_norm_inference)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/control_flow_util.py", line 106, in smart_cond
      pred, true_fn=true_fn, false_fn=false_fn, name=name)
    File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/layers/normalization/batch_normalization.py", line 613, in _fused_batch_norm_inference
      data_format=self._data_format)
Node: 'resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72/conv4_block5_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype/FusedBatchNormV3'
2 root error(s) found.
  (0) INTERNAL:  Missing 0-th output from {{node resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72/conv4_block5_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype/FusedBatchNormV3}}
	 [[resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72/conv4_block5_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype/FusedBatchNormV3/_16]]
  (1) INTERNAL:  Missing 0-th output from {{node resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72/conv4_block5_3_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_MDtype/FusedBatchNormV3}}
0 successful operations.
0 derived errors ignored. [Op:__inference_predict_function_5091]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 235, in <module>
    raise ValueError(f"CRASH ON BACKEND {flags.backend}!!!")
ValueError: CRASH ON BACKEND tensorflow!!!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:45:32,554 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:45:32,555 logger.py[line:35] INFO resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72 crash on backend tensorflow when predicting
2024-06-12 17:45:32,577 logger.py[line:35] INFO coverage_c=37281
time=20.425958156585693, cov_py=0, cov_c=37281
New test requirements invoked on framework tensorflow when updating resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72
2024-06-12 17:45:36,790 logger.py[line:35] INFO Fail on backend: tensorflow of model resnet50-Edge65-MDtype132-SpecialI1-MShape20-MDtype72
2024-06-12 17:45:36,791 logger.py[line:35] INFO Error: Move Crash model
2024-06-12 17:45:36,791 logger.py[line:35] INFO after_prediction
2024-06-12 17:45:37,130 logger.py[line:35] INFO INFO: Mutation progress 74/100
2024-06-12 17:45:37,131 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:45:37,131 logger.py[line:35] INFO Score for NLAll is: 0.9
2024-06-12 17:45:37,131 logger.py[line:35] INFO Score for Edge is: 0.8953488372093024
2024-06-12 17:45:37,131 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:45:37,131 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:45:37,131 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:45:37,131 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:45:37,131 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:45:37,131 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:45:37,131 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:45:37,131 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:45:37,131 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59
2024-06-12 17:45:37,131 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:45:40,106 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:45:40,796 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 17:45:40,801 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll')>}
2024-06-12 17:45:40,983 logger.py[line:35] INFO Insert 4 out of 14 Global New Layers
2024-06-12 17:45:40,983 logger.py[line:35] INFO insert GlobalMaxPooling1D after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:45:40,983 logger.py[line:35] INFO insert Conv3D after up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:45:40,983 logger.py[line:35] INFO insert MaxPooling3D after up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:45:40,983 logger.py[line:35] INFO insert ConvLSTM2D after up_sampling3d_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:45:40,983 logger.py[line:35] INFO Insert 2 out of 18 Local New Layers
2024-06-12 17:45:40,983 logger.py[line:35] INFO insert Cropping1D after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:45:40,983 logger.py[line:35] INFO insert BatchNormalization after repeat_vector_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:45:40,983 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 2
2024-06-12 17:45:40,984 logger.py[line:35] INFO insert SimpleRNN after custom_expand_layer_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:45:40,985 logger.py[line:35] INFO insert PReLU after custom_expand_layer_insert_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll
2024-06-12 17:45:40,989 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.advanced_activations.PReLU object at 0x7f2830121cd0>
2024-06-12 17:45:41,090 logger.py[line:35] INFO Converting output shape (None, 1, 25) to actual shape [None, 1, 25]
[DEBUG] Inserting layer: <keras.layers.convolutional_recurrent.ConvLSTM2D object at 0x7f2830087850>
2024-06-12 17:45:41,192 logger.py[line:35] INFO Converting output shape (None, 1, 9, 8, 225) to actual shape [None, 1, 9, 9, 225]
[DEBUG] Inserting layer: <keras.layers.normalization.batch_normalization.BatchNormalization object at 0x7f27d0608590>
2024-06-12 17:45:41,265 logger.py[line:35] INFO Converting output shape (None, 2, 25) to actual shape [None, 2, 25]
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll')>}
2024-06-12 17:45:41,295 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:45:41,947 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 198/2170
The Configuration Coverage is: 423/2049
The NDims Coverage Is: 72/117
The DType Coverage Is: 72/354
The Shape Coverage Is: 153/295
The Input Coverage Is: 297/766
2024-06-12 17:45:42,223 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:45:46,065 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:45:50,061 logger.py[line:35] INFO 2.9.0
2024-06-12 17:45:51,648 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:45:57,095 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59-NLAll73 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:45:58,676 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:45:58,677 logger.py[line:35] INFO loading the redis
2024-06-12 17:45:58,679 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:45:58,702 logger.py[line:35] INFO coverage_c=37405
time=16.303027391433716, cov_py=0, cov_c=37405
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59-NLAll73
2024-06-12 17:46:02,888 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59-NLAll73
2024-06-12 17:46:02,888 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:46:02,888 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:46:02,888 logger.py[line:35] INFO after_prediction
2024-06-12 17:46:02,888 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59-NLAll73
2024-06-12 17:46:03,197 logger.py[line:35] INFO INFO: Mutation progress 75/100
2024-06-12 17:46:03,197 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:46:03,197 logger.py[line:35] INFO Score for NLAll is: 0.9016393442622951
2024-06-12 17:46:03,197 logger.py[line:35] INFO Score for Edge is: 0.8953488372093024
2024-06-12 17:46:03,197 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:46:03,197 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:46:03,198 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:46:03,198 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:46:03,198 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:46:03,198 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:46:03,198 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:46:03,198 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:46:03,198 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MDtype39
2024-06-12 17:46:03,198 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:46:07,557 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll')>}
2024-06-12 17:46:08,875 logger.py[line:35] INFO Insert 7 out of 22 Local New Layers
2024-06-12 17:46:08,875 logger.py[line:35] INFO insert GaussianNoise after conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:46:08,875 logger.py[line:35] INFO insert ConvLSTM1D after conv1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:46:08,875 logger.py[line:35] INFO insert ELU after pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:46:08,875 logger.py[line:35] INFO insert ReLU after pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:46:08,875 logger.py[line:35] INFO insert AveragePooling2D after conv4_block5_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:46:08,876 logger.py[line:35] INFO insert ActivityRegularization after pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:46:08,876 logger.py[line:35] INFO insert DepthwiseConv2D after pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:46:08,876 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 3
2024-06-12 17:46:08,879 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [3]
2024-06-12 17:46:08,880 logger.py[line:35] INFO insert ZeroPadding1D after conv3_block4_add_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:46:08,883 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [5]
2024-06-12 17:46:08,884 logger.py[line:35] INFO insert GlobalMaxPooling3D after conv4_block6_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:46:08,887 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [5]
2024-06-12 17:46:08,888 logger.py[line:35] INFO insert MaxPooling3D after conv4_block3_out_copy_LMerg_copy_MShape_copy_MDtype_copy_MDtype_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.convolutional_recurrent.ConvLSTM1D object at 0x7f7eac2581d0>
2024-06-12 17:46:09,038 logger.py[line:35] INFO Converting output shape (None, 3, 3) to actual shape [None, 230, 230, 3]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ReLU object at 0x7f7eac16b3d0>
2024-06-12 17:46:09,091 logger.py[line:35] INFO Converting output shape (None, 114, 114, 64) to actual shape [None, 114, 114, 64]
[DEBUG] Inserting layer: <keras.layers.convolutional.DepthwiseConv2D object at 0x7f7eac121610>
2024-06-12 17:46:09,107 logger.py[line:35] INFO Converting output shape (None, 56, 50, 61) to actual shape [None, 56, 56, 64]
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomDropDimLayer object at 0x7f7eac0f4750>
[DEBUG] Inserting layer: <keras.layers.convolutional.ZeroPadding1D object at 0x7f7e287cbe90>
2024-06-12 17:46:09,563 logger.py[line:35] INFO Converting output shape (None, 33, 512) to actual shape [None, 28, 28, 512]
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomExpandLayer object at 0x7f7e2875c510>
[DEBUG] Inserting layer: <keras.layers.pooling.MaxPooling3D object at 0x7f7e28755550>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 65, in new_layer_addition
    y = layer(layer_input)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1939, in _create_c_op
    raise ValueError(e.message)
ValueError: Exception encountered when calling layer "max_pooling3d_insert" (type MaxPooling3D).

Negative dimension size caused by subtracting 2 from 1 for '{{node max_pooling3d_insert/MaxPool3D}} = MaxPool3D[T=DT_FLOAT, data_format="NDHWC", ksize=[1, 2, 2, 5, 1], padding="VALID", strides=[1, 1, 1, 1, 1]](Placeholder)' with input shapes: [?,1,14,14,1024].

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 1, 14, 14, 1024), dtype=float32)
2024-06-12 17:46:10,392 logger.py[line:35] INFO INFO: Mutation progress 75/100
2024-06-12 17:46:10,393 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:46:10,393 logger.py[line:35] INFO Score for NLAll is: 0.9016393442622951
2024-06-12 17:46:10,393 logger.py[line:35] INFO Score for Edge is: 0.8953488372093024
2024-06-12 17:46:10,393 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:46:10,393 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:46:10,393 logger.py[line:35] INFO Score for MDims is: 0.8484848484848485
2024-06-12 17:46:10,393 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:46:10,393 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:46:10,393 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:46:10,393 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:46:10,393 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:46:10,393 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120-MDims44-MDtype64-Edge69
2024-06-12 17:46:10,393 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:46:13,896 logger.py[line:35] INFO Generating model using MDims
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_copy_MDims')>, 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1': <KerasTensor: shape=(None, 256) dtype=bfloat16 (created by layer 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1_copy_MDims')>, 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2': <KerasTensor: shape=(None, 8, 8, 256) dtype=bfloat16 (created by layer 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_copy_MDims')>, 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1': <KerasTensor: shape=(None, 16384) dtype=float32 (created by layer 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1_copy_MDims')>, 'conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 1, 1, 256) dtype=float32 (created by layer 'conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims')>, 'conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 3, 3, 384) dtype=float32 (created by layer 'conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims')>, 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1_2': <KerasTensor: shape=(None, 8, 8, 96) dtype=bfloat16 (created by layer 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1_2_copy_MDims')>, 'batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 3, 3, 384) dtype=float32 (created by layer 'batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims')>, 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_1': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_1_copy_MDims')>, 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_2': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_2_copy_MDims')>, 'conv2d_5_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 3, 3, 256) dtype=float64 (created by layer 'conv2d_5_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims')>}
2024-06-12 17:46:14,042 logger.py[line:35] INFO Change 2 Layer's Dimension Out Of 3 Layer classes
2024-06-12 17:46:14,042 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 2; Total Layer Class: 3
2024-06-12 17:46:14,042 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:46:14,042 logger.py[line:35] INFO Selecting a Global NDims 5 For Layer flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1_copy_MDims
2024-06-12 17:46:14,042 logger.py[line:35] INFO Changing 1 out of 2 Layer's NDims.
2024-06-12 17:46:14,042 logger.py[line:35] INFO No Global NDims Can Be Found, Randomly Select NDims: 2 For Layer: dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1_2_copy_MDims
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_copy_MDims': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_copy_MDims')>, 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1_copy_MDims': <KerasTensor: shape=(None, 256) dtype=bfloat16 (created by layer 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1_copy_MDims')>, 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_copy_MDims': <KerasTensor: shape=(None, 8, 8, 256) dtype=bfloat16 (created by layer 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_copy_MDims')>, 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1_copy_MDims': <KerasTensor: shape=(None, 16384) dtype=float32 (created by layer 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1_copy_MDims')>, 'conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims': <KerasTensor: shape=(None, 1, 1, 256) dtype=float32 (created by layer 'conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims')>, 'conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims': <KerasTensor: shape=(None, 3, 3, 384) dtype=float32 (created by layer 'conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims')>, 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1_2_copy_MDims': <KerasTensor: shape=(None, 8, 8, 96) dtype=float32 (created by layer 'custom_pad_layer')>, 'batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims': <KerasTensor: shape=(None, 3, 3, 384) dtype=float32 (created by layer 'batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims')>, 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_1_copy_MDims': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_1_copy_MDims')>, 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_2_copy_MDims': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_2_copy_MDims')>, 'conv2d_5_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims': <KerasTensor: shape=(None, 3, 3, 256) dtype=float64 (created by layer 'conv2d_5_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_MDims')>}
2024-06-12 17:46:14,400 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 198/2170
The Configuration Coverage is: 423/2049
The NDims Coverage Is: 73/117
The DType Coverage Is: 72/354
The Shape Coverage Is: 153/295
The Input Coverage Is: 298/766
2024-06-12 17:46:15,420 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:46:19,381 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:46:23,388 logger.py[line:35] INFO 2.9.0
2024-06-12 17:46:24,973 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:46:30,244 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-SpecialI120-MDims44-MDtype64-Edge69-MDims74 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:46:31,890 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:46:31,890 logger.py[line:35] INFO loading the redis
2024-06-12 17:46:31,892 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:46:31,916 logger.py[line:35] INFO coverage_c=37405
time=16.320493936538696, cov_py=0, cov_c=37405
New test requirements invoked on framework tensorflow when updating alexnet-SpecialI120-MDims44-MDtype64-Edge69-MDims74
2024-06-12 17:46:36,227 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-SpecialI120-MDims44-MDtype64-Edge69-MDims74
2024-06-12 17:46:36,227 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:46:36,227 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:46:36,227 logger.py[line:35] INFO after_prediction
2024-06-12 17:46:36,227 logger.py[line:35] INFO New representative seed found: alexnet-SpecialI120-MDims44-MDtype64-Edge69-MDims74
2024-06-12 17:46:36,550 logger.py[line:35] INFO INFO: Mutation progress 76/100
2024-06-12 17:46:36,550 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:46:36,551 logger.py[line:35] INFO Score for NLAll is: 0.9016393442622951
2024-06-12 17:46:36,551 logger.py[line:35] INFO Score for Edge is: 0.8953488372093024
2024-06-12 17:46:36,551 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:46:36,551 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:46:36,551 logger.py[line:35] INFO Score for MDims is: 0.8529411764705882
2024-06-12 17:46:36,551 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:46:36,551 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:46:36,551 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:46:36,551 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:46:36,551 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:46:36,551 logger.py[line:35] INFO Choose seed: densenet121
2024-06-12 17:46:36,551 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:46:41,984 logger.py[line:35] INFO Generating model using MDims
model outputs {'predictions': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MDims')>}
2024-06-12 17:46:43,872 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 1 Layer classes
2024-06-12 17:46:43,873 logger.py[line:35] INFO Global Layer Class: 0; Local Layer Class: 1; Total Layer Class: 1
2024-06-12 17:46:43,873 logger.py[line:35] INFO Changing 0 Layer's NDims.
2024-06-12 17:46:43,873 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:46:43,875 logger.py[line:35] INFO No Global NDims Can Be Found, Randomly Select NDims: 6 For Layer: conv4_block23_0_bn_copy_MDims
model outputs {'predictions_copy_MDims': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MDims')>}
2024-06-12 17:46:46,283 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 198/2170
The Configuration Coverage is: 423/2049
The NDims Coverage Is: 73/117
The DType Coverage Is: 72/354
The Shape Coverage Is: 153/295
The Input Coverage Is: 298/766
2024-06-12 17:46:49,767 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:46:53,634 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:46:57,766 logger.py[line:35] INFO 2.9.0
2024-06-12 17:46:59,334 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:47:13,267 logger.py[line:35] INFO SUCCESS:Get prediction for densenet121-MDims75 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:47:15,056 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 21s
2024-06-12 17:47:15,056 logger.py[line:35] INFO loading the redis
2024-06-12 17:47:15,059 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:47:15,080 logger.py[line:35] INFO coverage_c=37405
time=25.13243579864502, cov_py=0, cov_c=37405
New test requirements invoked on framework tensorflow when updating densenet121-MDims75
2024-06-12 17:47:19,321 logger.py[line:35] INFO Success on backend: tensorflow of model densenet121-MDims75
2024-06-12 17:47:19,321 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:47:19,321 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:47:19,321 logger.py[line:35] INFO after_prediction
2024-06-12 17:47:19,321 logger.py[line:35] INFO New representative seed found: densenet121-MDims75
2024-06-12 17:47:19,792 logger.py[line:35] INFO INFO: Mutation progress 77/100
2024-06-12 17:47:19,792 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:47:19,792 logger.py[line:35] INFO Score for NLAll is: 0.9016393442622951
2024-06-12 17:47:19,792 logger.py[line:35] INFO Score for Edge is: 0.8953488372093024
2024-06-12 17:47:19,792 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:47:19,792 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:47:19,792 logger.py[line:35] INFO Score for MDims is: 0.8428571428571429
2024-06-12 17:47:19,793 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:47:19,793 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:47:19,793 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:47:19,793 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:47:19,793 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:47:19,793 logger.py[line:35] INFO Choose seed: alexnet
2024-06-12 17:47:19,793 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:47:23,205 logger.py[line:35] INFO Generating model using Edge
model outputs {'dense_3': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_Edge')>}
Choosing 1 To Insert
2024-06-12 17:47:23,294 logger.py[line:35] INFO Insert 1 Local New Edges
2024-06-12 17:47:23,294 logger.py[line:35] INFO Candidate Edge: ('Conv2D', 'Dropout')
2024-06-12 17:47:23,385 logger.py[line:35] INFO Trying Adding Edge: ['Conv2D', 'Dropout'] by Connecting conv2d_3_copy_Edge and dropout_2_copy_Edge
2024-06-12 17:47:23,472 logger.py[line:35] INFO Successfully Add Edge: ['Conv2D', 'Dropout'] by Connecting conv2d_3_copy_Edge and dropout_2_copy_Edge
2024-06-12 17:47:23,510 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 198/2170
The Configuration Coverage is: 423/2049
The NDims Coverage Is: 73/117
The DType Coverage Is: 72/354
The Shape Coverage Is: 153/295
The Input Coverage Is: 298/766
2024-06-12 17:47:24,415 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:47:28,270 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:47:32,296 logger.py[line:35] INFO 2.9.0
2024-06-12 17:47:33,888 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:47:37,905 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-Edge76 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:47:39,529 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 17:47:39,530 logger.py[line:35] INFO loading the redis
2024-06-12 17:47:39,532 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:47:39,554 logger.py[line:35] INFO coverage_c=37405
time=14.961962223052979, cov_py=0, cov_c=37405
New test requirements invoked on framework tensorflow when updating alexnet-Edge76
2024-06-12 17:47:43,844 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-Edge76
2024-06-12 17:47:43,845 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:47:43,845 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:47:43,845 logger.py[line:35] INFO after_prediction
2024-06-12 17:47:43,845 logger.py[line:35] INFO New representative seed found: alexnet-Edge76
2024-06-12 17:47:44,151 logger.py[line:35] INFO INFO: Mutation progress 78/100
2024-06-12 17:47:44,152 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:47:44,152 logger.py[line:35] INFO Score for NLAll is: 0.9016393442622951
2024-06-12 17:47:44,152 logger.py[line:35] INFO Score for Edge is: 0.8863636363636364
2024-06-12 17:47:44,152 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:47:44,152 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:47:44,152 logger.py[line:35] INFO Score for MDims is: 0.8428571428571429
2024-06-12 17:47:44,152 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:47:44,152 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:47:44,152 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:47:44,152 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:47:44,152 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:47:44,152 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120-MDims44-MDtype60
2024-06-12 17:47:44,152 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:47:47,614 logger.py[line:35] INFO Generating model using MDims
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims')>}
2024-06-12 17:47:47,718 logger.py[line:35] INFO Change 2 Layer's Dimension Out Of 3 Layer classes
2024-06-12 17:47:47,718 logger.py[line:35] INFO Global Layer Class: 0; Local Layer Class: 3; Total Layer Class: 3
2024-06-12 17:47:47,718 logger.py[line:35] INFO Changing 0 Layer's NDims.
2024-06-12 17:47:47,718 logger.py[line:35] INFO Changing 2 out of 3 Layer's NDims.
2024-06-12 17:47:47,718 logger.py[line:35] INFO No Global NDims Can Be Found, Randomly Select NDims: 6 For Layer: dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims
2024-06-12 17:47:47,719 logger.py[line:35] INFO No Global NDims Can Be Found, Randomly Select NDims: 5 For Layer: flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims')>}
2024-06-12 17:47:47,946 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 198/2170
The Configuration Coverage is: 423/2049
The NDims Coverage Is: 73/117
The DType Coverage Is: 72/354
The Shape Coverage Is: 153/295
The Input Coverage Is: 298/766
2024-06-12 17:47:48,877 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:47:52,757 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:47:56,829 logger.py[line:35] INFO 2.9.0
2024-06-12 17:47:58,432 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:48:02,929 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-SpecialI120-MDims44-MDtype60-MDims77 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:48:04,568 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 17:48:04,568 logger.py[line:35] INFO loading the redis
2024-06-12 17:48:04,571 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:48:04,593 logger.py[line:35] INFO coverage_c=37405
time=15.534791946411133, cov_py=0, cov_c=37405
New test requirements invoked on framework tensorflow when updating alexnet-SpecialI120-MDims44-MDtype60-MDims77
2024-06-12 17:48:08,871 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-SpecialI120-MDims44-MDtype60-MDims77
2024-06-12 17:48:08,871 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:48:08,871 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:48:08,871 logger.py[line:35] INFO after_prediction
2024-06-12 17:48:08,871 logger.py[line:35] INFO New representative seed found: alexnet-SpecialI120-MDims44-MDtype60-MDims77
2024-06-12 17:48:09,176 logger.py[line:35] INFO INFO: Mutation progress 79/100
2024-06-12 17:48:09,176 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:48:09,176 logger.py[line:35] INFO Score for NLAll is: 0.9016393442622951
2024-06-12 17:48:09,177 logger.py[line:35] INFO Score for Edge is: 0.8863636363636364
2024-06-12 17:48:09,177 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:48:09,177 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:48:09,177 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:48:09,177 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:48:09,177 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:48:09,177 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:48:09,177 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:48:09,177 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:48:09,177 logger.py[line:35] INFO Choose seed: resnet50-Edge65-MDtype58
2024-06-12 17:48:09,177 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:48:13,417 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_Edge_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_Edge')>, 'cropping2d_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'cropping2d_copy_MDtype_copy_Edge')>, 'avg_pool_copy_Edge_2_copy_MDtype': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype_copy_Edge')>}
Choosing 2 To Insert
2024-06-12 17:48:14,392 logger.py[line:35] INFO Insert 2 Global New Edges
2024-06-12 17:48:14,392 logger.py[line:35] INFO Candidate Edge: ('Cropping2D', 'MaxPooling2D')
2024-06-12 17:48:15,373 logger.py[line:35] INFO Trying Adding Edge: ['Cropping2D', 'MaxPooling2D'] by Connecting cropping2d_copy_MDtype_copy_Edge and pool1_pool_copy_Edge_copy_MDtype_copy_Edge
2024-06-12 17:48:16,258 logger.py[line:35] INFO Successfully Add Edge: ['Cropping2D', 'MaxPooling2D'] by Connecting cropping2d_copy_MDtype_copy_Edge and pool1_pool_copy_Edge_copy_MDtype_copy_Edge
2024-06-12 17:48:16,259 logger.py[line:35] INFO Candidate Edge: ('Cropping2D', 'ZeroPadding2D')
2024-06-12 17:48:17,427 logger.py[line:35] INFO Trying Adding Edge: ['Cropping2D', 'ZeroPadding2D'] by Connecting cropping2d_copy_MDtype_copy_Edge and pool1_pad_copy_Edge_copy_MDtype_copy_Edge
2024-06-12 17:48:18,333 logger.py[line:35] INFO Successfully Add Edge: ['Cropping2D', 'ZeroPadding2D'] by Connecting cropping2d_copy_MDtype_copy_Edge and pool1_pad_copy_Edge_copy_MDtype_copy_Edge
2024-06-12 17:48:18,435 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 200/2170
The Configuration Coverage is: 423/2049
The NDims Coverage Is: 73/117
The DType Coverage Is: 72/354
The Shape Coverage Is: 153/295
The Input Coverage Is: 298/766
2024-06-12 17:48:20,385 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:48:24,225 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:48:28,355 logger.py[line:35] INFO 2.9.0
2024-06-12 17:48:29,926 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:48:38,462 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-Edge65-MDtype58-Edge78 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:48:40,140 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 15s
2024-06-12 17:48:40,140 logger.py[line:35] INFO loading the redis
2024-06-12 17:48:40,143 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:48:40,165 logger.py[line:35] INFO coverage_c=37405
time=19.60204005241394, cov_py=0, cov_c=37405
New test requirements invoked on framework tensorflow when updating resnet50-Edge65-MDtype58-Edge78
2024-06-12 17:48:44,874 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-Edge65-MDtype58-Edge78
2024-06-12 17:48:44,874 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:48:44,874 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:48:44,874 logger.py[line:35] INFO after_prediction
2024-06-12 17:48:44,874 logger.py[line:35] INFO New representative seed found: resnet50-Edge65-MDtype58-Edge78
2024-06-12 17:48:45,279 logger.py[line:35] INFO INFO: Mutation progress 80/100
2024-06-12 17:48:45,279 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:48:45,279 logger.py[line:35] INFO Score for NLAll is: 0.9016393442622951
2024-06-12 17:48:45,280 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:48:45,280 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:48:45,280 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:48:45,280 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:48:45,280 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:48:45,280 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:48:45,280 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:48:45,280 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:48:45,280 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:48:45,280 logger.py[line:35] INFO Choose seed: densenet121-SpecialI57
2024-06-12 17:48:45,280 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:48:50,703 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_SpecialI_copy_NLAll')>}
2024-06-12 17:48:53,203 logger.py[line:35] INFO Insert 9 out of 25 Local New Layers
2024-06-12 17:48:53,204 logger.py[line:35] INFO insert ConvLSTM1D after pool4_pool_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,204 logger.py[line:35] INFO insert Conv2DTranspose after conv4_block13_2_conv_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,204 logger.py[line:35] INFO insert Softmax after pool4_pool_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,205 logger.py[line:35] INFO insert GaussianDropout after conv4_block9_0_bn_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,205 logger.py[line:35] INFO insert GlobalAveragePooling2D after pool4_pool_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,205 logger.py[line:35] INFO insert DepthwiseConv2D after pool2_pool_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,205 logger.py[line:35] INFO insert ELU after avg_pool_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,205 logger.py[line:35] INFO insert ThresholdedReLU after pool2_pool_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,205 logger.py[line:35] INFO insert ZeroPadding2D after pool2_pool_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,205 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 4
2024-06-12 17:48:53,213 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [3]
2024-06-12 17:48:53,215 logger.py[line:35] INFO insert AveragePooling1D after conv4_block7_0_relu_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,237 logger.py[line:35] INFO insert ELU after conv5_block4_0_relu_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,245 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [3]
2024-06-12 17:48:53,246 logger.py[line:35] INFO insert LocallyConnected1D after conv3_block2_0_bn_copy_SpecialI_copy_NLAll
2024-06-12 17:48:53,254 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [3]
2024-06-12 17:48:53,255 logger.py[line:35] INFO insert Cropping1D after conv5_block4_2_conv_copy_SpecialI_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.convolutional.ZeroPadding2D object at 0x7f56585b3110>
2024-06-12 17:48:53,488 logger.py[line:35] INFO Converting output shape (None, 32, 34, 128) to actual shape [None, 28, 28, 128]
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomDropDimLayer object at 0x7f56b8320bd0>
[DEBUG] Inserting layer: <keras.layers.local.LocallyConnected1D object at 0x7f56c75ec290>
2024-06-12 17:48:53,841 deprecation.py[line:347] WARNING From /opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3686: sparse_mat_mul (from tensorflow.python.ops.gen_math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.linalg.matmul` instead
2024-06-12 17:48:53,855 logger.py[line:35] INFO Converting output shape (None, 10, 160) to actual shape [None, 28, 28, 160]
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomDropDimLayer object at 0x7f56585d58d0>
[DEBUG] Inserting layer: <keras.layers.pooling.AveragePooling1D object at 0x7f56585d5650>
2024-06-12 17:48:54,457 logger.py[line:35] INFO Converting output shape (None, 14, 448) to actual shape [None, 14, 14, 448]
[DEBUG] Inserting layer: <keras.layers.noise.GaussianDropout object at 0x7f565832f390>
2024-06-12 17:48:54,524 logger.py[line:35] INFO Converting output shape (None, 14, 14, 512) to actual shape [None, 14, 14, 512]
[DEBUG] Inserting layer: <keras.layers.convolutional.Conv2DTranspose object at 0x7f56582a9e50>
2024-06-12 17:48:54,682 logger.py[line:35] INFO Converting output shape (None, 14, 14, 32) to actual shape [None, 14, 14, 32]
[DEBUG] Inserting layer: <keras.layers.pooling.GlobalAveragePooling2D object at 0x7f565816e3d0>
2024-06-12 17:48:55,034 logger.py[line:35] INFO Converting output shape (None, 512) to actual shape [None, 7, 7, 512]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ELU object at 0x7f565812de50>
2024-06-12 17:48:55,145 logger.py[line:35] INFO Converting output shape (None, 7, 7, 608) to actual shape [None, 7, 7, 608]
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomDropDimLayer object at 0x7f565811f2d0>
[DEBUG] Inserting layer: <keras.layers.convolutional.Cropping1D object at 0x7f5658151750>
2024-06-12 17:48:55,169 logger.py[line:35] INFO Converting output shape (None, 5, 32) to actual shape [None, 7, 7, 32]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ELU object at 0x7f56580184d0>
2024-06-12 17:48:55,553 logger.py[line:35] INFO Converting output shape (None, 1024) to actual shape [None, 1024]
model outputs {'predictions_copy_SpecialI_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_SpecialI_copy_NLAll')>}
2024-06-12 17:48:55,747 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 206/2170
The Configuration Coverage is: 444/2049
The NDims Coverage Is: 74/117
The DType Coverage Is: 74/354
The Shape Coverage Is: 156/295
The Input Coverage Is: 304/766
2024-06-12 17:48:59,304 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:49:03,157 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:49:07,327 logger.py[line:35] INFO 2.9.0
2024-06-12 17:49:08,890 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:49:23,757 logger.py[line:35] INFO SUCCESS:Get prediction for densenet121-SpecialI57-NLAll79 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:49:25,578 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 22s
2024-06-12 17:49:25,578 logger.py[line:35] INFO loading the redis
2024-06-12 17:49:25,582 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:49:25,603 logger.py[line:35] INFO coverage_c=37438
time=26.122314453125, cov_py=0, cov_c=37438
New test requirements invoked on framework tensorflow when updating densenet121-SpecialI57-NLAll79
2024-06-12 17:49:29,877 logger.py[line:35] INFO Success on backend: tensorflow of model densenet121-SpecialI57-NLAll79
2024-06-12 17:49:29,877 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:49:29,877 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:49:29,877 logger.py[line:35] INFO after_prediction
2024-06-12 17:49:29,877 logger.py[line:35] INFO New representative seed found: densenet121-SpecialI57-NLAll79
2024-06-12 17:49:30,358 logger.py[line:35] INFO INFO: Mutation progress 81/100
2024-06-12 17:49:30,359 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:49:30,359 logger.py[line:35] INFO Score for NLAll is: 0.9032258064516129
2024-06-12 17:49:30,359 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:49:30,359 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:49:30,359 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:49:30,359 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:49:30,359 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:49:30,359 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:49:30,359 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:49:30,359 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:49:30,359 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:49:30,359 logger.py[line:35] INFO Choose seed: lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32
2024-06-12 17:49:30,359 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:49:34,021 logger.py[line:35] INFO Generating model using NLAll
model outputs {'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_NLAll')>, 'cropping1d_copy_LMerg': <KerasTensor: shape=(None, 10, 2) dtype=float32 (created by layer 'cropping1d_copy_LMerg_copy_NLAll')>, 'dot_copy_ML': <KerasTensor: shape=(None, 10, 10, 10, 10) dtype=float32 (created by layer 'dot_copy_ML_copy_NLAll')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1_copy_LMerg': <KerasTensor: shape=(None, 14, 14, 6) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1_copy_LMerg_copy_NLAll')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg_copy_NLAll')>, 'elu_insert_copy_Edge_1_2_1_copy_LMerg': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'elu_insert_copy_Edge_1_2_1_copy_LMerg_copy_NLAll')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1_copy_LMerg': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1_copy_LMerg_copy_NLAll')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2_copy_LMerg': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2_copy_LMerg_copy_NLAll')>, 'cropping1d_1_copy_LMerg': <KerasTensor: shape=(None, 10, 2) dtype=float32 (created by layer 'cropping1d_1_copy_LMerg_copy_NLAll')>}
2024-06-12 17:49:34,229 logger.py[line:35] INFO Insert 2 out of 8 Global New Layers
2024-06-12 17:49:34,229 logger.py[line:35] INFO insert Bidirectional after elu_insert_copy_Edge_1_2_2_copy_LMerg_copy_NLAll
2024-06-12 17:49:34,229 logger.py[line:35] INFO insert GlobalAveragePooling1D after elu_insert_copy_Edge_1_2_2_copy_LMerg_copy_NLAll
2024-06-12 17:49:34,229 logger.py[line:35] INFO Insert 1 out of 39 Local New Layers
2024-06-12 17:49:34,230 logger.py[line:35] INFO insert MaxPooling2D after leaky_re_lu_insert_copy_NLAll_copy_Edge_1_1_copy_LMerg_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.pooling.MaxPooling2D object at 0x7fd3f0269150>
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 65, in new_layer_addition
    y = layer(layer_input)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1939, in _create_c_op
    raise ValueError(e.message)
ValueError: Exception encountered when calling layer "max_pooling2d_insert" (type MaxPooling2D).

Negative dimension size caused by subtracting 6 from 5 for '{{node max_pooling2d_insert/MaxPool}} = MaxPool[T=DT_FLOAT, data_format="NHWC", explicit_paddings=[], ksize=[1, 6, 9, 1], padding="VALID", strides=[1, 1, 1, 1]](Placeholder)' with input shapes: [?,5,5,16].

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 5, 5, 16), dtype=float32)
2024-06-12 17:49:34,736 logger.py[line:35] INFO INFO: Mutation progress 81/100
2024-06-12 17:49:34,736 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:49:34,736 logger.py[line:35] INFO Score for NLAll is: 0.9032258064516129
2024-06-12 17:49:34,737 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:49:34,737 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:49:34,737 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:49:34,737 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:49:34,737 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:49:34,737 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:49:34,737 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:49:34,737 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:49:34,737 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:49:34,737 logger.py[line:35] INFO Choose seed: densenet121-SpecialI57
2024-06-12 17:49:34,737 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:49:40,220 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_SpecialI': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_SpecialI_copy_NLAll')>}
2024-06-12 17:49:42,698 logger.py[line:35] INFO Insert 7 out of 23 Local New Layers
2024-06-12 17:49:42,699 logger.py[line:35] INFO insert ThresholdedReLU after pool1_copy_SpecialI_copy_NLAll
2024-06-12 17:49:42,699 logger.py[line:35] INFO insert LeakyReLU after conv4_block17_1_bn_copy_SpecialI_copy_NLAll
2024-06-12 17:49:42,699 logger.py[line:35] INFO insert GaussianNoise after avg_pool_copy_SpecialI_copy_NLAll
2024-06-12 17:49:42,700 logger.py[line:35] INFO insert PReLU after conv4_block20_2_conv_copy_SpecialI_copy_NLAll
2024-06-12 17:49:42,700 logger.py[line:35] INFO insert LayerNormalization after conv4_block20_2_conv_copy_SpecialI_copy_NLAll
2024-06-12 17:49:42,700 logger.py[line:35] INFO insert SeparableConv2D after conv5_block8_0_bn_copy_SpecialI_copy_NLAll
2024-06-12 17:49:42,700 logger.py[line:35] INFO insert ConvLSTM1D after zero_padding2d_1_copy_SpecialI_copy_NLAll
2024-06-12 17:49:42,700 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 1
2024-06-12 17:49:42,708 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [5]
2024-06-12 17:49:42,709 logger.py[line:35] INFO insert ZeroPadding3D after conv5_block2_concat_copy_SpecialI_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.convolutional_recurrent.ConvLSTM1D object at 0x7f6ff8210910>
2024-06-12 17:49:42,864 logger.py[line:35] INFO Converting output shape (None, 230, 3) to actual shape [None, 230, 230, 3]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.ThresholdedReLU object at 0x7f6ff80adfd0>
2024-06-12 17:49:43,132 logger.py[line:35] INFO Converting output shape (None, 56, 56, 64) to actual shape [None, 56, 56, 64]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.LeakyReLU object at 0x7f6fb071a450>
2024-06-12 17:49:44,219 logger.py[line:35] INFO Converting output shape (None, 14, 14, 128) to actual shape [None, 14, 14, 128]
[DEBUG] Inserting layer: <keras.layers.normalization.layer_normalization.LayerNormalization object at 0x7f6fb068ed50>
2024-06-12 17:49:44,353 logger.py[line:35] INFO Converting output shape (None, 14, 14, 32) to actual shape [None, 14, 14, 32]
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomExpandLayer object at 0x7f6fb05fae90>
[DEBUG] Inserting layer: <keras.layers.convolutional.ZeroPadding3D object at 0x7f6fb0669e10>
2024-06-12 17:49:44,571 logger.py[line:35] INFO Converting output shape (None, 5, 11, 15, 576) to actual shape [None, 7, 7, 576]
[DEBUG] Inserting layer: <keras.layers.convolutional.SeparableConv2D object at 0x7f6fb05d9450>
2024-06-12 17:49:44,925 logger.py[line:35] INFO Converting output shape (None, 736, 5, 736) to actual shape [None, 7, 7, 736]
[DEBUG] Inserting layer: <keras.layers.noise.GaussianNoise object at 0x7f6fb045a2d0>
2024-06-12 17:49:45,217 logger.py[line:35] INFO Converting output shape (None, 1024) to actual shape [None, 1024]
model outputs {'predictions_copy_SpecialI_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_SpecialI_copy_NLAll')>}
2024-06-12 17:49:45,417 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 76/117
The DType Coverage Is: 75/354
The Shape Coverage Is: 161/295
The Input Coverage Is: 312/766
2024-06-12 17:49:49,104 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:49:53,004 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:49:57,137 logger.py[line:35] INFO 2.9.0
2024-06-12 17:49:58,736 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:50:15,311 logger.py[line:35] INFO SUCCESS:Get prediction for densenet121-SpecialI57-NLAll80 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:50:17,178 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 24s
2024-06-12 17:50:17,178 logger.py[line:35] INFO loading the redis
2024-06-12 17:50:17,181 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:50:17,202 logger.py[line:35] INFO coverage_c=37496
time=27.917392253875732, cov_py=0, cov_c=37496
New test requirements invoked on framework tensorflow when updating densenet121-SpecialI57-NLAll80
2024-06-12 17:50:21,537 logger.py[line:35] INFO Success on backend: tensorflow of model densenet121-SpecialI57-NLAll80
2024-06-12 17:50:21,537 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:50:21,537 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:50:21,538 logger.py[line:35] INFO after_prediction
2024-06-12 17:50:21,538 logger.py[line:35] INFO New representative seed found: densenet121-SpecialI57-NLAll80
2024-06-12 17:50:22,031 logger.py[line:35] INFO INFO: Mutation progress 82/100
2024-06-12 17:50:22,031 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:50:22,031 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:50:22,031 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:50:22,032 logger.py[line:35] INFO Score for MDtype is: 0.8636363636363636
2024-06-12 17:50:22,032 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:50:22,032 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:50:22,032 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:50:22,032 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:50:22,032 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:50:22,032 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:50:22,032 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:50:22,032 logger.py[line:35] INFO Choose seed: inception.resnet.v2-MParam50-MDtype52-MDtype102
2024-06-12 17:50:22,032 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:50:29,518 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_MParam_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype')>}
2024-06-12 17:50:33,176 logger.py[line:35] INFO Change 3 Layer's DType Out Of 5 Layer classes
2024-06-12 17:50:33,176 logger.py[line:35] INFO Changing 3 out of 5 Layer's DType.
2024-06-12 17:50:33,178 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer avg_pool_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype
2024-06-12 17:50:33,180 logger.py[line:35] INFO Selecting a Global DType half For Layer batch_normalization_64_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype
2024-06-12 17:50:33,182 logger.py[line:35] INFO Selecting a Global DType float64 For Layer max_pooling2d_3_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype
model outputs {'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype')>}
2024-06-12 17:50:36,990 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 76/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 161/295
The Input Coverage Is: 313/766
2024-06-12 17:50:43,160 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:50:47,009 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:50:51,240 logger.py[line:35] INFO 2.9.0
2024-06-12 17:50:52,810 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:51:16,048 logger.py[line:35] INFO SUCCESS:Get prediction for inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype81 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:51:18,044 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 31s
2024-06-12 17:51:18,044 logger.py[line:35] INFO loading the redis
2024-06-12 17:51:18,046 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:51:18,068 logger.py[line:35] INFO coverage_c=37497
time=34.730284690856934, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype81
2024-06-12 17:51:22,306 logger.py[line:35] INFO Success on backend: tensorflow of model inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype81
2024-06-12 17:51:22,306 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:51:22,306 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:51:22,306 logger.py[line:35] INFO after_prediction
2024-06-12 17:51:22,306 logger.py[line:35] INFO New representative seed found: inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype81
2024-06-12 17:51:22,913 logger.py[line:35] INFO INFO: Mutation progress 83/100
2024-06-12 17:51:22,913 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:51:22,913 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:51:22,914 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:51:22,914 logger.py[line:35] INFO Score for MDtype is: 0.8660714285714286
2024-06-12 17:51:22,914 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:51:22,914 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:51:22,914 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:51:22,914 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:51:22,914 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:51:22,914 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:51:22,914 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:51:22,914 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67
2024-06-12 17:51:22,914 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:51:27,397 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>}
2024-06-12 17:51:28,504 logger.py[line:35] INFO Change 2 Layer's DType Out Of 6 Layer classes
2024-06-12 17:51:28,504 logger.py[line:35] INFO Changing 2 out of 6 Layer's DType.
2024-06-12 17:51:28,505 logger.py[line:35] INFO Selecting a Global DType float32 For Layer pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype
2024-06-12 17:51:28,505 logger.py[line:35] INFO Selecting a Global DType half For Layer conv3_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>, 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype')>}
2024-06-12 17:51:29,632 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 76/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 161/295
The Input Coverage Is: 313/766
2024-06-12 17:51:31,821 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:51:35,681 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:51:39,805 logger.py[line:35] INFO 2.9.0
2024-06-12 17:51:41,393 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:51:51,152 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67-MDtype82 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:51:52,847 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 17s
2024-06-12 17:51:52,847 logger.py[line:35] INFO loading the redis
2024-06-12 17:51:52,850 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:51:52,872 logger.py[line:35] INFO coverage_c=37497
time=20.871607303619385, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67-MDtype82
2024-06-12 17:51:57,148 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67-MDtype82
2024-06-12 17:51:57,148 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:51:57,148 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:51:57,148 logger.py[line:35] INFO after_prediction
2024-06-12 17:51:57,148 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67-MDtype82
2024-06-12 17:51:57,535 logger.py[line:35] INFO INFO: Mutation progress 84/100
2024-06-12 17:51:57,535 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:51:57,535 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:51:57,535 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:51:57,535 logger.py[line:35] INFO Score for MDtype is: 0.8596491228070176
2024-06-12 17:51:57,535 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:51:57,535 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:51:57,535 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:51:57,535 logger.py[line:35] INFO Score for MShape is: 0.6875
2024-06-12 17:51:57,535 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:51:57,535 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:51:57,535 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:51:57,536 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61
2024-06-12 17:51:57,536 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:52:02,403 logger.py[line:35] INFO Generating model using MShape
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MShape')>, 'elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 14, 13, 1017) dtype=float32 (created by layer 'elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>, 'softmax_insert_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 7, 7, 512) dtype=float32 (created by layer 'softmax_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>, 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 3, 6, 2052) dtype=float16 (created by layer 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>, 'cropping2d': <KerasTensor: shape=(None, 10, 10, 258) dtype=float32 (created by layer 'cropping2d_copy_MShape')>, 'conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 14, 14, 256) dtype=float32 (created by layer 'conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>, 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>}
2024-06-12 17:52:03,516 logger.py[line:35] INFO Change 2 Layer's Shape Out Of 20 Layer classes
2024-06-12 17:52:03,516 logger.py[line:35] INFO Changing 2 out of 7 Layer's Shape.
2024-06-12 17:52:03,517 logger.py[line:35] INFO [Globally] Changing The Input Shape Of Layer: activity_regularization_insert_copy_NLAll_copy_NLAll_copy_Edge_copy_MShape From [None, 56, 56, 64] To [None, 9, 5, 9]
2024-06-12 17:52:03,518 logger.py[line:35] INFO [Globally] Changing The Input Shape Of Layer: spatial_dropout2d_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_1_copy_MShape From [None, 56, 56, 256] To [None, 2, 9, 0]
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MShape': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MShape')>, 'elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape': <KerasTensor: shape=(None, 14, 13, 1017) dtype=float32 (created by layer 'elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>, 'softmax_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape': <KerasTensor: shape=(None, 7, 7, 512) dtype=float32 (created by layer 'softmax_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>, 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape': <KerasTensor: shape=(None, 3, 6, 2052) dtype=float16 (created by layer 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>, 'cropping2d_copy_MShape': <KerasTensor: shape=(None, 10, 10, 258) dtype=float32 (created by layer 'cropping2d_copy_MShape')>, 'conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape': <KerasTensor: shape=(None, 14, 14, 256) dtype=float32 (created by layer 'conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>, 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MShape')>}
2024-06-12 17:52:04,897 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 76/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 163/295
The Input Coverage Is: 315/766
2024-06-12 17:52:07,427 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:52:11,316 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:52:15,445 logger.py[line:35] INFO 2.9.0
2024-06-12 17:52:17,025 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:52:27,979 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61-MShape83 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:52:29,733 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 18s
2024-06-12 17:52:29,733 logger.py[line:35] INFO loading the redis
2024-06-12 17:52:29,736 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:52:29,758 logger.py[line:35] INFO coverage_c=37497
time=22.152422428131104, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61-MShape83
2024-06-12 17:52:34,097 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61-MShape83
2024-06-12 17:52:34,097 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:52:34,097 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:52:34,097 logger.py[line:35] INFO after_prediction
2024-06-12 17:52:34,097 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61-MShape83
2024-06-12 17:52:34,490 logger.py[line:35] INFO INFO: Mutation progress 85/100
2024-06-12 17:52:34,491 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:52:34,491 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:52:34,491 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:52:34,491 logger.py[line:35] INFO Score for MDtype is: 0.8596491228070176
2024-06-12 17:52:34,491 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:52:34,491 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:52:34,491 logger.py[line:35] INFO Score for LMerg is: 0.8235294117647058
2024-06-12 17:52:34,491 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:52:34,491 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:52:34,491 logger.py[line:35] INFO The last used seed is: MShape
2024-06-12 17:52:34,491 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:52:34,491 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MParam115-MDims8-NLAll25
2024-06-12 17:52:34,491 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:52:37,500 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:52:38,222 logger.py[line:35] INFO Generating model using LMerg
2024-06-12 17:52:38,225 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:52:38,431 logger.py[line:35] INFO Insert 1 out of 8 Local New Layer
2024-06-12 17:52:38,431 logger.py[line:35] INFO Trying Merge Layers: custom_drop_dim_layer_2_copy_NLAll_copy_LMerg and custom_crop_layer_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll_copy_LMerg by Average
2024-06-12 17:52:38,437 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll_copy_LMerg will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:52:38,667 logger.py[line:35] INFO Success on Merge Layers: custom_drop_dim_layer_2_copy_NLAll_copy_LMerg and custom_crop_layer_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll_copy_LMerg by Average
2024-06-12 17:52:38,689 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:52:39,340 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MParam_copy_MDims_copy_NLAll_copy_LMerg will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 76/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 163/295
The Input Coverage Is: 315/766
2024-06-12 17:52:39,574 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:52:43,457 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:52:47,473 logger.py[line:35] INFO 2.9.0
2024-06-12 17:52:49,043 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:52:53,904 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MParam115-MDims8-NLAll25-LMerg84 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:52:55,517 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:52:55,517 logger.py[line:35] INFO loading the redis
2024-06-12 17:52:55,521 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:52:55,542 logger.py[line:35] INFO coverage_c=37497
time=15.79093337059021, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MParam115-MDims8-NLAll25-LMerg84
2024-06-12 17:52:59,839 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MParam115-MDims8-NLAll25-LMerg84
2024-06-12 17:52:59,839 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:52:59,839 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:52:59,839 logger.py[line:35] INFO after_prediction
2024-06-12 17:52:59,839 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MParam115-MDims8-NLAll25-LMerg84
2024-06-12 17:53:00,170 logger.py[line:35] INFO INFO: Mutation progress 86/100
2024-06-12 17:53:00,170 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:53:00,170 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:53:00,170 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:53:00,170 logger.py[line:35] INFO Score for MDtype is: 0.8596491228070176
2024-06-12 17:53:00,170 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:53:00,170 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:53:00,170 logger.py[line:35] INFO Score for LMerg is: 0.8055555555555556
2024-06-12 17:53:00,170 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:53:00,170 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:53:00,170 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:53:00,171 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:53:00,171 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120-MDims44-MDtype64-Edge69
2024-06-12 17:53:00,171 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:53:03,735 logger.py[line:35] INFO Generating model using LMerg
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_copy_LMerg')>, 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1': <KerasTensor: shape=(None, 256) dtype=bfloat16 (created by layer 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1_copy_LMerg')>, 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2': <KerasTensor: shape=(None, 8, 8, 256) dtype=bfloat16 (created by layer 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_copy_LMerg')>, 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1': <KerasTensor: shape=(None, 16384) dtype=float32 (created by layer 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_1_copy_LMerg')>, 'conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 1, 1, 256) dtype=float32 (created by layer 'conv2d_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_LMerg')>, 'conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 3, 3, 384) dtype=float32 (created by layer 'conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_LMerg')>, 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1_2': <KerasTensor: shape=(None, 8, 8, 96) dtype=bfloat16 (created by layer 'dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_1_2_copy_LMerg')>, 'batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 3, 3, 384) dtype=float32 (created by layer 'batch_normalization_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_LMerg')>, 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_1': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_1_copy_LMerg')>, 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_2': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'flatten_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_2_2_copy_LMerg')>, 'conv2d_5_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2': <KerasTensor: shape=(None, 3, 3, 256) dtype=float64 (created by layer 'conv2d_5_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_LMerg')>}
Choosing Mutation Ratio Between 1 and 2
2024-06-12 17:53:03,897 logger.py[line:35] INFO Insert 1 out of 8 Local New Layer
2024-06-12 17:53:03,898 logger.py[line:35] INFO Trying Merge Layers: conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_LMerg and custom_cast_layer_copy_Edge_copy_LMerg by Minimum
2024-06-12 17:53:04,047 logger.py[line:35] INFO Success on Merge Layers: conv2d_4_copy_SpecialI_copy_MDims_copy_MDtype_copy_Edge_2_copy_LMerg and custom_cast_layer_copy_Edge_copy_LMerg by Minimum
2024-06-12 17:53:04,152 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 76/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 163/295
The Input Coverage Is: 315/766
2024-06-12 17:53:05,176 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:53:09,203 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:53:13,193 logger.py[line:35] INFO 2.9.0
2024-06-12 17:53:14,782 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:53:19,684 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-SpecialI120-MDims44-MDtype64-Edge69-LMerg85 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:53:21,313 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:53:21,313 logger.py[line:35] INFO loading the redis
2024-06-12 17:53:21,316 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:53:21,339 logger.py[line:35] INFO coverage_c=37497
time=15.988059997558594, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating alexnet-SpecialI120-MDims44-MDtype64-Edge69-LMerg85
2024-06-12 17:53:25,540 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-SpecialI120-MDims44-MDtype64-Edge69-LMerg85
2024-06-12 17:53:25,540 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:53:25,540 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:53:25,540 logger.py[line:35] INFO after_prediction
2024-06-12 17:53:25,540 logger.py[line:35] INFO New representative seed found: alexnet-SpecialI120-MDims44-MDtype64-Edge69-LMerg85
2024-06-12 17:53:25,858 logger.py[line:35] INFO INFO: Mutation progress 87/100
2024-06-12 17:53:25,858 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:53:25,858 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:53:25,858 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:53:25,858 logger.py[line:35] INFO Score for MDtype is: 0.8596491228070176
2024-06-12 17:53:25,858 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:53:25,858 logger.py[line:35] INFO Score for MDims is: 0.8333333333333334
2024-06-12 17:53:25,858 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:53:25,858 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:53:25,858 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:53:25,858 logger.py[line:35] INFO The last used seed is: LMerg
2024-06-12 17:53:25,859 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:53:25,859 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59-NLAll73
2024-06-12 17:53:25,859 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:53:28,876 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:53:29,708 logger.py[line:35] INFO Generating model using MDims
2024-06-12 17:53:29,713 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll_copy_MDims')>}
2024-06-12 17:53:29,972 logger.py[line:35] INFO Change 1 Layer's Dimension Out Of 3 Layer classes
2024-06-12 17:53:29,972 logger.py[line:35] INFO Global Layer Class: 1; Local Layer Class: 2; Total Layer Class: 3
2024-06-12 17:53:29,972 logger.py[line:35] INFO Changing 1 Layer's NDims.
2024-06-12 17:53:29,972 logger.py[line:35] INFO Selecting a Global NDims 5 For Layer p_re_lu_insert_copy_MDims
2024-06-12 17:53:29,978 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll_copy_MDims')>}
2024-06-12 17:53:30,344 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:53:30,960 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_SpecialI_copy_MDtype_copy_MDtype_copy_SpecialI_copy_NLAll_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 77/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 164/295
The Input Coverage Is: 317/766
2024-06-12 17:53:31,248 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:53:35,240 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:53:39,226 logger.py[line:35] INFO 2.9.0
2024-06-12 17:53:40,798 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:53:46,296 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59-NLAll73-MDims86 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:53:47,901 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:53:47,902 logger.py[line:35] INFO loading the redis
2024-06-12 17:53:47,905 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:53:47,926 logger.py[line:35] INFO coverage_c=37497
time=16.50215721130371, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59-NLAll73-MDims86
2024-06-12 17:53:52,096 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59-NLAll73-MDims86
2024-06-12 17:53:52,096 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:53:52,096 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:53:52,096 logger.py[line:35] INFO after_prediction
2024-06-12 17:53:52,096 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-SpecialI47-MDtype113-MDtype54-SpecialI59-NLAll73-MDims86
2024-06-12 17:53:52,410 logger.py[line:35] INFO INFO: Mutation progress 88/100
2024-06-12 17:53:52,410 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:53:52,410 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:53:52,410 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:53:52,410 logger.py[line:35] INFO Score for MDtype is: 0.8596491228070176
2024-06-12 17:53:52,410 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:53:52,410 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:53:52,410 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:53:52,410 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:53:52,410 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:53:52,410 logger.py[line:35] INFO The last used seed is: MDims
2024-06-12 17:53:52,411 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:53:52,411 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-LMerg10-NLAll66
2024-06-12 17:53:52,411 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:53:56,669 logger.py[line:35] INFO Generating model using MShape
model outputs {'predictions_copy_LMerg_copy_LMerg_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_LMerg_copy_NLAll_copy_MShape')>}
2024-06-12 17:53:57,637 logger.py[line:35] INFO Change 3 Layer's Shape Out Of 6 Layer classes
2024-06-12 17:53:57,637 logger.py[line:35] INFO Changing 3 out of 6 Layer's Shape.
2024-06-12 17:53:57,638 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: conv3_block2_3_bn_copy_LMerg_copy_LMerg_copy_NLAll_copy_MShape From [None, 28, 28, 512] To [None, 1, 1, 5]
2024-06-12 17:53:57,638 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: pool1_pool_copy_LMerg_copy_LMerg_copy_NLAll_copy_MShape From [None, 114, 114, 64] To [None, 0, 5, 7]
2024-06-12 17:53:57,639 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: pool1_pad_copy_LMerg_copy_LMerg_copy_NLAll_copy_MShape From [None, 112, 112, 64] To [None, 0, 0, 5]
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 94, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_shape(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 483, in mutate_shape
    new_model = InputMutationUtils.mshape(MShape_model, selected_layer_shape_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 456, in mshape
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 447, in mshape_layer_mutation
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1939, in _create_c_op
    raise ValueError(e.message)
ValueError: Exception encountered when calling layer "pool1_pool_copy_LMerg_copy_LMerg_copy_NLAll_copy_MShape" (type MaxPooling2D).

Negative dimension size caused by subtracting 3 from 0 for '{{node pool1_pool_copy_LMerg_copy_LMerg_copy_NLAll_copy_MShape/MaxPool}} = MaxPool[T=DT_FLOAT, data_format="NHWC", explicit_paddings=[], ksize=[1, 3, 3, 1], padding="VALID", strides=[1, 2, 2, 1]](Placeholder)' with input shapes: [?,0,5,7].

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 0, 5, 7), dtype=float32)
2024-06-12 17:53:58,428 logger.py[line:35] INFO INFO: Mutation progress 88/100
2024-06-12 17:53:58,428 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:53:58,428 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:53:58,428 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:53:58,428 logger.py[line:35] INFO Score for MDtype is: 0.8596491228070176
2024-06-12 17:53:58,428 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:53:58,428 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:53:58,428 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:53:58,428 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:53:58,428 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:53:58,428 logger.py[line:35] INFO The last used seed is: MShape
2024-06-12 17:53:58,429 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:53:58,429 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype131
2024-06-12 17:53:58,429 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:54:02,829 logger.py[line:35] INFO Generating model using MShape
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MShape')>}
2024-06-12 17:54:03,887 logger.py[line:35] INFO Change 3 Layer's Shape Out Of 5 Layer classes
2024-06-12 17:54:03,887 logger.py[line:35] INFO Changing 3 out of 5 Layer's Shape.
2024-06-12 17:54:03,888 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MShape From [None, 114, 114, 64] To [None, 6, 1, 8]
2024-06-12 17:54:03,889 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MShape From [None, 7, 7, 2048] To [None, 5, 9, 3]
2024-06-12 17:54:03,889 logger.py[line:35] INFO [Locally] Changing The Input Shape Of Layer: conv5_block3_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MShape From [None, 7, 7, 512] To [None, 5, 5, 9]
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 94, in generate_model_by_model_mutation
    return InputMutationUtils.mutate_shape(model=model, architecture_measure=architecture_measure, max_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 483, in mutate_shape
    new_model = InputMutationUtils.mshape(MShape_model, selected_layer_shape_pair, revert_shape=True)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 456, in mshape
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 447, in mshape_layer_mutation
    layer_input = layer(x)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1939, in _create_c_op
    raise ValueError(e.message)
ValueError: Exception encountered when calling layer "pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MShape" (type MaxPooling2D).

Negative dimension size caused by subtracting 3 from 1 for '{{node pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype_copy_MShape/MaxPool}} = MaxPool[T=DT_FLOAT, data_format="NHWC", explicit_paddings=[], ksize=[1, 3, 3, 1], padding="VALID", strides=[1, 2, 2, 1]](Placeholder)' with input shapes: [?,6,1,8].

Call arguments received:
  • inputs=tf.Tensor(shape=(None, 6, 1, 8), dtype=float32)
2024-06-12 17:54:04,544 logger.py[line:35] INFO INFO: Mutation progress 88/100
2024-06-12 17:54:04,544 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:54:04,544 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:54:04,544 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:54:04,544 logger.py[line:35] INFO Score for MDtype is: 0.8596491228070176
2024-06-12 17:54:04,544 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:54:04,544 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:54:04,544 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:54:04,544 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:54:04,544 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:54:04,544 logger.py[line:35] INFO The last used seed is: MShape
2024-06-12 17:54:04,545 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:54:04,545 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-MParam94
2024-06-12 17:54:04,545 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:54:08,946 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype')>}
2024-06-12 17:54:09,921 logger.py[line:35] INFO Change 2 Layer's DType Out Of 5 Layer classes
2024-06-12 17:54:09,921 logger.py[line:35] INFO Changing 2 out of 5 Layer's DType.
2024-06-12 17:54:09,921 logger.py[line:35] INFO Selecting a Global DType float64 For Layer pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype
2024-06-12 17:54:09,922 logger.py[line:35] INFO Selecting a Global DType float32 For Layer avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_MParam_copy_MDtype')>}
2024-06-12 17:54:10,904 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 77/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 164/295
The Input Coverage Is: 317/766
2024-06-12 17:54:12,929 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:54:16,864 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:54:21,014 logger.py[line:35] INFO 2.9.0
2024-06-12 17:54:22,609 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:54:31,310 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype87 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:54:33,028 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:54:33,028 logger.py[line:35] INFO loading the redis
2024-06-12 17:54:33,031 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:54:33,053 logger.py[line:35] INFO coverage_c=37497
time=19.94378972053528, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype87
2024-06-12 17:54:37,707 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype87
2024-06-12 17:54:37,707 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:54:37,707 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:54:37,707 logger.py[line:35] INFO after_prediction
2024-06-12 17:54:37,707 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-MParam94-MDtype87
2024-06-12 17:54:38,123 logger.py[line:35] INFO INFO: Mutation progress 89/100
2024-06-12 17:54:38,123 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:54:38,123 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:54:38,123 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:54:38,123 logger.py[line:35] INFO Score for MDtype is: 0.8620689655172413
2024-06-12 17:54:38,124 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:54:38,124 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:54:38,124 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:54:38,124 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:54:38,124 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:54:38,124 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:54:38,124 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:54:38,124 logger.py[line:35] INFO Choose seed: alexnet-SpecialI120-MDims44-MDtype60-MDims77
2024-06-12 17:54:38,124 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:54:41,729 logger.py[line:35] INFO Generating model using MDtype
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims_copy_MDtype')>}
2024-06-12 17:54:41,861 logger.py[line:35] INFO Change 2 Layer's DType Out Of 5 Layer classes
2024-06-12 17:54:41,861 logger.py[line:35] INFO Changing 2 out of 5 Layer's DType.
2024-06-12 17:54:41,862 logger.py[line:35] INFO Selecting a Global DType float16 For Layer dropout_2_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims_copy_MDtype
2024-06-12 17:54:41,862 logger.py[line:35] INFO Selecting a Global DType float64 For Layer max_pooling2d_1_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims_copy_MDtype
model outputs {'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims_copy_MDtype': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_SpecialI_copy_MDims_copy_MDtype_copy_MDims_copy_MDtype')>}
2024-06-12 17:54:42,021 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 77/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 164/295
The Input Coverage Is: 317/766
2024-06-12 17:54:42,942 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:54:47,078 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:54:51,073 logger.py[line:35] INFO 2.9.0
2024-06-12 17:54:52,637 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:54:57,153 logger.py[line:35] INFO SUCCESS:Get prediction for alexnet-SpecialI120-MDims44-MDtype60-MDims77-MDtype88 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:54:58,737 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 17:54:58,738 logger.py[line:35] INFO loading the redis
2024-06-12 17:54:58,740 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:54:58,768 logger.py[line:35] INFO coverage_c=37497
time=15.6500883102417, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating alexnet-SpecialI120-MDims44-MDtype60-MDims77-MDtype88
2024-06-12 17:55:03,022 logger.py[line:35] INFO Success on backend: tensorflow of model alexnet-SpecialI120-MDims44-MDtype60-MDims77-MDtype88
2024-06-12 17:55:03,022 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:55:03,022 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:55:03,022 logger.py[line:35] INFO after_prediction
2024-06-12 17:55:03,022 logger.py[line:35] INFO New representative seed found: alexnet-SpecialI120-MDims44-MDtype60-MDims77-MDtype88
2024-06-12 17:55:03,352 logger.py[line:35] INFO INFO: Mutation progress 90/100
2024-06-12 17:55:03,352 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:55:03,352 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:55:03,352 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:55:03,352 logger.py[line:35] INFO Score for MDtype is: 0.864406779661017
2024-06-12 17:55:03,352 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:55:03,353 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:55:03,353 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:55:03,353 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:55:03,353 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:55:03,353 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:55:03,353 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:55:03,353 logger.py[line:35] INFO Choose seed: resnet50-Edge65-MDtype58
2024-06-12 17:55:03,353 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:55:07,649 logger.py[line:35] INFO Generating model using MDtype
model outputs {'predictions_copy_Edge_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_MDtype')>, 'cropping2d_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'cropping2d_copy_MDtype_copy_MDtype')>, 'avg_pool_copy_Edge_2_copy_MDtype': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype_copy_MDtype')>}
2024-06-12 17:55:08,617 logger.py[line:35] INFO Change 1 Layer's DType Out Of 6 Layer classes
2024-06-12 17:55:08,617 logger.py[line:35] INFO Changing 1 out of 6 Layer's DType.
2024-06-12 17:55:08,618 logger.py[line:35] INFO Selecting a Global DType float64 For Layer conv4_block6_3_conv_copy_Edge_copy_MDtype_copy_MDtype
model outputs {'predictions_copy_Edge_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_MDtype')>, 'cropping2d_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'cropping2d_copy_MDtype_copy_MDtype')>, 'avg_pool_copy_Edge_2_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'avg_pool_copy_Edge_2_copy_MDtype_copy_MDtype')>}
2024-06-12 17:55:09,621 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 213/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 77/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 164/295
The Input Coverage Is: 317/766
2024-06-12 17:55:11,655 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:55:15,510 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:55:19,626 logger.py[line:35] INFO 2.9.0
2024-06-12 17:55:21,191 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:55:29,715 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-Edge65-MDtype58-MDtype89 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:55:31,424 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 15s
2024-06-12 17:55:31,425 logger.py[line:35] INFO loading the redis
2024-06-12 17:55:31,428 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:55:31,449 logger.py[line:35] INFO coverage_c=37497
time=19.6179096698761, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating resnet50-Edge65-MDtype58-MDtype89
2024-06-12 17:55:35,666 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-Edge65-MDtype58-MDtype89
2024-06-12 17:55:35,667 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:55:35,667 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:55:35,667 logger.py[line:35] INFO after_prediction
2024-06-12 17:55:35,667 logger.py[line:35] INFO New representative seed found: resnet50-Edge65-MDtype58-MDtype89
2024-06-12 17:55:36,039 logger.py[line:35] INFO INFO: Mutation progress 91/100
2024-06-12 17:55:36,039 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:55:36,039 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:55:36,039 logger.py[line:35] INFO Score for Edge is: 0.8888888888888888
2024-06-12 17:55:36,039 logger.py[line:35] INFO Score for MDtype is: 0.8666666666666667
2024-06-12 17:55:36,039 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:55:36,039 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:55:36,039 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:55:36,039 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:55:36,039 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:55:36,039 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:55:36,040 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:55:36,040 logger.py[line:35] INFO Choose seed: resnet50-Edge65-MDtype132-SpecialI1-MShape20
2024-06-12 17:55:36,040 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:55:40,468 logger.py[line:35] INFO Generating model using Edge
model outputs {'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge')>, 'custom_cast_layer_5_copy_SpecialI_copy_MShape': <KerasTensor: shape=(None, 10, 10, 512) dtype=float32 (created by layer 'custom_cast_layer_5_copy_SpecialI_copy_MShape_copy_Edge')>, 'custom_pad_layer_1': <KerasTensor: shape=(None, 1024) dtype=float32 (created by layer 'custom_pad_layer_1_copy_Edge')>}
Choosing 3 To Insert
2024-06-12 17:55:41,471 logger.py[line:35] INFO Insert 3 Global New Edges
2024-06-12 17:55:41,471 logger.py[line:35] INFO Candidate Edge: ('Cropping2D', 'BatchNormalization')
2024-06-12 17:55:42,488 logger.py[line:35] INFO Trying Adding Edge: ['Cropping2D', 'BatchNormalization'] by Connecting cropping2d_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge and conv4_block1_0_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge
2024-06-12 17:55:43,426 logger.py[line:35] INFO Successfully Add Edge: ['Cropping2D', 'BatchNormalization'] by Connecting cropping2d_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge and conv4_block1_0_bn_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge
2024-06-12 17:55:43,426 logger.py[line:35] INFO Candidate Edge: ('Cropping2D', 'Conv2D')
2024-06-12 17:55:44,621 logger.py[line:35] INFO Trying Adding Edge: ['Cropping2D', 'Conv2D'] by Connecting cropping2d_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge and conv3_block3_2_conv_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge
2024-06-12 17:55:45,570 logger.py[line:35] INFO Successfully Add Edge: ['Cropping2D', 'Conv2D'] by Connecting cropping2d_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge and conv3_block3_2_conv_copy_Edge_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge
2024-06-12 17:55:45,570 logger.py[line:35] INFO Candidate Edge: ('Cropping2D', 'GlobalAveragePooling2D')
2024-06-12 17:55:46,582 logger.py[line:35] INFO Trying Adding Edge: ['Cropping2D', 'GlobalAveragePooling2D'] by Connecting cropping2d_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge and avg_pool_copy_Edge_1_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge
2024-06-12 17:55:47,661 logger.py[line:35] INFO Successfully Add Edge: ['Cropping2D', 'GlobalAveragePooling2D'] by Connecting cropping2d_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge and avg_pool_copy_Edge_1_copy_MDtype_copy_SpecialI_copy_MShape_copy_Edge
2024-06-12 17:55:47,790 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 216/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 77/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 164/295
The Input Coverage Is: 317/766
2024-06-12 17:55:50,038 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:55:53,908 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:55:58,036 logger.py[line:35] INFO 2.9.0
2024-06-12 17:55:59,641 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:56:08,809 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-Edge65-MDtype132-SpecialI1-MShape20-Edge90 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:56:10,523 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 16s
2024-06-12 17:56:10,523 logger.py[line:35] INFO loading the redis
2024-06-12 17:56:10,526 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:56:10,547 logger.py[line:35] INFO coverage_c=37497
time=20.33251953125, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating resnet50-Edge65-MDtype132-SpecialI1-MShape20-Edge90
2024-06-12 17:56:14,893 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-Edge65-MDtype132-SpecialI1-MShape20-Edge90
2024-06-12 17:56:14,893 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:56:14,893 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:56:14,893 logger.py[line:35] INFO after_prediction
2024-06-12 17:56:14,893 logger.py[line:35] INFO New representative seed found: resnet50-Edge65-MDtype132-SpecialI1-MShape20-Edge90
2024-06-12 17:56:15,269 logger.py[line:35] INFO INFO: Mutation progress 92/100
2024-06-12 17:56:15,270 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:56:15,270 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:56:15,270 logger.py[line:35] INFO Score for Edge is: 0.8913043478260869
2024-06-12 17:56:15,270 logger.py[line:35] INFO Score for MDtype is: 0.8666666666666667
2024-06-12 17:56:15,270 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:56:15,270 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:56:15,270 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:56:15,270 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:56:15,270 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:56:15,270 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:56:15,270 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:56:15,270 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-MDtype45-MDims17-MDims55
2024-06-12 17:56:15,270 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:56:18,315 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 17:56:19,022 logger.py[line:35] INFO Generating model using MDtype
2024-06-12 17:56:19,025 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype')>}
2024-06-12 17:56:19,196 logger.py[line:35] INFO Change 1 Layer's DType Out Of 4 Layer classes
2024-06-12 17:56:19,196 logger.py[line:35] INFO Changing 1 out of 4 Layer's DType.
2024-06-12 17:56:19,197 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype
2024-06-12 17:56:19,199 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype')>}
2024-06-12 17:56:19,390 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 17:56:20,008 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 216/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 77/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 164/295
The Input Coverage Is: 317/766
2024-06-12 17:56:20,202 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:56:24,383 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:56:28,369 logger.py[line:35] INFO 2.9.0
2024-06-12 17:56:29,947 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:56:32,743 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:56:33,940 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 17:56:33,941 logger.py[line:35] INFO loading the redis
2024-06-12 17:56:33,944 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:56:33,972 logger.py[line:35] INFO coverage_c=37497
time=13.594084978103638, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91
2024-06-12 17:56:38,178 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91
2024-06-12 17:56:38,178 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:56:38,178 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:56:38,178 logger.py[line:35] INFO after_prediction
2024-06-12 17:56:38,178 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91
2024-06-12 17:56:38,477 logger.py[line:35] INFO INFO: Mutation progress 93/100
2024-06-12 17:56:38,477 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:56:38,477 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:56:38,477 logger.py[line:35] INFO Score for Edge is: 0.8913043478260869
2024-06-12 17:56:38,477 logger.py[line:35] INFO Score for MDtype is: 0.860655737704918
2024-06-12 17:56:38,477 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:56:38,477 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:56:38,477 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:56:38,477 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:56:38,477 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:56:38,477 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 17:56:38,477 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:56:38,477 logger.py[line:35] INFO Choose seed: alexnet
2024-06-12 17:56:38,477 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:56:41,931 logger.py[line:35] INFO Generating model using NLAll
model outputs {'dense_3': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_NLAll')>}
2024-06-12 17:56:42,044 logger.py[line:35] INFO Insert 7 out of 19 Local New Layers
2024-06-12 17:56:42,044 logger.py[line:35] INFO insert UpSampling2D after conv2d_5_copy_NLAll
2024-06-12 17:56:42,044 logger.py[line:35] INFO insert LeakyReLU after max_pooling2d_2_copy_NLAll
2024-06-12 17:56:42,044 logger.py[line:35] INFO insert RepeatVector after flatten_1_copy_NLAll
2024-06-12 17:56:42,044 logger.py[line:35] INFO insert LocallyConnected2D after max_pooling2d_2_copy_NLAll
2024-06-12 17:56:42,044 logger.py[line:35] INFO insert DepthwiseConv2D after max_pooling2d_3_copy_NLAll
2024-06-12 17:56:42,044 logger.py[line:35] INFO insert SpatialDropout2D after conv2d_5_copy_NLAll
2024-06-12 17:56:42,045 logger.py[line:35] INFO insert ActivityRegularization after max_pooling2d_3_copy_NLAll
2024-06-12 17:56:42,045 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 3
2024-06-12 17:56:42,045 logger.py[line:35] INFO insert DepthwiseConv2D after conv2d_1_copy_NLAll
2024-06-12 17:56:42,046 logger.py[line:35] INFO insert GlobalAveragePooling2D after conv2d_2_copy_NLAll
2024-06-12 17:56:42,046 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [5]
2024-06-12 17:56:42,046 logger.py[line:35] INFO insert Cropping3D after dense_3_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.convolutional.DepthwiseConv2D object at 0x7fdc6c1a7950>
2024-06-12 17:56:42,067 logger.py[line:35] INFO Converting output shape (None, 14, 15, 96) to actual shape [None, 16, 16, 96]
[DEBUG] Inserting layer: <keras.layers.pooling.GlobalAveragePooling2D object at 0x7fdc5c5fe390>
2024-06-12 17:56:42,124 logger.py[line:35] INFO Converting output shape (None, 256) to actual shape [None, 8, 8, 256]
[DEBUG] Inserting layer: <keras.layers.local.LocallyConnected2D object at 0x7fdc5c5c0850>
2024-06-12 17:56:44,094 logger.py[line:35] INFO Converting output shape (None, 10, 3, 255) to actual shape [None, 3, 3, 256]
[DEBUG] Inserting layer: <keras.layers.core.spatial_dropout.SpatialDropout2D object at 0x7fdc0045bf50>
2024-06-12 17:56:44,204 logger.py[line:35] INFO Converting output shape (None, 3, 3, 256) to actual shape [None, 3, 3, 256]
[DEBUG] Inserting layer: <keras.layers.core.activity_regularization.ActivityRegularization object at 0x7fdc50035350>
2024-06-12 17:56:44,211 logger.py[line:35] INFO Converting output shape (None, 1, 1, 256) to actual shape [None, 1, 1, 256]
[DEBUG] Inserting layer: <keras.layers.core.repeat_vector.RepeatVector object at 0x7fdc50074490>
2024-06-12 17:56:44,225 logger.py[line:35] INFO Converting output shape (None, 2, 256) to actual shape [None, 256]
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomExpandLayer object at 0x7fdc5000a250>
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomExpandLayer object at 0x7fdc5c5d1710>
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomExpandLayer object at 0x7fdc5c5b7f50>
[DEBUG] Inserting layer: <keras.layers.convolutional.Cropping3D object at 0x7fdc5c661bd0>
2024-06-12 17:56:44,331 logger.py[line:35] INFO Converting output shape (None, 0, 0, 1, 10) to actual shape [None, 10]
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 74, in new_layer_addition
    layer_input = ArchitectureUtils.reshape_tensor(tensor=layer_input, target_shape=target_shape, mode="custom")
  File "/root/implementations/scripts/tools/architecture_utils.py", line 174, in reshape_tensor
    new_tensor = ArchitectureUtils._expand_drop_dim(new_tensor, target_shape)
  File "/root/implementations/scripts/tools/architecture_utils.py", line 59, in _expand_drop_dim
    tensor = _layer(tensor)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/tensorflow/python/autograph/impl/api.py", line 699, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: Exception encountered when calling layer "custom_drop_dim_layer_1" (type CustomDropDimLayer).

in user code:

    File "/root/implementations/scripts/generation/custom_layers.py", line 235, in call  *
        return inputs[indices]

    ValueError: slice index 0 of dimension 1 out of bounds. for '{{node custom_drop_dim_layer_1/strided_slice}} = StridedSlice[Index=DT_INT32, T=DT_FLOAT, begin_mask=29, ellipsis_mask=0, end_mask=29, new_axis_mask=0, shrink_axis_mask=2](Placeholder, custom_drop_dim_layer_1/strided_slice/stack, custom_drop_dim_layer_1/strided_slice/stack_1, custom_drop_dim_layer_1/strided_slice/stack_2)' with input shapes: [?,0,0,1,10], [5], [5], [5] and with computed input tensors: input[1] = <0 0 0 0 0>, input[2] = <0 1 0 0 0>, input[3] = <1 1 1 1 1>.


Call arguments received:
  • inputs=tf.Tensor(shape=(None, 0, 0, 1, 10), dtype=float32)
  • kwargs={'training': 'None'}
2024-06-12 17:56:45,005 logger.py[line:35] INFO INFO: Mutation progress 93/100
2024-06-12 17:56:45,005 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:56:45,005 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:56:45,005 logger.py[line:35] INFO Score for Edge is: 0.8913043478260869
2024-06-12 17:56:45,005 logger.py[line:35] INFO Score for MDtype is: 0.860655737704918
2024-06-12 17:56:45,005 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:56:45,005 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:56:45,005 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:56:45,005 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:56:45,005 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:56:45,005 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:56:45,006 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:56:45,006 logger.py[line:35] INFO Choose seed: lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32-LMerg63
2024-06-12 17:56:45,006 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:56:48,706 logger.py[line:35] INFO Generating model using Edge
model outputs {'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_15_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_LMerg_copy_Edge')>, 'dot_copy_ML_copy_LMerg': <KerasTensor: shape=(None, 10, 10, 10, 10) dtype=float32 (created by layer 'dot_copy_ML_copy_LMerg_copy_Edge')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 14, 14, 6) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_1_copy_LMerg_copy_LMerg_copy_Edge')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_2_2_copy_LMerg_copy_LMerg_copy_Edge')>, 'elu_insert_copy_Edge_1_2_1_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 120) dtype=float32 (created by layer 'elu_insert_copy_Edge_1_2_1_copy_LMerg_copy_LMerg_copy_Edge')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_1_copy_LMerg_copy_LMerg_copy_Edge')>, 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2_copy_LMerg_copy_LMerg': <KerasTensor: shape=(None, 10, 10, 16) dtype=float32 (created by layer 'leaky_re_lu_insert_copy_NLAll_copy_Edge_1_2_2_copy_LMerg_copy_LMerg_copy_Edge')>, 'concatenate_copy_ML': <KerasTensor: shape=(None, 10, 4) dtype=float32 (created by layer 'concatenate_copy_ML_copy_Edge')>}
Choosing 2 To Insert
2024-06-12 17:56:48,872 logger.py[line:35] INFO Insert 2 Global New Edges
2024-06-12 17:56:48,872 logger.py[line:35] INFO Candidate Edge: ('Dropout', 'LeakyReLU')
2024-06-12 17:56:49,040 logger.py[line:35] INFO Trying Adding Edge: ['Dropout', 'LeakyReLU'] by Connecting dropout_5_copy_LMerg_merge1_copy_NLAll_copy_NLAll_copy_Edge_1_1_copy_LMerg_copy_LMerg_copy_Edge and leaky_re_lu_insert_copy_NLAll_copy_Edge_1_1_copy_LMerg_copy_LMerg_copy_Edge
2024-06-12 17:56:49,201 logger.py[line:35] INFO Successfully Add Edge: ['Dropout', 'LeakyReLU'] by Connecting dropout_5_copy_LMerg_merge1_copy_NLAll_copy_NLAll_copy_Edge_1_1_copy_LMerg_copy_LMerg_copy_Edge and leaky_re_lu_insert_copy_NLAll_copy_Edge_1_1_copy_LMerg_copy_LMerg_copy_Edge
2024-06-12 17:56:49,201 logger.py[line:35] INFO Candidate Edge: ('Cropping1D', 'Flatten')
2024-06-12 17:56:49,374 logger.py[line:35] INFO Trying Adding Edge: ['Cropping1D', 'Flatten'] by Connecting cropping1d_copy_LMerg_copy_LMerg_copy_Edge and flatten_5_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_LMerg_copy_Edge
2024-06-12 17:56:49,537 logger.py[line:35] INFO Successfully Add Edge: ['Cropping1D', 'Flatten'] by Connecting cropping1d_copy_LMerg_copy_LMerg_copy_Edge and flatten_5_copy_LMerg_copy_NLAll_copy_NLAll_copy_Edge_copy_LMerg_copy_LMerg_copy_Edge
2024-06-12 17:56:49,628 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 218/2170
The Configuration Coverage is: 472/2049
The NDims Coverage Is: 77/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 164/295
The Input Coverage Is: 317/766
2024-06-12 17:56:50,442 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:56:54,263 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:56:58,294 logger.py[line:35] INFO 2.9.0
2024-06-12 17:56:59,930 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 17:57:04,811 logger.py[line:35] INFO SUCCESS:Get prediction for lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32-LMerg63-Edge92 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 17:57:06,524 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 17:57:06,524 logger.py[line:35] INFO loading the redis
2024-06-12 17:57:06,527 logger.py[line:35] INFO finish loading from redis
2024-06-12 17:57:06,548 logger.py[line:35] INFO coverage_c=37497
time=15.930447578430176, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32-LMerg63-Edge92
2024-06-12 17:57:11,253 logger.py[line:35] INFO Success on backend: tensorflow of model lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32-LMerg63-Edge92
2024-06-12 17:57:11,254 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 17:57:11,254 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 17:57:11,254 logger.py[line:35] INFO after_prediction
2024-06-12 17:57:11,254 logger.py[line:35] INFO New representative seed found: lenet-LMerg90-NLAll105-NLAll116-Edge130-LMerg32-LMerg63-Edge92
2024-06-12 17:57:11,593 logger.py[line:35] INFO INFO: Mutation progress 94/100
2024-06-12 17:57:11,593 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:57:11,593 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:57:11,593 logger.py[line:35] INFO Score for Edge is: 0.8936170212765957
2024-06-12 17:57:11,593 logger.py[line:35] INFO Score for MDtype is: 0.860655737704918
2024-06-12 17:57:11,593 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:57:11,593 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:57:11,593 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:57:11,593 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:57:11,593 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:57:11,593 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 17:57:11,594 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:57:11,594 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-NLAll99
2024-06-12 17:57:11,594 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:57:16,045 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll')>}
2024-06-12 17:57:17,371 logger.py[line:35] INFO Insert 9 out of 22 Local New Layers
2024-06-12 17:57:17,372 logger.py[line:35] INFO insert ThresholdedReLU after global_max_pooling2d_insert_copy_NLAll
2024-06-12 17:57:17,372 logger.py[line:35] INFO insert RepeatVector after global_max_pooling2d_insert_copy_NLAll
2024-06-12 17:57:17,372 logger.py[line:35] INFO insert UpSampling2D after conv3_block2_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
2024-06-12 17:57:17,372 logger.py[line:35] INFO insert GaussianNoise after pool1_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
2024-06-12 17:57:17,372 logger.py[line:35] INFO insert LeakyReLU after global_max_pooling2d_insert_copy_NLAll
2024-06-12 17:57:17,372 logger.py[line:35] INFO insert ELU after pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
2024-06-12 17:57:17,372 logger.py[line:35] INFO insert Dropout after avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
2024-06-12 17:57:17,372 logger.py[line:35] INFO insert Conv2DTranspose after pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
2024-06-12 17:57:17,372 logger.py[line:35] INFO insert LayerNormalization after pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
2024-06-12 17:57:17,372 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 4
2024-06-12 17:57:17,382 logger.py[line:35] INFO insert LeakyReLU after conv2_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
2024-06-12 17:57:17,386 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [6]
2024-06-12 17:57:17,386 logger.py[line:35] INFO insert ConvLSTM3D after conv5_block1_out_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
2024-06-12 17:57:17,390 logger.py[line:35] INFO insert SeparableConv2D after conv2_block2_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
2024-06-12 17:57:17,394 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [5]
2024-06-12 17:57:17,394 logger.py[line:35] INFO insert ConvLSTM2D after conv4_block1_out_copy_LMerg_copy_MShape_copy_MDtype_copy_NLAll_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.normalization.layer_normalization.LayerNormalization object at 0x7f1b305a8890>
2024-06-12 17:57:17,426 logger.py[line:35] INFO Converting output shape (None, 114, 114, 64) to actual shape [None, 114, 114, 64]
[DEBUG] Inserting layer: <keras.layers.noise.GaussianNoise object at 0x7f1b305aeed0>
2024-06-12 17:57:17,432 logger.py[line:35] INFO Converting output shape (None, 56, 56, 64) to actual shape [None, 56, 56, 64]
[DEBUG] Inserting layer: <keras.layers.convolutional.SeparableConv2D object at 0x7f1b30548990>
2024-06-12 17:57:17,550 logger.py[line:35] INFO Converting output shape (None, 256, 56, 256) to actual shape [None, 56, 56, 256]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.LeakyReLU object at 0x7f1b304f8a50>
2024-06-12 17:57:17,565 logger.py[line:35] INFO Converting output shape (None, 56, 56, 256) to actual shape [None, 56, 56, 256]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.LeakyReLU object at 0x7f1b30489450>
2024-06-12 17:57:17,570 logger.py[line:35] INFO Converting output shape (None, 56) to actual shape [None, 56]
[DEBUG] Inserting layer: <keras.layers.convolutional.UpSampling2D object at 0x7f1b30425d10>
2024-06-12 17:57:17,721 logger.py[line:35] INFO Converting output shape (None, 28, 196, 896) to actual shape [None, 28, 28, 128]
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 69, in generate_model_by_model_mutation
    return InteractionMutationUtils.insert_layers(model=model, layer_type=operator, max_num=MAX_LAYER_NUM, architecture_measure=architecture_measure, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 134, in insert_layers
    mutated_model = NL_mut(NL_model, selection_pair, [])
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 82, in NL_mut
    new_model = utils.ModelUtils.functional_model_operation(model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 92, in functional_model_operation
    x = operation[layer.name](x, cloned_layer)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 62, in new_layer_addition
    layer_list = selected_layer(output_shape)
  File "/root/implementations/scripts/generation/layer_pools.py", line 476, in conv_lstm_2d
    inserted_layer = ConfigurationUtils.random_config(candidate_layer)
  File "/root/implementations/scripts/generation/layer_pools.py", line 57, in random_config
    new_layer = layer.from_config(layer_config)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 970, in from_config
    return cls(**config)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 1300, in __init__
    **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 842, in __init__
    **kwargs)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/convolutional_recurrent.py", line 141, in __init__
    'Unrolling is not possible with convolutional RNNs. '
TypeError: Unrolling is not possible with convolutional RNNs. Received: unroll=True
2024-06-12 17:57:18,581 logger.py[line:35] INFO INFO: Mutation progress 94/100
2024-06-12 17:57:18,581 logger.py[line:35] INFO Logging for Seeds
2024-06-12 17:57:18,581 logger.py[line:35] INFO Score for NLAll is: 0.9047619047619048
2024-06-12 17:57:18,581 logger.py[line:35] INFO Score for Edge is: 0.8936170212765957
2024-06-12 17:57:18,582 logger.py[line:35] INFO Score for MDtype is: 0.860655737704918
2024-06-12 17:57:18,582 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 17:57:18,582 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 17:57:18,582 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 17:57:18,582 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 17:57:18,582 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 17:57:18,582 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 17:57:18,582 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 17:57:18,582 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67-MDtype82
2024-06-12 17:57:18,582 logger.py[line:35] INFO start mutating the generated model
2024-06-12 17:57:23,136 logger.py[line:35] INFO Generating model using NLAll
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>}
2024-06-12 17:57:24,572 logger.py[line:35] INFO Insert 7 out of 24 Local New Layers
2024-06-12 17:57:24,572 logger.py[line:35] INFO insert DepthwiseConv2D after cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:57:24,572 logger.py[line:35] INFO insert LocallyConnected2D after pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_2_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:57:24,572 logger.py[line:35] INFO insert ReLU after cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:57:24,572 logger.py[line:35] INFO insert LeakyReLU after cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:57:24,573 logger.py[line:35] INFO insert SpatialDropout2D after cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:57:24,573 logger.py[line:35] INFO insert ThresholdedReLU after pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:57:24,573 logger.py[line:35] INFO insert AlphaDropout after pool1_pad_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:57:24,573 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 2
2024-06-12 17:57:24,576 logger.py[line:35] INFO Fail to find suitable insertion point for dimension: [5]
2024-06-12 17:57:24,577 logger.py[line:35] INFO insert GlobalAveragePooling3D after conv5_block3_2_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll
2024-06-12 17:57:24,582 logger.py[line:35] INFO insert DepthwiseConv2D after conv2_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll
[DEBUG] Inserting layer: <keras.layers.convolutional.DepthwiseConv2D object at 0x7fde080310d0>
2024-06-12 17:57:24,737 logger.py[line:35] INFO Converting output shape (None, 56, 56, 256) to actual shape [None, 56, 56, 256]
[DEBUG] Inserting layer: <scripts.generation.custom_layers.CustomExpandLayer object at 0x7fdde85f5910>
[DEBUG] Inserting layer: <keras.layers.pooling.GlobalAveragePooling3D object at 0x7fdde85f0e50>
2024-06-12 17:57:25,484 logger.py[line:35] INFO Converting output shape (None, 1) to actual shape [None, 7, 7, 512]
[DEBUG] Inserting layer: <keras.layers.noise.AlphaDropout object at 0x7fde725d0710>
2024-06-12 17:57:25,531 logger.py[line:35] INFO Converting output shape (None, 232, 232, 3) to actual shape [None, 232, 232, 3]
[DEBUG] Inserting layer: <keras.layers.local.LocallyConnected2D object at 0x7fdde861ce90>
2024-06-12 17:57:34,753 logger.py[line:35] INFO Converting output shape (None, 10, 28, 123) to actual shape [None, 30, 30, 128]
[DEBUG] Inserting layer: <keras.layers.advanced_activations.LeakyReLU object at 0x7fdd2477da90>
2024-06-12 17:57:34,814 logger.py[line:35] INFO Converting output shape (None, 10, 10, 64) to actual shape [None, 10, 10, 64]
[DEBUG] Inserting layer: <keras.layers.convolutional.DepthwiseConv2D object at 0x7fdd24787110>
2024-06-12 17:57:34,830 logger.py[line:35] INFO Converting output shape (None, 8, 4, 64) to actual shape [None, 10, 10, 64]
[DEBUG] Inserting layer: <keras.layers.core.spatial_dropout.SpatialDropout2D object at 0x7fdd2473cbd0>
2024-06-12 17:57:34,846 logger.py[line:35] INFO Converting output shape (None, 10, 10, 64) to actual shape [None, 10, 10, 64]
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'leaky_re_lu_insert')>, 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'custom_pad_layer_2')>, 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'spatial_dropout2d_insert')>, 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>, 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_MDtype_copy_MDtype_copy_NLAll')>}
2024-06-12 17:57:35,026 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 223/2170
The Configuration Coverage is: 485/2049
The NDims Coverage Is: 77/117
The DType Coverage Is: 76/354
The Shape Coverage Is: 168/295
The Input Coverage Is: 321/766
2024-06-12 17:57:46,512 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 17:57:50,370 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 17:57:54,489 logger.py[line:35] INFO 2.9.0
2024-06-12 17:57:56,060 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 18:00:16,383 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67-MDtype82-NLAll93 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 18:00:19,092 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 2m, 28s
2024-06-12 18:00:19,093 logger.py[line:35] INFO loading the redis
2024-06-12 18:00:19,095 logger.py[line:35] INFO finish loading from redis
2024-06-12 18:00:19,117 logger.py[line:35] INFO coverage_c=37497
time=152.42854237556458, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67-MDtype82-NLAll93
2024-06-12 18:00:23,905 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67-MDtype82-NLAll93
2024-06-12 18:00:23,905 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 18:00:23,905 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 18:00:23,905 logger.py[line:35] INFO after_prediction
2024-06-12 18:00:23,905 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-MDtype67-MDtype82-NLAll93
2024-06-12 18:00:24,589 logger.py[line:35] INFO INFO: Mutation progress 95/100
2024-06-12 18:00:24,589 logger.py[line:35] INFO Logging for Seeds
2024-06-12 18:00:24,589 logger.py[line:35] INFO Score for NLAll is: 0.90625
2024-06-12 18:00:24,589 logger.py[line:35] INFO Score for Edge is: 0.8936170212765957
2024-06-12 18:00:24,589 logger.py[line:35] INFO Score for MDtype is: 0.860655737704918
2024-06-12 18:00:24,589 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 18:00:24,589 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 18:00:24,589 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 18:00:24,589 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 18:00:24,589 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 18:00:24,589 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 18:00:24,590 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 18:00:24,590 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91
2024-06-12 18:00:24,590 logger.py[line:35] INFO start mutating the generated model
2024-06-12 18:00:27,622 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:00:28,334 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 18:00:28,337 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_NLAll')>}
2024-06-12 18:00:28,553 logger.py[line:35] INFO Insert 1 out of 12 Global New Layers
2024-06-12 18:00:28,553 logger.py[line:35] INFO insert GlobalMaxPooling1D after repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_NLAll
2024-06-12 18:00:28,556 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.pooling.GlobalMaxPooling1D object at 0x7fd16c2dff50>
2024-06-12 18:00:28,719 logger.py[line:35] INFO Converting output shape (None, 25) to actual shape [None, 2, 25]
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_NLAll')>}
2024-06-12 18:00:28,801 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 18:00:29,461 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 224/2170
The Configuration Coverage is: 487/2049
The NDims Coverage Is: 78/117
The DType Coverage Is: 77/354
The Shape Coverage Is: 169/295
The Input Coverage Is: 324/766
2024-06-12 18:00:29,661 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 18:00:33,599 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 18:00:37,602 logger.py[line:35] INFO 2.9.0
2024-06-12 18:00:39,185 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 18:00:42,085 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91-NLAll94 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 18:00:43,257 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 9s
2024-06-12 18:00:43,257 logger.py[line:35] INFO loading the redis
2024-06-12 18:00:43,260 logger.py[line:35] INFO finish loading from redis
2024-06-12 18:00:43,282 logger.py[line:35] INFO coverage_c=37497
time=13.427051067352295, cov_py=0, cov_c=37497
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91-NLAll94
2024-06-12 18:00:47,603 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91-NLAll94
2024-06-12 18:00:47,603 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 18:00:47,603 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 18:00:47,603 logger.py[line:35] INFO after_prediction
2024-06-12 18:00:47,603 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91-NLAll94
2024-06-12 18:00:47,910 logger.py[line:35] INFO INFO: Mutation progress 96/100
2024-06-12 18:00:47,910 logger.py[line:35] INFO Logging for Seeds
2024-06-12 18:00:47,910 logger.py[line:35] INFO Score for NLAll is: 0.9076923076923077
2024-06-12 18:00:47,910 logger.py[line:35] INFO Score for Edge is: 0.8936170212765957
2024-06-12 18:00:47,910 logger.py[line:35] INFO Score for MDtype is: 0.860655737704918
2024-06-12 18:00:47,910 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 18:00:47,910 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 18:00:47,910 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 18:00:47,910 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 18:00:47,910 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 18:00:47,910 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 18:00:47,911 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 18:00:47,911 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-MDtype45-MDims17-MDims55
2024-06-12 18:00:47,911 logger.py[line:35] INFO start mutating the generated model
2024-06-12 18:00:50,957 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:00:51,664 logger.py[line:35] INFO Generating model using NLAll
2024-06-12 18:00:51,667 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_NLAll')>}
2024-06-12 18:00:51,875 logger.py[line:35] INFO Insert 2 out of 11 Global New Layers
2024-06-12 18:00:51,875 logger.py[line:35] INFO insert MaxPooling1D after repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_NLAll
2024-06-12 18:00:51,875 logger.py[line:35] INFO insert GRU after repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_NLAll
2024-06-12 18:00:51,875 logger.py[line:35] INFO Insert 1 out of 20 Local New Layers
2024-06-12 18:00:51,876 logger.py[line:35] INFO insert Cropping1D after repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_NLAll
2024-06-12 18:00:51,876 logger.py[line:35] INFO Fail to find enough new layers to insert, randomly choose 1
2024-06-12 18:00:51,876 logger.py[line:35] INFO insert Bidirectional after repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_NLAll
2024-06-12 18:00:51,879 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
[DEBUG] Inserting layer: <keras.layers.wrappers.Bidirectional object at 0x7f28c83bbc50>
2024-06-12 18:00:52,421 logger.py[line:35] INFO Converting output shape (None, 2, 20) to actual shape [None, 2, 25]
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_NLAll': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_NLAll')>}
2024-06-12 18:00:52,585 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 18:00:53,142 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_NLAll will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 225/2170
The Configuration Coverage is: 488/2049
The NDims Coverage Is: 79/117
The DType Coverage Is: 78/354
The Shape Coverage Is: 170/295
The Input Coverage Is: 327/766
2024-06-12 18:00:53,708 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 18:00:57,863 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 18:01:01,880 logger.py[line:35] INFO 2.9.0
2024-06-12 18:01:03,466 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 18:01:09,179 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-MDtype45-MDims17-MDims55-NLAll95 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 18:01:10,574 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 12s
2024-06-12 18:01:10,574 logger.py[line:35] INFO loading the redis
2024-06-12 18:01:10,577 logger.py[line:35] INFO finish loading from redis
2024-06-12 18:01:10,605 logger.py[line:35] INFO coverage_c=38778
time=16.71928119659424, cov_py=0, cov_c=38778
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-MDtype45-MDims17-MDims55-NLAll95
2024-06-12 18:01:14,888 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-MDtype45-MDims17-MDims55-NLAll95
2024-06-12 18:01:14,888 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 18:01:14,888 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 18:01:14,888 logger.py[line:35] INFO after_prediction
2024-06-12 18:01:14,888 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-MDtype45-MDims17-MDims55-NLAll95
2024-06-12 18:01:15,193 logger.py[line:35] INFO INFO: Mutation progress 97/100
2024-06-12 18:01:15,193 logger.py[line:35] INFO Logging for Seeds
2024-06-12 18:01:15,193 logger.py[line:35] INFO Score for NLAll is: 0.9090909090909091
2024-06-12 18:01:15,193 logger.py[line:35] INFO Score for Edge is: 0.8936170212765957
2024-06-12 18:01:15,193 logger.py[line:35] INFO Score for MDtype is: 0.860655737704918
2024-06-12 18:01:15,193 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 18:01:15,193 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 18:01:15,193 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 18:01:15,193 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 18:01:15,193 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 18:01:15,193 logger.py[line:35] INFO The last used seed is: NLAll
2024-06-12 18:01:15,193 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 18:01:15,193 logger.py[line:35] INFO Choose seed: alexnet
2024-06-12 18:01:15,193 logger.py[line:35] INFO start mutating the generated model
2024-06-12 18:01:18,667 logger.py[line:35] INFO Generating model using MDtype
model outputs {'dense_3': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_MDtype')>}
2024-06-12 18:01:18,755 logger.py[line:35] INFO Change 1 Layer's DType Out Of 5 Layer classes
2024-06-12 18:01:18,755 logger.py[line:35] INFO Changing 1 out of 5 Layer's DType.
2024-06-12 18:01:18,755 logger.py[line:35] INFO Selecting a Global DType bfloat16 For Layer conv2d_1_copy_MDtype
model outputs {'dense_3_copy_MDtype': <KerasTensor: shape=(None, 10) dtype=float32 (created by layer 'dense_3_copy_MDtype')>}
2024-06-12 18:01:18,891 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 225/2170
The Configuration Coverage is: 488/2049
The NDims Coverage Is: 79/117
The DType Coverage Is: 78/354
The Shape Coverage Is: 170/295
The Input Coverage Is: 327/766
2024-06-12 18:01:19,691 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 18:01:23,728 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 18:01:27,720 logger.py[line:35] INFO 2.9.0
2024-06-12 18:01:29,302 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 229, in <module>
    predictor.before_predict()
  File "/root/implementations/scripts/prediction/predict_model.py", line 116, in before_predict
    self.model = keras.models.load_model(self.model_path, custom_objects=custom_objects())
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/tensorflow/lib/python3.7/site-packages/keras/backend.py", line 4019, in batch_set_value
    x.assign(np.asarray(value, dtype=dtype_numpy(x)))
ValueError: No cast function available.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/implementations/scripts/prediction/predict_model.py", line 235, in <module>
    raise ValueError(f"CRASH ON BACKEND {flags.backend}!!!")
ValueError: CRASH ON BACKEND tensorflow!!!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 18:01:30,882 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 7s
2024-06-12 18:01:30,882 logger.py[line:35] INFO alexnet-MDtype96 crash on backend tensorflow when predicting
2024-06-12 18:01:30,904 logger.py[line:35] INFO coverage_c=38778
time=11.036367177963257, cov_py=0, cov_c=38778
New test requirements invoked on framework tensorflow when updating alexnet-MDtype96
2024-06-12 18:01:35,037 logger.py[line:35] INFO Fail on backend: tensorflow of model alexnet-MDtype96
2024-06-12 18:01:35,037 logger.py[line:35] INFO Error: Move Crash model
2024-06-12 18:01:35,037 logger.py[line:35] INFO after_prediction
2024-06-12 18:01:35,340 logger.py[line:35] INFO INFO: Mutation progress 98/100
2024-06-12 18:01:35,340 logger.py[line:35] INFO Logging for Seeds
2024-06-12 18:01:35,340 logger.py[line:35] INFO Score for NLAll is: 0.9090909090909091
2024-06-12 18:01:35,340 logger.py[line:35] INFO Score for Edge is: 0.8936170212765957
2024-06-12 18:01:35,340 logger.py[line:35] INFO Score for MDtype is: 0.8629032258064516
2024-06-12 18:01:35,340 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 18:01:35,340 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 18:01:35,340 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 18:01:35,340 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 18:01:35,340 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 18:01:35,340 logger.py[line:35] INFO The last used seed is: MDtype
2024-06-12 18:01:35,340 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 18:01:35,340 logger.py[line:35] INFO Choose seed: lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91
2024-06-12 18:01:35,341 logger.py[line:35] INFO start mutating the generated model
2024-06-12 18:01:38,379 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:39,088 logger.py[line:35] INFO Generating model using Edge
2024-06-12 18:01:39,091 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
model outputs {'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype': <KerasTensor: shape=(None, 1) dtype=float32 (created by layer 'dense_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge')>}
Choosing 4 To Insert
2024-06-12 18:01:39,268 logger.py[line:35] INFO Insert 4 Local New Edges
2024-06-12 18:01:39,268 logger.py[line:35] INFO Candidate Edge: ('LSTM', 'Dropout')
2024-06-12 18:01:39,277 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:39,453 logger.py[line:35] INFO Trying Adding Edge: ['LSTM', 'Dropout'] by Connecting lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 18:01:39,456 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:39,633 logger.py[line:35] INFO Successfully Add Edge: ['LSTM', 'Dropout'] by Connecting lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 18:01:39,633 logger.py[line:35] INFO Candidate Edge: ('UpSampling3D', 'UpSampling3D')
2024-06-12 18:01:39,642 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:39,823 logger.py[line:35] INFO Trying Adding Edge: ['UpSampling3D', 'UpSampling3D'] by Connecting up_sampling3d_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge and up_sampling3d_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 18:01:39,826 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:40,049 logger.py[line:35] INFO Successfully Add Edge: ['UpSampling3D', 'UpSampling3D'] by Connecting up_sampling3d_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge and up_sampling3d_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 18:01:40,050 logger.py[line:35] INFO Candidate Edge: ('RepeatVector', 'LSTM')
2024-06-12 18:01:40,059 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:40,377 logger.py[line:35] INFO Trying Adding Edge: ['RepeatVector', 'LSTM'] by Connecting repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge and lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 18:01:40,380 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:40,479 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:40,706 logger.py[line:35] INFO Successfully Add Edge: ['RepeatVector', 'LSTM'] by Connecting repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge and lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge
2024-06-12 18:01:40,706 logger.py[line:35] INFO Candidate Edge: ('RepeatVector', 'Dropout')
2024-06-12 18:01:40,716 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:40,728 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:41,046 logger.py[line:35] INFO Trying Adding Edge: ['RepeatVector', 'Dropout'] by Connecting repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge_1
2024-06-12 18:01:41,049 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:41,284 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:41,377 logger.py[line:35] INFO Successfully Add Edge: ['RepeatVector', 'Dropout'] by Connecting repeat_vector_insert_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge and dropout_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge_1
2024-06-12 18:01:41,432 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2024-06-12 18:01:42,238 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
2024-06-12 18:01:42,251 recurrent_v2.py[line:1127] WARNING Layer lstm_1_copy_NLAll_copy_MDtype_copy_MDims_copy_MDims_copy_MDtype_copy_Edge_2 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.
The API Pair Coverage Is: 225/2170
The Configuration Coverage is: 488/2049
The NDims Coverage Is: 79/117
The DType Coverage Is: 80/354
The Shape Coverage Is: 170/295
The Input Coverage Is: 329/766
2024-06-12 18:01:42,577 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 18:01:46,471 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 18:01:50,456 logger.py[line:35] INFO 2.9.0
2024-06-12 18:01:52,050 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 18:01:56,576 logger.py[line:35] INFO SUCCESS:Get prediction for lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91-Edge97 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 18:01:57,730 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 11s
2024-06-12 18:01:57,730 logger.py[line:35] INFO loading the redis
2024-06-12 18:01:57,733 logger.py[line:35] INFO finish loading from redis
2024-06-12 18:01:57,756 logger.py[line:35] INFO coverage_c=38784
time=14.997170209884644, cov_py=0, cov_c=38784
New test requirements invoked on framework tensorflow when updating lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91-Edge97
2024-06-12 18:02:02,341 logger.py[line:35] INFO Success on backend: tensorflow of model lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91-Edge97
2024-06-12 18:02:02,342 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 18:02:02,343 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 18:02:02,343 logger.py[line:35] INFO after_prediction
2024-06-12 18:02:02,343 logger.py[line:35] INFO New representative seed found: lstm2-NLAll38-MDtype45-MDims17-MDims55-MDtype91-Edge97
2024-06-12 18:02:02,675 logger.py[line:35] INFO INFO: Mutation progress 99/100
2024-06-12 18:02:02,675 logger.py[line:35] INFO Logging for Seeds
2024-06-12 18:02:02,675 logger.py[line:35] INFO Score for NLAll is: 0.9090909090909091
2024-06-12 18:02:02,675 logger.py[line:35] INFO Score for Edge is: 0.8958333333333334
2024-06-12 18:02:02,675 logger.py[line:35] INFO Score for MDtype is: 0.8629032258064516
2024-06-12 18:02:02,675 logger.py[line:35] INFO Score for MParam is: 0.8571428571428571
2024-06-12 18:02:02,675 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 18:02:02,675 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 18:02:02,675 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 18:02:02,675 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 18:02:02,675 logger.py[line:35] INFO The last used seed is: Edge
2024-06-12 18:02:02,675 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 18:02:02,675 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61
2024-06-12 18:02:02,675 logger.py[line:35] INFO start mutating the generated model
2024-06-12 18:02:07,528 logger.py[line:35] INFO Generating model using MParam
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam')>, 'elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 14, 13, 1017) dtype=float32 (created by layer 'elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>, 'softmax_insert_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 7, 7, 512) dtype=float32 (created by layer 'softmax_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>, 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 3, 6, 2052) dtype=float16 (created by layer 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>, 'cropping2d': <KerasTensor: shape=(None, 10, 10, 258) dtype=float32 (created by layer 'cropping2d_copy_MParam')>, 'conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 14, 14, 256) dtype=float32 (created by layer 'conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>, 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_2': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>}
2024-06-12 18:02:08,680 logger.py[line:35] INFO Changing 3/5 of layer conv4_block5_1_bn_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam's configuration
2024-06-12 18:02:08,680 logger.py[line:35] INFO changing config center in layer conv4_block5_1_bn_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam: from True to False
2024-06-12 18:02:08,680 logger.py[line:35] INFO changing config momentum in layer conv4_block5_1_bn_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam: from 0.99 to 0.8235339173633299
2024-06-12 18:02:08,680 logger.py[line:35] INFO changing config scale in layer conv4_block5_1_bn_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam: from True to False
2024-06-12 18:02:08,680 logger.py[line:35] INFO changing config axis in layer conv4_block5_1_bn_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam: from ListWrapper([3]) to -1
2024-06-12 18:02:08,680 logger.py[line:35] INFO Changing 3/15 of layer conv4_block5_2_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam's configuration
2024-06-12 18:02:08,681 logger.py[line:35] INFO changing config use_bias in layer conv4_block5_2_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam: from True to True
2024-06-12 18:02:08,681 logger.py[line:35] INFO changing config bias_initializer in layer conv4_block5_2_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam: from {'class_name': 'Zeros', 'config': {}} to RandomUniform
2024-06-12 18:02:08,681 logger.py[line:35] INFO changing config filters in layer conv4_block5_2_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam: from 256 to 5
2024-06-12 18:02:08,681 logger.py[line:35] INFO changing config bias_regularizer in layer conv4_block5_2_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam: from None to l1
model outputs {'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_copy_MParam')>, 'elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam': <KerasTensor: shape=(None, 14, 13, 1017) dtype=float32 (created by layer 'elu_insert_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>, 'softmax_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam': <KerasTensor: shape=(None, 7, 7, 512) dtype=float32 (created by layer 'softmax_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>, 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam': <KerasTensor: shape=(None, 3, 6, 2052) dtype=float16 (created by layer 'pool1_pool_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>, 'cropping2d_copy_MParam': <KerasTensor: shape=(None, 10, 10, 258) dtype=float32 (created by layer 'cropping2d_copy_MParam')>, 'conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam': <KerasTensor: shape=(None, 14, 14, 256) dtype=float32 (created by layer 'conv4_block2_1_conv_copy_LMerg_copy_MDtype_copy_NLAll_copy_NLAll_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>, 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam': <KerasTensor: shape=(None, 256) dtype=float32 (created by layer 'global_max_pooling2d_insert_copy_NLAll_copy_NLAll_copy_Edge_2_copy_MParam')>}
2024-06-12 18:02:10,078 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 225/2170
The Configuration Coverage is: 490/2049
The NDims Coverage Is: 79/117
The DType Coverage Is: 80/354
The Shape Coverage Is: 170/295
The Input Coverage Is: 329/766
2024-06-12 18:02:12,555 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 18:02:16,438 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 18:02:20,552 logger.py[line:35] INFO 2.9.0
2024-06-12 18:02:22,140 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 18:02:33,025 logger.py[line:35] INFO SUCCESS:Get prediction for resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61-MParam98 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 18:02:34,755 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 18s
2024-06-12 18:02:34,755 logger.py[line:35] INFO loading the redis
2024-06-12 18:02:34,758 logger.py[line:35] INFO finish loading from redis
2024-06-12 18:02:34,779 logger.py[line:35] INFO coverage_c=38833
time=22.043164253234863, cov_py=0, cov_c=38833
New test requirements invoked on framework tensorflow when updating resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61-MParam98
2024-06-12 18:02:39,443 logger.py[line:35] INFO Success on backend: tensorflow of model resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61-MParam98
2024-06-12 18:02:39,443 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 18:02:39,443 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 18:02:39,443 logger.py[line:35] INFO after_prediction
2024-06-12 18:02:39,443 logger.py[line:35] INFO New representative seed found: resnet50-LMerg2-MDtype4-NLAll12-NLAll32-NLAll93-NLAll-1-Edge61-MParam98
2024-06-12 18:02:39,866 logger.py[line:35] INFO INFO: Mutation progress 100/100
2024-06-12 18:02:39,866 logger.py[line:35] INFO Logging for Seeds
2024-06-12 18:02:39,866 logger.py[line:35] INFO Score for NLAll is: 0.9090909090909091
2024-06-12 18:02:39,866 logger.py[line:35] INFO Score for Edge is: 0.8958333333333334
2024-06-12 18:02:39,866 logger.py[line:35] INFO Score for MParam is: 0.8636363636363636
2024-06-12 18:02:39,866 logger.py[line:35] INFO Score for MDtype is: 0.8629032258064516
2024-06-12 18:02:39,866 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 18:02:39,866 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 18:02:39,866 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 18:02:39,866 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 18:02:39,866 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 18:02:39,867 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 18:02:39,867 logger.py[line:35] INFO Choose seed: resnet50-LMerg2-MShape5-MDtype6-Edge24-SpecialI29-MDtype37-NLAll42
2024-06-12 18:02:39,867 logger.py[line:35] INFO start mutating the generated model
2024-06-12 18:02:44,547 logger.py[line:35] INFO Generating model using MParam
model outputs {'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>, 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 64) dtype=float16 (created by layer 'avg_pool_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>, 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 14, 14, 512) dtype=float32 (created by layer 'conv5_block1_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_2_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>, 'cropping2d_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>, 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_1_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>, 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 3) dtype=float32 (created by layer 'cropping2d_2_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>, 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 128) dtype=float32 (created by layer 'cropping2d_3_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>, 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_4_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>, 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 64) dtype=float32 (created by layer 'cropping2d_5_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>, 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_NLAll': <KerasTensor: shape=(None, 10, 10, 256) dtype=float32 (created by layer 'cropping2d_6_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam')>}
2024-06-12 18:02:45,560 logger.py[line:35] INFO Changing 1/15 of layer conv2_block2_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:45,560 logger.py[line:35] INFO changing config bias_regularizer in layer conv2_block2_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from None to l1
2024-06-12 18:02:45,560 logger.py[line:35] INFO changing config dilation_rate in layer conv2_block2_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from (1, 1) to [2, 1]
2024-06-12 18:02:45,560 logger.py[line:35] INFO Changing 2/15 of layer conv4_block3_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:45,561 logger.py[line:35] INFO changing config kernel_regularizer in layer conv4_block3_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from None to l1
2024-06-12 18:02:45,561 logger.py[line:35] INFO changing config activation in layer conv4_block3_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from linear to softmax
2024-06-12 18:02:45,561 logger.py[line:35] INFO changing config bias_constraint in layer conv4_block3_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from None to MaxNorm
2024-06-12 18:02:45,561 logger.py[line:35] INFO Changing 1/5 of layer conv2_block3_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:45,561 logger.py[line:35] INFO changing config center in layer conv2_block3_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from True to True
2024-06-12 18:02:45,561 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:02:45,561 logger.py[line:35] INFO changing config axis in layer conv2_block3_1_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from ListWrapper([3]) to -1
2024-06-12 18:02:45,561 logger.py[line:35] INFO Changing 1/1 of layer cropping2d_3_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:45,561 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:02:45,561 logger.py[line:35] INFO Changing 3/5 of layer conv5_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:45,561 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:02:45,561 logger.py[line:35] INFO changing config center in layer conv5_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from True to False
2024-06-12 18:02:45,561 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:02:45,562 logger.py[line:35] INFO changing config scale in layer conv5_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from True to False
2024-06-12 18:02:45,562 logger.py[line:35] INFO changing config axis in layer conv5_block2_3_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from ListWrapper([3]) to -2
2024-06-12 18:02:45,562 logger.py[line:35] INFO Changing 1/15 of layer conv5_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:45,562 logger.py[line:35] INFO changing config activation in layer conv5_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from linear to elu
2024-06-12 18:02:45,562 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:02:45,562 logger.py[line:35] INFO changing config strides in layer conv5_block2_1_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from (1, 1) to [1, 4]
2024-06-12 18:02:45,562 logger.py[line:35] INFO Changing 3/5 of layer conv2_block3_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:45,562 logger.py[line:35] INFO changing config scale in layer conv2_block3_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from True to False
2024-06-12 18:02:45,562 logger.py[line:35] INFO changing config center in layer conv2_block3_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from True to False
2024-06-12 18:02:45,562 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:02:45,563 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:02:45,563 logger.py[line:35] INFO changing config axis in layer conv2_block3_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from ListWrapper([3]) to -2
2024-06-12 18:02:45,563 logger.py[line:35] INFO Changing 1/15 of layer conv5_block1_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:45,563 logger.py[line:35] INFO changing config bias_initializer in layer conv5_block1_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from {'class_name': 'Zeros', 'config': {}} to RandomUniform
2024-06-12 18:02:45,563 logger.py[line:35] INFO changing config kernel_regularizer in layer conv5_block1_3_conv_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from None to l2
2024-06-12 18:02:45,563 logger.py[line:35] INFO Changing 2/5 of layer conv3_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:45,563 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:02:45,563 logger.py[line:35] INFO changing config axis in layer conv3_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from ListWrapper([3]) to -1
2024-06-12 18:02:45,563 logger.py[line:35] INFO changing config center in layer conv3_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from True to False
2024-06-12 18:02:45,563 logger.py[line:35] INFO changing config scale in layer conv3_block4_2_bn_copy_LMerg_copy_MShape_copy_MDtype_copy_Edge_copy_SpecialI_copy_MDtype_copy_NLAll_copy_MParam: from True to True
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 82, in generate_model_by_model_mutation
    architecture_measure=architecture_measure, max_layer_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 283, in mutate_param
    new_model = utils.ModelUtils.functional_model_operation(MParam_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 101, in functional_model_operation
    x = cloned_layer(layer_input_tensors)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/merge.py", line 79, in _compute_elemwise_op_output_shape
    'Inputs have incompatible shapes. '
ValueError: Inputs have incompatible shapes. Received shapes (7, 7, 2048) and (7, 2, 2048)
2024-06-12 18:02:47,102 logger.py[line:35] INFO INFO: Mutation progress 100/100
2024-06-12 18:02:47,102 logger.py[line:35] INFO Logging for Seeds
2024-06-12 18:02:47,102 logger.py[line:35] INFO Score for NLAll is: 0.9090909090909091
2024-06-12 18:02:47,102 logger.py[line:35] INFO Score for Edge is: 0.8958333333333334
2024-06-12 18:02:47,102 logger.py[line:35] INFO Score for MParam is: 0.8636363636363636
2024-06-12 18:02:47,102 logger.py[line:35] INFO Score for MDtype is: 0.8629032258064516
2024-06-12 18:02:47,102 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 18:02:47,102 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 18:02:47,102 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 18:02:47,102 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 18:02:47,102 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 18:02:47,102 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 18:02:47,103 logger.py[line:35] INFO Choose seed: densenet121-SpecialI57-NLAll80
2024-06-12 18:02:47,103 logger.py[line:35] INFO start mutating the generated model
2024-06-12 18:02:53,070 logger.py[line:35] INFO Generating model using MParam
model outputs {'predictions_copy_SpecialI_copy_NLAll': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_SpecialI_copy_NLAll_copy_MParam')>}
2024-06-12 18:02:55,415 logger.py[line:35] INFO Changing 2/15 of layer conv4_block23_2_conv_copy_SpecialI_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:55,415 logger.py[line:35] INFO changing config activation in layer conv4_block23_2_conv_copy_SpecialI_copy_NLAll_copy_MParam: from linear to hard_sigmoid
2024-06-12 18:02:55,415 logger.py[line:35] INFO changing config strides in layer conv4_block23_2_conv_copy_SpecialI_copy_NLAll_copy_MParam: from (1, 1) to [1, 2]
2024-06-12 18:02:55,415 logger.py[line:35] INFO changing config kernel_initializer in layer conv4_block23_2_conv_copy_SpecialI_copy_NLAll_copy_MParam: from {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}} to TruncatedNormal
2024-06-12 18:02:55,415 logger.py[line:35] INFO Changing 1/15 of layer conv5_block12_2_conv_copy_SpecialI_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:55,415 logger.py[line:35] INFO changing config activity_regularizer in layer conv5_block12_2_conv_copy_SpecialI_copy_NLAll_copy_MParam: from None to l2
2024-06-12 18:02:55,416 logger.py[line:35] INFO changing config bias_regularizer in layer conv5_block12_2_conv_copy_SpecialI_copy_NLAll_copy_MParam: from None to l2
2024-06-12 18:02:55,416 logger.py[line:35] INFO Changing 1/15 of layer conv2_block3_1_conv_copy_SpecialI_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:55,416 logger.py[line:35] INFO changing config kernel_initializer in layer conv2_block3_1_conv_copy_SpecialI_copy_NLAll_copy_MParam: from {'class_name': 'VarianceScaling', 'config': {'scale': 1.0, 'mode': 'fan_avg', 'distribution': 'uniform', 'seed': None}} to he_normal
2024-06-12 18:02:55,416 logger.py[line:35] INFO changing config padding in layer conv2_block3_1_conv_copy_SpecialI_copy_NLAll_copy_MParam: from valid to valid
2024-06-12 18:02:55,416 logger.py[line:35] INFO Changing 3/5 of layer conv4_block1_1_bn_copy_SpecialI_copy_NLAll_copy_MParam's configuration
2024-06-12 18:02:55,416 logger.py[line:35] INFO changing config center in layer conv4_block1_1_bn_copy_SpecialI_copy_NLAll_copy_MParam: from True to False
2024-06-12 18:02:55,416 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:02:55,416 logger.py[line:35] INFO changing config scale in layer conv4_block1_1_bn_copy_SpecialI_copy_NLAll_copy_MParam: from True to True
2024-06-12 18:02:55,416 logger.py[line:35] INFO changing config axis in layer conv4_block1_1_bn_copy_SpecialI_copy_NLAll_copy_MParam: from ListWrapper([3]) to -2
2024-06-12 18:02:55,416 logger.py[line:35] INFO Numeric Parameter Is Full!!
Traceback (most recent call last):
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/comet/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/implementations/scripts/generation/generate_model.py", line 123, in <module>
    new_model = modelGenerator.mutate_model(origin_model)
  File "/root/implementations/scripts/generation/generate_model.py", line 58, in mutate_model
    architecture_measure=self.architecture_measure
  File "/root/implementations/scripts/mutation/structure_mutation_generators.py", line 82, in generate_model_by_model_mutation
    architecture_measure=architecture_measure, max_layer_num=MAX_LAYER_NUM, mutation_mode=mutation_operator_mode)
  File "/root/implementations/scripts/mutation/comet_mutation_operators.py", line 283, in mutate_param
    new_model = utils.ModelUtils.functional_model_operation(MParam_model, operation=operation)
  File "/root/implementations/scripts/tools/utils.py", line 101, in functional_model_operation
    x = cloned_layer(layer_input_tensors)
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/utils/traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/opt/conda/envs/comet/lib/python3.7/site-packages/keras/layers/merge.py", line 525, in build
    raise ValueError(err_msg)
ValueError: A `Concatenate` layer requires inputs with matching shapes except for the concatenation axis. Received: input_shape=[(None, 14, 14, 960), (None, 14, 7, 32)]
2024-06-12 18:02:57,561 logger.py[line:35] INFO INFO: Mutation progress 100/100
2024-06-12 18:02:57,561 logger.py[line:35] INFO Logging for Seeds
2024-06-12 18:02:57,561 logger.py[line:35] INFO Score for NLAll is: 0.9090909090909091
2024-06-12 18:02:57,561 logger.py[line:35] INFO Score for Edge is: 0.8958333333333334
2024-06-12 18:02:57,561 logger.py[line:35] INFO Score for MParam is: 0.8636363636363636
2024-06-12 18:02:57,561 logger.py[line:35] INFO Score for MDtype is: 0.8629032258064516
2024-06-12 18:02:57,561 logger.py[line:35] INFO Score for MDims is: 0.8378378378378378
2024-06-12 18:02:57,561 logger.py[line:35] INFO Score for LMerg is: 0.7894736842105263
2024-06-12 18:02:57,561 logger.py[line:35] INFO Score for MShape is: 0.7222222222222222
2024-06-12 18:02:57,561 logger.py[line:35] INFO Score for SpecialI is: 0.6052631578947368
2024-06-12 18:02:57,561 logger.py[line:35] INFO The last used seed is: MParam
2024-06-12 18:02:57,562 logger.py[line:35] INFO Randomly Choose One Config From the Config Pool: 1
2024-06-12 18:02:57,562 logger.py[line:35] INFO Choose seed: inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4
2024-06-12 18:02:57,562 logger.py[line:35] INFO start mutating the generated model
2024-06-12 18:03:05,169 logger.py[line:35] INFO Generating model using MParam
model outputs {'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam')>}
2024-06-12 18:03:08,768 logger.py[line:35] INFO Changing 1/15 of layer conv2d_94_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam's configuration
2024-06-12 18:03:08,768 logger.py[line:35] INFO changing config bias_initializer in layer conv2d_94_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam: from {'class_name': 'Zeros', 'config': {}} to glorot_uniform
2024-06-12 18:03:08,768 logger.py[line:35] INFO changing config dilation_rate in layer conv2d_94_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam: from (1, 1) to [4, 2]
2024-06-12 18:03:08,769 logger.py[line:35] INFO Changing 3/5 of layer batch_normalization_28_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam's configuration
2024-06-12 18:03:08,769 logger.py[line:35] INFO changing config center in layer batch_normalization_28_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam: from True to False
2024-06-12 18:03:08,769 logger.py[line:35] INFO changing config axis in layer batch_normalization_28_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam: from ListWrapper([3]) to -1
2024-06-12 18:03:08,769 logger.py[line:35] INFO changing config scale in layer batch_normalization_28_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam: from False to False
2024-06-12 18:03:08,769 logger.py[line:35] INFO Numeric Parameter Is Full!!
2024-06-12 18:03:08,769 logger.py[line:35] INFO Numeric Parameter Is Full!!
model outputs {'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam': <KerasTensor: shape=(None, 1000) dtype=float32 (created by layer 'predictions_copy_MParam_copy_MDtype_copy_MDtype_copy_MDtype_copy_MParam')>}
2024-06-12 18:03:12,580 saving_utils.py[line:316] WARNING Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
The API Pair Coverage Is: 225/2170
The Configuration Coverage is: 492/2049
The NDims Coverage Is: 79/117
The DType Coverage Is: 80/354
The Shape Coverage Is: 170/295
The Input Coverage Is: 329/766
2024-06-12 18:03:18,698 logger.py[line:35] INFO Working on Multiprocessing Prediction
2024-06-12 18:03:22,729 logger.py[line:35] INFO Start Predicting on Backend: tensorflow
2024-06-12 18:03:26,968 logger.py[line:35] INFO 2.9.0
2024-06-12 18:03:28,559 logger.py[line:35] INFO TensorFlow is using GPU? /device:GPU:0
2024-06-12 18:03:51,420 logger.py[line:35] INFO SUCCESS:Get prediction for inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4-MParam99 successfully on tensorflow!
1 Physical GPUs, 1 Logical GPUs
2024-06-12 18:03:53,361 logger.py[line:35] INFO Prediction Time Used on tensorflow : 0h, 0m, 30s
2024-06-12 18:03:53,361 logger.py[line:35] INFO loading the redis
2024-06-12 18:03:53,364 logger.py[line:35] INFO finish loading from redis
2024-06-12 18:03:53,388 logger.py[line:35] INFO coverage_c=38833
time=34.51327443122864, cov_py=0, cov_c=38833
New test requirements invoked on framework tensorflow when updating inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4-MParam99
2024-06-12 18:03:57,567 logger.py[line:35] INFO Success on backend: tensorflow of model inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4-MParam99
2024-06-12 18:03:57,568 logger.py[line:35] INFO Generating Metrics Result
2024-06-12 18:03:57,568 logger.py[line:35] INFO Accumulative Inconsistency: 0
2024-06-12 18:03:57,568 logger.py[line:35] INFO after_prediction
2024-06-12 18:03:57,568 logger.py[line:35] INFO New representative seed found: inception.resnet.v2-MParam50-MDtype52-MDtype102-MDtype4-MParam99
2024-06-12 18:03:58,179 logger.py[line:35] INFO COMET Is Finished: Time used: 1 hour,5 min,53 sec
